---
title: Configurar aplicativos de parceiros no Skype for Business Server 2015 e no Exchange Server
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
ms.date: 12/20/2018
audience: ITPro
ms.topic: get-started-article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 9c3a3054-6201-433f-b128-4c49d3341370
description: 'Resumo: configurar a autenticação do servidor para o Exchange Server 2016 ou o Exchange Server 2013 e o Skype for Business Server.'
ms.openlocfilehash: 4c7c8a0efb2432403422e33140c1a2fdf3551dd1
ms.sourcegitcommit: ab47ff88f51a96aaf8bc99a6303e114d41ca5c2f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/20/2019
ms.locfileid: "34306731"
---
# <a name="configure-partner-applications-in-skype-for-business-server-and-exchange-server"></a><span data-ttu-id="fabe8-103">Configurar aplicativos de parceiros no Skype for Business Server e no Exchange Server</span><span class="sxs-lookup"><span data-stu-id="fabe8-103">Configure partner applications in Skype for Business Server and Exchange Server</span></span>
 
<span data-ttu-id="fabe8-104">**Resumo:** Configurar a autenticação do servidor para o Exchange Server 2016 ou do Exchange Server 2013 e do Skype for Business Server.</span><span class="sxs-lookup"><span data-stu-id="fabe8-104">**Summary:** Configure server to server authentication for Exchange Server 2016 or Exchange Server 2013 and Skype for Business Server.</span></span>
  
<span data-ttu-id="fabe8-105">A autenticação de servidor para servidor geralmente requer dois servidores, que precisam se comunicar entre si, e um terceiro servidor de token de segurança.</span><span class="sxs-lookup"><span data-stu-id="fabe8-105">Server-to-server authentication usually requires two servers that need to communicate with one another and a third-party security token server.</span></span> <span data-ttu-id="fabe8-106">Se o servidor A e o servidor B precisarem se comunicar, então ambos os servidores geralmente começam entrando em contato com um servidor de token e obtendo um token de segurança mutuamente confiável.</span><span class="sxs-lookup"><span data-stu-id="fabe8-106">If Server A and Server B need to communicate, then both of those servers typically start by contacting a token server and obtaining a mutually-trusted security token.</span></span> <span data-ttu-id="fabe8-107">O Servidor A então apresenta esse token de segurança ao Servidor B (e vice-versa), como uma forma de garantir autenticidade e confiabilidade.</span><span class="sxs-lookup"><span data-stu-id="fabe8-107">Server A then presents that security token to Server B (and vice-versa) as a way to guarantee its authenticity and trustworthiness.</span></span>
  
<span data-ttu-id="fabe8-108">No entanto, esta é uma regra geral.</span><span class="sxs-lookup"><span data-stu-id="fabe8-108">However, that's a general rule.</span></span> <span data-ttu-id="fabe8-109">O Skype for Business Server, o Exchange Server 2016, o Exchange Server 2013 e o SharePoint Server 2013 não precisam usar um servidor de token de terceiros quando se comunicam uns com os outros; Isso porque esses produtos de servidor podem criar tokens de segurança que podem ser aceitos por um do outro, sem a necessidade de um servidor token separado.</span><span class="sxs-lookup"><span data-stu-id="fabe8-109">Skype for Business Server, Exchange Server 2016, Exchange Server 2013, and SharePoint Server 2013 do not need to use a third-party token server when communicating with one another; that's because these server products can create security tokens that can be accepted by one another without the need for a separate token server.</span></span> <span data-ttu-id="fabe8-110">(Esse recurso só está disponível no Skype for Business Server, Exchange Server 2016, Exchange Server 2013 e SharePoint Server 2013.</span><span class="sxs-lookup"><span data-stu-id="fabe8-110">(This capability is only available in Skype for Business Server, Exchange Server 2016, Exchange Server 2013, and SharePoint Server 2013.</span></span> <span data-ttu-id="fabe8-111">Se você precisar configurar uma autenticação entre servidores com outros servidores, incluindo outros produtos de servidor da Microsoft, então terá que fazer isso usando um terceiro servidor de token.)</span><span class="sxs-lookup"><span data-stu-id="fabe8-111">If you need to set up server-to-server authentication with other servers, including other Microsoft server products, then you will need to do so by using a third-party token server.)</span></span>
  
<span data-ttu-id="fabe8-112">Para configurar a autenticação de servidor para servidor entre o Skype for Business Server e o Exchange Server, você deve fazer duas coisas: 1) você deve atribuir os certificados apropriados a cada servidor; e 2) você deve configurar cada servidor para ser uma aplicação de parceiro do outro servidor: isso significa que você deve configurar o Skype for Business Server para ser um aplicativo de parceiro do Exchange Server e deve configurar o Exchange Server para ser um aplicativo de parceiro para o Skype para Business Server.</span><span class="sxs-lookup"><span data-stu-id="fabe8-112">In order to set up server-to-server authentication between Skype for Business Server and Exchange Server you must do two things: 1) you must assign the appropriate certificates to each server; and, 2) you must configure each server to be a partner application of the other server: that means you must configure Skype for Business Server to be a partner application for Exchange Server, and you must configure Exchange Server to be a partner application for Skype for Business Server.</span></span>
  
## <a name="configuring-skype-for-business-server-to-be-a-partner-application-for-exchange-server"></a><span data-ttu-id="fabe8-113">Configurar o Skype for Business Server para ser um aplicativo parceiro para Exchange Server</span><span class="sxs-lookup"><span data-stu-id="fabe8-113">Configuring Skype for Business Server to be a Partner Application for Exchange Server</span></span>

<span data-ttu-id="fabe8-114">A maneira mais fácil de configurar o Skype for Business Server para ser um aplicativo de parceiro com o Exchange Server 2016 ou o Exchange Server 2013 é executar o script Configure-EnterprisePartnerApplication. ps1, um script do Windows PowerShell fornecido com o Exchange Server.</span><span class="sxs-lookup"><span data-stu-id="fabe8-114">The easiest way to configure Skype for Business Server to be a partner application with Exchange Server 2016 or Exchange Server 2013 is to run the Configure-EnterprisePartnerApplication.ps1 script, a Windows PowerShell script that ships with Exchange Server.</span></span> <span data-ttu-id="fabe8-115">Para executar esse script, você deve fornecer a URL para o documento de metadados de autenticação do Skype for Business Server; Isso normalmente será o nome de domínio totalmente qualificado do pool do servidor do Skype for Business seguido do sufixo/Metadata/JSON/1.</span><span class="sxs-lookup"><span data-stu-id="fabe8-115">To run this script, you must provide the URL for the Skype for Business Server authentication metadata document; this will typically be the fully qualified domain name of the Skype for Business Server pool followed by the suffix /metadata/json/1.</span></span> <span data-ttu-id="fabe8-116">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="fabe8-116">For example:</span></span>
  
```
https://atl-cs-001.litwareinc.com/metadata/json/1
```

<span data-ttu-id="fabe8-117">Para configurar o Skype for Business Server como um aplicativo de parceiro, abra o Shell de gerenciamento do Exchange e execute um comando semelhante a este (pressupondo que o Exchange tenha sido instalado na unidade C: e que ele use o caminho de pasta padrão):</span><span class="sxs-lookup"><span data-stu-id="fabe8-117">To configure Skype for Business Server as a partner application, open the Exchange Management Shell and run a command similar to this (assuming that Exchange has been installed on drive C: and that it uses the default folder path):</span></span>
  
```
"C:\Program Files\Microsoft\Exchange Server\V15\Scripts\Configure-EnterprisePartnerApplication.ps1 -AuthMetaDataUrl 'https://atl-cs-001.litwareinc.com/metadata/json/1' -ApplicationType Lync"
```

<span data-ttu-id="fabe8-118">Depois de configurar o aplicativo de parceiro, é recomendável parar e reiniciar os serviços de informações da Internet (IIS) em sua caixa de correio do Exchange e servidores de acesso para cliente.</span><span class="sxs-lookup"><span data-stu-id="fabe8-118">After configuring the partner application it is recommended that you stop and restart Internet Information Services (IIS) on your Exchange mailbox and client access servers.</span></span> <span data-ttu-id="fabe8-119">Você pode reiniciar o IIS usando um comando similar a esse, que reinicia o serviço no atl-exchange-001 do computador:</span><span class="sxs-lookup"><span data-stu-id="fabe8-119">You can restart IIS by using a command similar to this, which restarts the service on the computer atl-exchange-001:</span></span>
  
```
iisreset atl-exchange-001
```

<span data-ttu-id="fabe8-120">Esse comando pode ser executado no Shell de gerenciamento do Exchange ou em qualquer outra janela de comando executada em privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="fabe8-120">This command can be run from within the Exchange Management Shell or from any other command window run under administrator privileges.</span></span>
  
## <a name="configuring-exchange-server-to-be-a-partner-application-for-skype-for-business-server"></a><span data-ttu-id="fabe8-121">Configurando o Exchange Server para ser um aplicativo parceiro para o Skype for Business Server</span><span class="sxs-lookup"><span data-stu-id="fabe8-121">Configuring Exchange Server to be a Partner Application for Skype for Business Server</span></span>

<span data-ttu-id="fabe8-122">Depois de configurar o Skype for Business Server para ser um aplicativo parceiro para Exchange Server 2016 ou Exchange Server 2013, configure o Exchange Server para ser um aplicativo de parceiro do Skype for Business Server.</span><span class="sxs-lookup"><span data-stu-id="fabe8-122">After you have configured Skype for Business Server to be a partner application for Exchange Server 2016 or Exchange Server 2013, you must then configure Exchange Server to be a partner application for Skype for Business Server.</span></span> <span data-ttu-id="fabe8-123">Isso pode ser feito usando o Shell de gerenciamento do Skype for Business Server e especificando o documento de metadados de autenticação para o Exchange; Isso normalmente será o URI do serviço de descoberta automática do Exchange seguido pelo sufixo/Metadata/JSON/1.</span><span class="sxs-lookup"><span data-stu-id="fabe8-123">This can be done by using the Skype for Business Server Management Shell and specifying the authentication metadata document for Exchange; this will typically be the URI of the Exchange autodiscover service followed by the suffix /metadata/json/1.</span></span> <span data-ttu-id="fabe8-124">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="fabe8-124">For example:</span></span>
  
```
https://autodiscover.litwareinc.com/autodiscover/metadata/json/1
```

<span data-ttu-id="fabe8-125">No Skype for Business Server, os aplicativos de parceiros são configurados usando o cmdlet [New-CsPartnerApplication](https://docs.microsoft.com/powershell/module/skype/new-cspartnerapplication?view=skype-ps) .</span><span class="sxs-lookup"><span data-stu-id="fabe8-125">In Skype for Business Server, partner applications are configured by using the [New-CsPartnerApplication](https://docs.microsoft.com/powershell/module/skype/new-cspartnerapplication?view=skype-ps) cmdlet.</span></span> <span data-ttu-id="fabe8-126">Além de especificar o URI dos metadados, você também deve definir o nível de confiança do aplicativo como Full; Isso permitirá que o Exchange represente tanto e qualquer usuário autorizado no território.</span><span class="sxs-lookup"><span data-stu-id="fabe8-126">In addition to specifying the metadata URI you should also set the application trust level to Full; this will allow Exchange to represent both itself and any authorized user in the realm.</span></span> <span data-ttu-id="fabe8-127">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="fabe8-127">For example:</span></span>
  
```
New-CsPartnerApplication -Identity Exchange -ApplicationTrustLevel Full -MetadataUrl "https://autodiscover.litwareinc.com/autodiscover/metadata/json/1"
```

<span data-ttu-id="fabe8-128">Você também pode criar um aplicativo de parceiro copiando e modificando o código de script encontrado na documentação de autenticação do servidor para servidor do Skype for Business Server.</span><span class="sxs-lookup"><span data-stu-id="fabe8-128">Alternatively, you can create a partner application by copying and modifying the script code found in the Skype for Business Server server-to-server authentication documentation.</span></span> <span data-ttu-id="fabe8-129">Para obter mais informações, consulte o artigo [gerenciar autenticação de servidor para servidor (OAuth) e aplicativos de parceiros no Skype for Business Server](../../manage/authentication/server-to-server-and-partner-applications.md) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="fabe8-129">See the [Manage server-to-server authentication (OAuth) and partner applications in Skype for Business Server](../../manage/authentication/server-to-server-and-partner-applications.md) article for more information.</span></span>
  
<span data-ttu-id="fabe8-130">Se você configurou com êxito aplicativos de parceiros para o Skype for Business Server e o Exchange Server, também configurou com êxito a autenticação de servidor para servidor entre os dois produtos.</span><span class="sxs-lookup"><span data-stu-id="fabe8-130">If you have successfully configured partner applications for both Skype for Business Server and Exchange Server, you have also successfully configured server-to-server authentication between the two products.</span></span> <span data-ttu-id="fabe8-131">O Skype for Business Server inclui um cmdlet do Windows PowerShell, [teste-CsExStorageConnectivity](https://docs.microsoft.com/powershell/module/skype/test-csexstorageconnectivity?view=skype-ps) , que permite que você verifique se a autenticação servidor-a-servidor foi configurada corretamente e se o serviço de armazenamento do Skype for Business Server pode Conecte-se ao Exchange Server.</span><span class="sxs-lookup"><span data-stu-id="fabe8-131">Skype for Business Server includes a Windows PowerShell cmdlet, [Test-CsExStorageConnectivity](https://docs.microsoft.com/powershell/module/skype/test-csexstorageconnectivity?view=skype-ps) which enables you to verify that server-to-server authentication has been correctly configured and that the Skype for Business Server Storage Service can connect to Exchange Server.</span></span> <span data-ttu-id="fabe8-132">O cmdlet faz isso conectando-se à caixa de correio de um usuário do Exchange Server, escrevendo um item na pasta de histórico de conversas desse usuário e, em seguida, (opcionalmente) excluir esse item.</span><span class="sxs-lookup"><span data-stu-id="fabe8-132">The cmdlet does this by connecting to the mailbox of an Exchange Server user, writing an item into the Conversation History folder for that user, and then (optionally) deleting that item.</span></span>
  
<span data-ttu-id="fabe8-133">Para testar a integração do Skype for Business Server e do Exchange Server, execute um comando semelhante ao seguinte do Shell de gerenciamento do Skype for Business Server:</span><span class="sxs-lookup"><span data-stu-id="fabe8-133">To test the integration of Skype for Business Server and Exchange Server, run a command similar to the following from the Skype for Business Server Management Shell:</span></span>
  
```
Test-CsExStorageConnectivity -SipUri "sip:kenmyer@litwareinc.com"
```

<span data-ttu-id="fabe8-134">No comando anterior, o SipUri representa o endereço SIP de um usuário com uma conta no Exchange Server; seu comando falhará em uma conta de usuário válida.</span><span class="sxs-lookup"><span data-stu-id="fabe8-134">In the preceding command, the SipUri represents the SIP address of a user with an account on Exchange Server; your command will fail in this is not a valid user account.</span></span>
  
> [!NOTE]
> <span data-ttu-id="fabe8-135">Se você receber uma resposta 401 desse cmdlet, é provável que a configuração padrão do Exchange não inclua suporte para aceitar tokens OAuth.</span><span class="sxs-lookup"><span data-stu-id="fabe8-135">If you receive a 401 response from this cmdlet, it is probably because the default configuration for Exchange does not include support for accepting Oauth tokens.</span></span> <span data-ttu-id="fabe8-136">Para obter mais informações sobre como usar o OAuth no Exchange, consulte [Configurar a autenticação OAuth com o SharePoint 2013 e o Skype for Business Server](https://go.microsoft.com/fwlink/p/?LinkId=513103).</span><span class="sxs-lookup"><span data-stu-id="fabe8-136">For more information about using Oauth in Exchange, see [Configure OAuth authentication with SharePoint 2013 and Skype for Business Server](https://go.microsoft.com/fwlink/p/?LinkId=513103).</span></span> 
  
<span data-ttu-id="fabe8-137">Se o teste for bem sucedido e a conectividade for estabelecida, você poderá então prosseguir para configurar recursos opcionais, como integração de arquivamento e repositório de contato unificado.</span><span class="sxs-lookup"><span data-stu-id="fabe8-137">If the test succeeds and connectivity has been established, you can then proceed to configure optional features such as archiving integration and the unified contact store.</span></span>
