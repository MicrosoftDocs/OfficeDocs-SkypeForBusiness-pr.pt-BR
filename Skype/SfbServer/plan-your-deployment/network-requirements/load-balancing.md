---
title: Requisitos de balanceamento de carga para o Skype for Business
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
audience: ITPro
ms.topic: conceptual
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- IT_Skype16
- Strat_SB_Admin
ms.custom: ''
ms.assetid: 84489328-64a4-486c-9384-a3e5c8ed9c8b
description: 'Resumo: revise as considerações de balanceamento de carga antes de implementar o Skype for Business Server.'
ms.openlocfilehash: 199c93528d89786573bdac16077f1e32feb1fe6f
ms.sourcegitcommit: e64c50818cac37f3d6f0f96d0d4ff0f4bba24aef
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/06/2020
ms.locfileid: "41802041"
---
# <a name="load-balancing-requirements-for-skype-for-business"></a><span data-ttu-id="fb52d-103">Requisitos de balanceamento de carga para o Skype for Business</span><span class="sxs-lookup"><span data-stu-id="fb52d-103">Load balancing requirements for Skype for Business</span></span>
 
<span data-ttu-id="fb52d-104">**Resumo:** Examine as considerações de balanceamento de carga antes de implementar o Skype for Business Server.</span><span class="sxs-lookup"><span data-stu-id="fb52d-104">**Summary:** Review the load balancing considerations before implementing Skype for Business Server.</span></span>
  
<span data-ttu-id="fb52d-105">O balanceamento de carga distribui o tráfego entre os servidores em um pool.</span><span class="sxs-lookup"><span data-stu-id="fb52d-105">Load balancing distributes traffic among the servers in a pool.</span></span> <span data-ttu-id="fb52d-106">Se você tiver pools de front-end, pools do servidor de mediação ou pools do servidor de borda, será necessário implantar o balanceamento de carga para esses pools.</span><span class="sxs-lookup"><span data-stu-id="fb52d-106">If you have Front End pools, Mediation Server pools, or Edge Server pools, you need to deploy load balancing for these pools.</span></span>
  
<span data-ttu-id="fb52d-107">O Skype for Business Server dá suporte a dois tipos de soluções de balanceamento de carga para tráfego de cliente para servidor: o balanceamento de carga do sistema de nomes de domínio (DNS) e o balanceamento de carga de hardware (geralmente abreviados como HLB).</span><span class="sxs-lookup"><span data-stu-id="fb52d-107">Skype for Business Server supports two types of load balancing solutions for client-to-server traffic: Domain Name System (DNS) load balancing and hardware load balancing (often abbreviated as HLB).</span></span> <span data-ttu-id="fb52d-108">O balanceamento de carga de DNS oferece várias vantagens, incluindo administração mais simples, solução de problemas mais eficiente e capacidade de isolar grande parte do tráfego do Skype for Business Server de qualquer problema potencial de balanceador de carga de hardware.</span><span class="sxs-lookup"><span data-stu-id="fb52d-108">DNS load balancing offers several advantages including simpler administration, more efficient troubleshooting, and the ability to isolate much of your Skype for Business Server traffic from any potential hardware load balancer problems.</span></span>
  
<span data-ttu-id="fb52d-109">Decida se a solução de balanceamento de carga é adequada para cada pool na sua implantação, mas lembre-se das seguintes restrições:</span><span class="sxs-lookup"><span data-stu-id="fb52d-109">Decide for yourself which load balancing solution is appropriate for each pool in your deployment, but keep in mind the following restrictions:</span></span> 
  
- <span data-ttu-id="fb52d-p103">A interface de Borda interna e externa devem usar o mesmo tipo de balanceamento de carga. Não é possível usar o balanceamento de carga DNS em uma interface e o balanceamento de carga de hardware em outra.</span><span class="sxs-lookup"><span data-stu-id="fb52d-p103">The internal Edge interface and external Edge interface must use the same type of load balancing. You cannot use DNS load balancing on one interface and hardware load balancing on the other.</span></span>
    
- <span data-ttu-id="fb52d-p104">Alguns tipos de tráfego exigem um balanceador de carga de hardware. Por exemplo, o tráfego HTTP requer um balanceador de carga de hardware em vez do balanceamento de carga DNS. O balanceamento de carga DNS não funciona com o tráfego web de cliente-servidor.</span><span class="sxs-lookup"><span data-stu-id="fb52d-p104">Some types of traffic require a hardware load balancer. For example, HTTP traffic requires a hardware load balancer instead of DNS load balancing. DNS load balancing does not work with client-to-server web traffic.</span></span>
    
<span data-ttu-id="fb52d-p105">Se optar por usar o balanceamento de carga DNS para um pool, mas ainda for necessário implementar balanceadores de carga de hardware para o tráfego, como o tráfego HTTP, a administração dos balanceadores de carga de hardware é bastante simplificada. Por exemplo, a configuração do balanceador de carga de hardware será mais simples, pois gerenciará somente os tráfegos HTTP e HTTPS, enquanto os demais protocolos serão gerenciados pelo balanceamento de carga DNS. Para obter detalhes, consulte [DNS Load Balancing](load-balancing.md#BKMK_DNSLoadBalancing).</span><span class="sxs-lookup"><span data-stu-id="fb52d-p105">If you choose to use DNS load balancing for a pool but still need to implement hardware load balancers for traffic such as HTTP traffic, the administration of the hardware load balancers is greatly simplified. For example, configuring the hardware load balancer will be simpler as it will only manage the HTTP and HTTPS traffic, while all other protocols will be managed by DNS load balancing. For details, see [DNS Load Balancing](load-balancing.md#BKMK_DNSLoadBalancing).</span></span> 
  
<span data-ttu-id="fb52d-118">Para o tráfego de servidor para servidor, o Skype for Business Server usa o balanceamento de carga compatível com topologia.</span><span class="sxs-lookup"><span data-stu-id="fb52d-118">For server-to-server traffic, Skype for Business Server uses topology-aware load balancing.</span></span> <span data-ttu-id="fb52d-119">Os servidores lêem a topologia publicada no repositório de gerenciamento central para obter os FQDNs dos servidores na topologia e distribuir automaticamente o tráfego entre os servidores.</span><span class="sxs-lookup"><span data-stu-id="fb52d-119">Servers read the published topology in the Central Management store to obtain the FQDNs of servers in the topology, and automatically distribute the traffic among the servers.</span></span> <span data-ttu-id="fb52d-120">Os administradores não precisam configurar nem gerenciar esse tipo de balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="fb52d-120">Administrators do not need to set up or manage this type of load balancing.</span></span> 
  
<span data-ttu-id="fb52d-p107">Se você usar um balanceamento de carga DNS e precisar bloquear o tráfego para um computador específico, não é suficiente apenas remover as entradas do endereço IP do Pool FQDN. Você deve remover a entrada DNS do computador.</span><span class="sxs-lookup"><span data-stu-id="fb52d-p107">If you use DNS load balancing and you need to block traffic to a specific computer, it is not sufficient to just remove the IP address entries from the Pool FQDN. You must remove the DNS entry for the computer as well.</span></span> 
  
## <a name="hardware-load-balancer-requirements"></a><span data-ttu-id="fb52d-123">Requisitos do balanceador de carga do hardware</span><span class="sxs-lookup"><span data-stu-id="fb52d-123">Hardware load balancer requirements</span></span>

<span data-ttu-id="fb52d-124">A topologia de borda consolidada do Skype for Business Server dimensionada é otimizada para o balanceamento de carga de DNS para novas implantações que se agrupam principalmente com outras organizações que usam o Skype for Business Server ou o Lync Server.</span><span class="sxs-lookup"><span data-stu-id="fb52d-124">The Skype for Business Server scaled consolidated Edge topology is optimized for DNS load balancing for new deployments federating primarily with other organizations using Skype for Business Server or Lync Server.</span></span> <span data-ttu-id="fb52d-125">Se for necessário alta disponibilidade para qualquer um dos seguintes cenários, um balanceador de carga de hardware deve ser usado em pools de servidor de borda para o seguinte:</span><span class="sxs-lookup"><span data-stu-id="fb52d-125">If high availability is required for any of the following scenarios, a hardware load balancer must be used on Edge Server pools for the following:</span></span> 
  
- <span data-ttu-id="fb52d-126">Federação com organizações que usam o Office Communications Server 2007 R2 ou o Office Communications Server 2007</span><span class="sxs-lookup"><span data-stu-id="fb52d-126">Federation with organizations using Office Communications Server 2007 R2 or Office Communications Server 2007</span></span>
    
- <span data-ttu-id="fb52d-127">Exchange UM para usuários remotos usando o Exchange UM antes do Exchange 2010 com SP1</span><span class="sxs-lookup"><span data-stu-id="fb52d-127">Exchange UM for remote users using Exchange UM prior to Exchange 2010 with SP1</span></span>
    
- <span data-ttu-id="fb52d-128">Conectividade para usuários públicos de mensagens instantâneas</span><span class="sxs-lookup"><span data-stu-id="fb52d-128">Connectivity to public IM users</span></span>
    
> [!IMPORTANT]
> <span data-ttu-id="fb52d-p109">O uso do balanceamento de carga de DNS em uma interface e do balanceamento de carga de hardware na outra não é suportado. É preciso usar o balanceamento de carga de hardware ou de DNS nas duas interfaces.</span><span class="sxs-lookup"><span data-stu-id="fb52d-p109">Using DNS load balancing on one interface and hardware load balancing on the other is not supported. You must use hardware load balancing for both interfaces or DNS load balancing for both.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="fb52d-p110">Se estiver usando um balanceador de carga de hardware, o balanceador de carga implantado para conexões com a rede interna deverá ser configurado para balancear apenas cargas do tráfego de servidores que executam o serviço de Borda de Acesso e o serviço de Borda A/V. Ele não poderá balancear a carga do tráfego do serviço interno de Borda de Webconferência ou do serviço interno de Proxy XMPP.</span><span class="sxs-lookup"><span data-stu-id="fb52d-p110">If you are using a hardware load balancer, the load balancer deployed for connections with the internal network must be configured to load balance only the traffic to servers running the Access Edge service and the A/V Edge service. It cannot load balance the traffic to the internal Web Conferencing Edge service or the internal XMPP Proxy service.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="fb52d-133">O NAT do Direct Server Return (DSR) não é compatível com o Skype for Business Server.</span><span class="sxs-lookup"><span data-stu-id="fb52d-133">The direct server return (DSR) NAT is not supported with Skype for Business Server.</span></span> 
  
<span data-ttu-id="fb52d-134">Para determinar se o balanceador de carga de hardware oferece suporte aos recursos necessários para o Skype for Business Server, consulte [infraestrutura para o Skype for Business](https://docs.microsoft.com/SkypeForBusiness/certification/infra-gateways).</span><span class="sxs-lookup"><span data-stu-id="fb52d-134">To determine whether your hardware load balancer supports the necessary features required by Skype for Business Server, see [Infrastructure for Skype for Business](https://docs.microsoft.com/SkypeForBusiness/certification/infra-gateways).</span></span> 
  
### <a name="hardware-load-balancer-requirements-for-edge-servers-running-the-av-edge-service"></a><span data-ttu-id="fb52d-135">Requisitos do balanceador de carga de hardware para servidores de borda que executam o serviço de Borda A/V</span><span class="sxs-lookup"><span data-stu-id="fb52d-135">Hardware Load Balancer Requirements for Edge Servers Running the A/V Edge Service</span></span>

<span data-ttu-id="fb52d-136">Veja a seguir os requisitos do balanceador de carga de hardware para servidores de borda que executam o serviço de borda A/V:</span><span class="sxs-lookup"><span data-stu-id="fb52d-136">Following are the hardware load balancer requirements for Edge Servers running the A/V Edge service:</span></span>
  
- <span data-ttu-id="fb52d-p111">Desative o nagling de TCP para as portas interna e externa 443. Nagling é o processo de combinação de diversos pacotes pequenos em um único pacote maior para uma transmissão mais eficiente.</span><span class="sxs-lookup"><span data-stu-id="fb52d-p111">Turn off TCP nagling for both internal and external ports 443. Nagling is the process of combining several small packets into a single, larger packet for more efficient transmission.</span></span>
    
- <span data-ttu-id="fb52d-139">Desative o TCP nagling para o intervalo de porta externa 50.000-59.999.</span><span class="sxs-lookup"><span data-stu-id="fb52d-139">Turn off TCP nagling for external port range 50,000 - 59,999.</span></span> 
    
- <span data-ttu-id="fb52d-140">Não use NAT no firewall interno ou externo.</span><span class="sxs-lookup"><span data-stu-id="fb52d-140">Do not use NAT on the internal or external firewall.</span></span> 
    
- <span data-ttu-id="fb52d-141">A interface interna de borda deve estar em uma rede diferente da interface externa do servidor de borda e o roteamento entre elas deve ser desativado.</span><span class="sxs-lookup"><span data-stu-id="fb52d-141">The edge internal interface must be on a different network than the Edge Server external interface and routing between them must be disabled.</span></span> 
    
- <span data-ttu-id="fb52d-142">A interface externa do servidor de borda que executa o serviço de borda A/V deve usar endereços IP roteáveis publicamente e sem NAT ou conversão de porta em qualquer um dos endereços IP externos de borda.</span><span class="sxs-lookup"><span data-stu-id="fb52d-142">The external interface of the Edge Server running the A/V Edge Service must use publicly routable IP addresses and no NAT or port translation on any of the edge external IP addresses.</span></span> 
    
- <span data-ttu-id="fb52d-143">O balanceador de carga não pode trocar o endereço da fonte do cliente.</span><span class="sxs-lookup"><span data-stu-id="fb52d-143">The load balancer must not change the source address of the client.</span></span>
    
### <a name="other-hardware-load-balancer-requirements"></a><span data-ttu-id="fb52d-144">Outros requisitos de balanceador de carga de hardware</span><span class="sxs-lookup"><span data-stu-id="fb52d-144">Other Hardware Load Balancer requirements</span></span>

<span data-ttu-id="fb52d-145">Os requisitos de afinidade baseados em cookies são bastante reduzidos no Skype for Business Server para serviços Web.</span><span class="sxs-lookup"><span data-stu-id="fb52d-145">Cookie-based affinity requirements are greatly reduced in Skype for Business Server for Web services.</span></span> <span data-ttu-id="fb52d-146">Se você estiver implantando o Skype for Business Server e não mantiver nenhum servidor front-end do Lync Server 2010 ou pools front-end, não precisará de persistência baseada em cookies.</span><span class="sxs-lookup"><span data-stu-id="fb52d-146">If you are deploying Skype for Business Server and will not retain any Lync Server 2010 Front End Servers or Front End pools, you do not need cookie-based persistence.</span></span> <span data-ttu-id="fb52d-147">No entanto, se você mantiver temporariamente ou permanentemente qualquer um dos servidores de front-end do Lync Server 2010 ou grupos de front-end, ainda usará persistência baseada em cookies à medida que ela é implantada e configurada para o Lync Server 2010.</span><span class="sxs-lookup"><span data-stu-id="fb52d-147">However, if you will temporarily or permanently retain any Lync Server 2010 Front End Servers or Front End pools, you still use cookie-based persistence as it is deployed and configured for Lync Server 2010.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="fb52d-148">**Se decidir usar afinidade baseada em cookie mesmo que sua implantação não exija**, isso não causará um impacto negativo.</span><span class="sxs-lookup"><span data-stu-id="fb52d-148">**If you decide to use cookie-based affinity even though your deployment does not require it**, there is no negative impact to doing so.</span></span> 
  
<span data-ttu-id="fb52d-149">Para implantações que **não usarão** afinidade baseada em cookie:</span><span class="sxs-lookup"><span data-stu-id="fb52d-149">For deployments that **will not use** cookie-based affinity:</span></span>
  
- <span data-ttu-id="fb52d-150">No proxy reverso que publica a regra da porta 4443, defina **Encaminhar cabeçalho de host** como Verdadeiro.</span><span class="sxs-lookup"><span data-stu-id="fb52d-150">On the reverse proxy publishing rule for port 4443, set **Forward host header** to True.</span></span> <span data-ttu-id="fb52d-151">Isso garantirá que a URL original seja encaminhada.</span><span class="sxs-lookup"><span data-stu-id="fb52d-151">This will ensure that the original URL is forwarded.</span></span>
    
<span data-ttu-id="fb52d-152">Para implantações que **usarão** afinidade baseada em cookie:</span><span class="sxs-lookup"><span data-stu-id="fb52d-152">For deployments that **will use** cookie-based affinity:</span></span>
  
- <span data-ttu-id="fb52d-p114">No proxy reverso que publica a regra da porta 4443, defina **Encaminhar cabeçalho de host** como Verdadeiro. Isso garantirá que a URL original seja encaminhada.</span><span class="sxs-lookup"><span data-stu-id="fb52d-p114">On the reverse proxy publishing rule for port 4443, set **Forward host header** to True. This will ensure that the original URL is forwarded.</span></span>
    
- <span data-ttu-id="fb52d-155">O cookie do balanceador de carga de hardware NÃO DEVE ser marcado como httpOnly</span><span class="sxs-lookup"><span data-stu-id="fb52d-155">Hardware load balancer cookie MUST NOT be marked httpOnly</span></span>
    
- <span data-ttu-id="fb52d-156">O cookie do balanceador de carga de hardware NÃO DEVE conter uma data de vencimento</span><span class="sxs-lookup"><span data-stu-id="fb52d-156">Hardware load balancer cookie MUST NOT have an expiration time</span></span>
    
- <span data-ttu-id="fb52d-157">O cookie do balanceador de carga de hardware DEVE ser nomeado como **MS-WSMAN** (esse é o valor que o serviço Web espera e não pode ser alterado)</span><span class="sxs-lookup"><span data-stu-id="fb52d-157">Hardware load balancer cookie MUST be named **MS-WSMAN** (This is the value that the Web services expect, and cannot be changed)</span></span>
    
- <span data-ttu-id="fb52d-p115">O cookie do balanceador de carga de hardware DEVE ser definido em todas as respostas HTTP para as quais a solicitação HTTP recebida não contém um cookie, independentemente de uma resposta HTTP anterior na mesma conexão TCP já ter obtido um cookie. Se o balanceador de carga otimiza a inserção de cookie para apenas uma ocorrência por conexão TCP, essa otimização NÃO DEVE ser usada</span><span class="sxs-lookup"><span data-stu-id="fb52d-p115">Hardware load balancer cookie MUST be set in every HTTP response for which the incoming HTTP request did not have a cookie, regardless of whether a previous HTTP response on that same TCP connection had already obtained a cookie. If the load balancer optimizes cookie insert to only occur once per TCP connection, that optimization MUST NOT be used</span></span>
    
> [!NOTE]
> <span data-ttu-id="fb52d-160">As configurações típicas do balanceador de carga de hardware usam a afinidade de endereço de origem e um tempo de vida de sessão TCP de 20 min, que é muito bom para os clientes do Lync Server e do Lync 2013 porque o estado da sessão é mantido por meio do uso do cliente e/ou da interação do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fb52d-160">Typical hardware load balancer configurations use source-address affinity and a 20 min. TCP session lifetime, which is fine for Lync Server and Lync 2013 clients because session state is maintained through client usage and/or and application interaction.</span></span> 
  
<span data-ttu-id="fb52d-161">Se estiver implantando dispositivos móveis, o balanceador de carga de hardware deverá ser capaz de balancear a carga da solicitação individual em uma sessão TCP (na verdade, você deve poder balancear a carga de uma solicitação individual com base no endereço IP de destino).</span><span class="sxs-lookup"><span data-stu-id="fb52d-161">If you are deploying mobile devices, your hardware load balancer must be able to load balance individual request within a TCP session (in effect, you must be able to load balance an individual request based on the target IP address).</span></span>
  
> [!CAUTION]
> <span data-ttu-id="fb52d-162">Se você estiver implantando dispositivos móveis, o balanceador de carga de hardware deve ser capaz de balancear a carga individual de cada solicitação dentro de uma conexão TCP.</span><span class="sxs-lookup"><span data-stu-id="fb52d-162">If you are deploying mobile devices, your hardware load balancer must be able to individually load balance each request within a TCP connection.</span></span> <span data-ttu-id="fb52d-163">Os aplicativos móveis mais recentes do Apple iOS exigem a versão 1.2 do protocolo TLS.</span><span class="sxs-lookup"><span data-stu-id="fb52d-163">The latest Apple iOS mobile apps require Transport Layer Security (TLS) version 1.2.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="fb52d-164">Para obter detalhes sobre balanceadores de carga de hardware de terceiros, consulte [infraestrutura para o Skype for Business](https://docs.microsoft.com/SkypeForBusiness/certification/infra-gateways).</span><span class="sxs-lookup"><span data-stu-id="fb52d-164">For details on third party hardware load balancers, see [Infrastructure for Skype for Business](https://docs.microsoft.com/SkypeForBusiness/certification/infra-gateways).</span></span>  
  
<span data-ttu-id="fb52d-165">A seguir, são apresentados os requisitos do balanceador de carga de hardware para serviços Web do pool de diretores e de front-end:</span><span class="sxs-lookup"><span data-stu-id="fb52d-165">Following are the hardware load balancer requirements for Director and Front End pool Web Services:</span></span>
  
- <span data-ttu-id="fb52d-166">Para VIPs de serviços Web internos, defina a persistência Source_addr (porta interna 80, 443) no balanceador de carga de hardware.</span><span class="sxs-lookup"><span data-stu-id="fb52d-166">For internal Web Services VIPs, set Source_addr persistence (internal port 80, 443) on the hardware load balancer.</span></span> <span data-ttu-id="fb52d-167">Para o Skype for Business Server, Source_addr persistência significa que várias conexões provenientes de um único endereço IP são sempre enviadas para um servidor para manter o estado da sessão.</span><span class="sxs-lookup"><span data-stu-id="fb52d-167">For Skype for Business Server, Source_addr persistence means that multiple connections coming from a single IP address are always sent to one server to maintain session state.</span></span>
    
- <span data-ttu-id="fb52d-168">Use um tempo de ociosidade de TCP de 1.800 segundos.</span><span class="sxs-lookup"><span data-stu-id="fb52d-168">Use TCP idle timeout of 1800 seconds.</span></span>
    
- <span data-ttu-id="fb52d-169">No firewall entre o proxy reverso e o balanceamento de carga de hardware do próximo pool de saltos, crie uma regra para permitir https: o tráfego na porta 4443, do proxy inverso para o balanceador de carga de hardware.</span><span class="sxs-lookup"><span data-stu-id="fb52d-169">On the firewall between the reverse proxy and the next hop pool's hardware load balancer, create a rule to allow https: traffic on port 4443, from the reverse proxy to the hardware load balancer.</span></span> <span data-ttu-id="fb52d-170">O balanceador de carga de hardware deve ser configurado para ouvir as portas 80, 443 e 4443.</span><span class="sxs-lookup"><span data-stu-id="fb52d-170">The hardware load balancer must be configured to listen on ports 80, 443, and 4443.</span></span>
    
### <a name="summary-of-hardware-load-balancer-affinity-requirements"></a><span data-ttu-id="fb52d-171">Resumo dos requisitos de afinidade do balanceador de carga de hardware</span><span class="sxs-lookup"><span data-stu-id="fb52d-171">Summary of Hardware Load Balancer Affinity Requirements</span></span>

|<span data-ttu-id="fb52d-172">**Local do cliente/usuário**</span><span class="sxs-lookup"><span data-stu-id="fb52d-172">**Client/user location**</span></span>|<span data-ttu-id="fb52d-173">**Requisitos de afinidade de FQDN de serviços Web externos**</span><span class="sxs-lookup"><span data-stu-id="fb52d-173">**External web services FQDN affinity requirements**</span></span>|<span data-ttu-id="fb52d-174">**Requisitos de afinidade de FQDN de serviços Web internos**</span><span class="sxs-lookup"><span data-stu-id="fb52d-174">**Internal web services FQDN affinity requirements**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="fb52d-175">Lync Web App (usuários internos e externos)</span><span class="sxs-lookup"><span data-stu-id="fb52d-175">Lync Web App (internal and external users)</span></span>  <br/> <span data-ttu-id="fb52d-176">Dispositivo móvel (usuários internos e externos)</span><span class="sxs-lookup"><span data-stu-id="fb52d-176">Mobile device (internal and external users)</span></span>  <br/> |<span data-ttu-id="fb52d-177">Sem afinidade</span><span class="sxs-lookup"><span data-stu-id="fb52d-177">No affinity</span></span>  <br/> |<span data-ttu-id="fb52d-178">Afinidade do endereço de origem</span><span class="sxs-lookup"><span data-stu-id="fb52d-178">Source address affinity</span></span>  <br/> |
|<span data-ttu-id="fb52d-179">Lync Web App (somente usuários externos)</span><span class="sxs-lookup"><span data-stu-id="fb52d-179">Lync Web App (external users only)</span></span>  <br/> <span data-ttu-id="fb52d-180">Dispositivo móvel (usuários internos e externos)</span><span class="sxs-lookup"><span data-stu-id="fb52d-180">Mobile device (internal and external users)</span></span>  <br/> |<span data-ttu-id="fb52d-181">Sem afinidade</span><span class="sxs-lookup"><span data-stu-id="fb52d-181">No affinity</span></span>  <br/> |<span data-ttu-id="fb52d-182">Afinidade do endereço de origem</span><span class="sxs-lookup"><span data-stu-id="fb52d-182">Source address affinity</span></span>  <br/> |
|<span data-ttu-id="fb52d-183">Lync Web App (somente usuários internos)</span><span class="sxs-lookup"><span data-stu-id="fb52d-183">Lync Web App (internal users only)</span></span>  <br/> <span data-ttu-id="fb52d-184">Dispositivo móvel (não implantado)</span><span class="sxs-lookup"><span data-stu-id="fb52d-184">Mobile device (not deployed)</span></span>  <br/> |<span data-ttu-id="fb52d-185">Sem afinidade</span><span class="sxs-lookup"><span data-stu-id="fb52d-185">No affinity</span></span>  <br/> |<span data-ttu-id="fb52d-186">Afinidade do endereço de origem</span><span class="sxs-lookup"><span data-stu-id="fb52d-186">Source address affinity</span></span>  <br/> |
   
### <a name="port-monitoring-for-hardware-load-balancers"></a><span data-ttu-id="fb52d-187">Monitoramento de portas dos balanceadores de carga de hardware</span><span class="sxs-lookup"><span data-stu-id="fb52d-187">Port Monitoring for Hardware Load Balancers</span></span>

<span data-ttu-id="fb52d-188">Defina o monitoramento de portas nos balanceadores de carga de hardware para determinar quando serviços específicos não estão mais disponíveis devido a uma falha de hardware ou comunicação.</span><span class="sxs-lookup"><span data-stu-id="fb52d-188">You define port monitoring on the hardware load balancers to determine when specific services are no longer available due to hardware or communications failure.</span></span> <span data-ttu-id="fb52d-189">Por exemplo, se o serviço do servidor front-end (RTCSRV) parar porque o servidor front-end ou o pool de front-end falha, o monitoramento HLB também deve parar de receber tráfego nos serviços Web.</span><span class="sxs-lookup"><span data-stu-id="fb52d-189">For example, if the Front End Server service (RTCSRV) stops because the Front End Server or Front End pool fails, the HLB monitoring should also stop receiving traffic on the Web Services.</span></span> <span data-ttu-id="fb52d-190">Implante o monitoramento de portas no HLB para monitorar o seguinte:</span><span class="sxs-lookup"><span data-stu-id="fb52d-190">You implement port monitoring on the HLB to monitor the following:</span></span>
  
<span data-ttu-id="fb52d-191">**Pool de usuários do servidor front-end-interface interna HLB**</span><span class="sxs-lookup"><span data-stu-id="fb52d-191">**Front End Server User Pool - HLB Internal Interface**</span></span>

|<span data-ttu-id="fb52d-192">**IP/porta virtual**</span><span class="sxs-lookup"><span data-stu-id="fb52d-192">**Virtual IP/Port**</span></span>|<span data-ttu-id="fb52d-193">**Porta do nó**</span><span class="sxs-lookup"><span data-stu-id="fb52d-193">**Node Port**</span></span>|<span data-ttu-id="fb52d-194">**Máquina/monitor do nó**</span><span class="sxs-lookup"><span data-stu-id="fb52d-194">**Node Machine/Monitor**</span></span>|<span data-ttu-id="fb52d-195">**Perfil de persistência**</span><span class="sxs-lookup"><span data-stu-id="fb52d-195">**Persistence Profile**</span></span>|<span data-ttu-id="fb52d-196">**Observações**</span><span class="sxs-lookup"><span data-stu-id="fb52d-196">**Notes**</span></span>|
|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="fb52d-197">\<int_mco_443_vs\>da Web de pool</span><span class="sxs-lookup"><span data-stu-id="fb52d-197">\<pool\>web-int_mco_443_vs</span></span>  <br/> <span data-ttu-id="fb52d-198">443</span><span class="sxs-lookup"><span data-stu-id="fb52d-198">443</span></span>  <br/> |<span data-ttu-id="fb52d-199">443</span><span class="sxs-lookup"><span data-stu-id="fb52d-199">443</span></span>  <br/> |<span data-ttu-id="fb52d-200">Front-End</span><span class="sxs-lookup"><span data-stu-id="fb52d-200">Front End</span></span>  <br/> <span data-ttu-id="fb52d-201">5061</span><span class="sxs-lookup"><span data-stu-id="fb52d-201">5061</span></span>  <br/> |<span data-ttu-id="fb52d-202">Origem</span><span class="sxs-lookup"><span data-stu-id="fb52d-202">Source</span></span>  <br/> |<span data-ttu-id="fb52d-203">HTTPS</span><span class="sxs-lookup"><span data-stu-id="fb52d-203">HTTPS</span></span>  <br/> |
|<span data-ttu-id="fb52d-204">\<int_mco_80_vs\>da Web de pool</span><span class="sxs-lookup"><span data-stu-id="fb52d-204">\<pool\>web-int_mco_80_vs</span></span>  <br/> <span data-ttu-id="fb52d-205">80</span><span class="sxs-lookup"><span data-stu-id="fb52d-205">80</span></span>  <br/> |<span data-ttu-id="fb52d-206">80</span><span class="sxs-lookup"><span data-stu-id="fb52d-206">80</span></span>  <br/> |<span data-ttu-id="fb52d-207">Front-End</span><span class="sxs-lookup"><span data-stu-id="fb52d-207">Front End</span></span>  <br/> <span data-ttu-id="fb52d-208">5061</span><span class="sxs-lookup"><span data-stu-id="fb52d-208">5061</span></span>  <br/> |<span data-ttu-id="fb52d-209">Origem</span><span class="sxs-lookup"><span data-stu-id="fb52d-209">Source</span></span>  <br/> |<span data-ttu-id="fb52d-210">HTTP</span><span class="sxs-lookup"><span data-stu-id="fb52d-210">HTTP</span></span>  <br/> |
   
<span data-ttu-id="fb52d-211">**Pool de usuários do servidor front-end-interface externa HLB**</span><span class="sxs-lookup"><span data-stu-id="fb52d-211">**Front End Server User Pool - HLB External Interface**</span></span>

|<span data-ttu-id="fb52d-212">**IP/porta virtual**</span><span class="sxs-lookup"><span data-stu-id="fb52d-212">**Virtual IP/Port**</span></span>|<span data-ttu-id="fb52d-213">**Porta do nó**</span><span class="sxs-lookup"><span data-stu-id="fb52d-213">**Node Port**</span></span>|<span data-ttu-id="fb52d-214">**Máquina/monitor do nó**</span><span class="sxs-lookup"><span data-stu-id="fb52d-214">**Node Machine/Monitor**</span></span>|<span data-ttu-id="fb52d-215">**Perfil de persistência**</span><span class="sxs-lookup"><span data-stu-id="fb52d-215">**Persistence Profile**</span></span>|<span data-ttu-id="fb52d-216">**Observações**</span><span class="sxs-lookup"><span data-stu-id="fb52d-216">**Notes**</span></span>|
|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="fb52d-217">\<web_mco_443_vs\>de grupo</span><span class="sxs-lookup"><span data-stu-id="fb52d-217">\<pool\>web_mco_443_vs</span></span>  <br/> <span data-ttu-id="fb52d-218">443</span><span class="sxs-lookup"><span data-stu-id="fb52d-218">443</span></span>  <br/> |<span data-ttu-id="fb52d-219">4443</span><span class="sxs-lookup"><span data-stu-id="fb52d-219">4443</span></span>  <br/> |<span data-ttu-id="fb52d-220">Front-End</span><span class="sxs-lookup"><span data-stu-id="fb52d-220">Front End</span></span>  <br/> <span data-ttu-id="fb52d-221">5061</span><span class="sxs-lookup"><span data-stu-id="fb52d-221">5061</span></span>  <br/> |<span data-ttu-id="fb52d-222">Nenhum</span><span class="sxs-lookup"><span data-stu-id="fb52d-222">None</span></span>  <br/> |<span data-ttu-id="fb52d-223">HTTPS</span><span class="sxs-lookup"><span data-stu-id="fb52d-223">HTTPS</span></span>  <br/> |
|<span data-ttu-id="fb52d-224">\<web_mco_80_vs\>de grupo</span><span class="sxs-lookup"><span data-stu-id="fb52d-224">\<pool\>web_mco_80_vs</span></span>  <br/> <span data-ttu-id="fb52d-225">80</span><span class="sxs-lookup"><span data-stu-id="fb52d-225">80</span></span>  <br/> |<span data-ttu-id="fb52d-226">8080</span><span class="sxs-lookup"><span data-stu-id="fb52d-226">8080</span></span>  <br/> |<span data-ttu-id="fb52d-227">Front-End</span><span class="sxs-lookup"><span data-stu-id="fb52d-227">Front End</span></span>  <br/> <span data-ttu-id="fb52d-228">5061</span><span class="sxs-lookup"><span data-stu-id="fb52d-228">5061</span></span>  <br/> |<span data-ttu-id="fb52d-229">Nenhum</span><span class="sxs-lookup"><span data-stu-id="fb52d-229">None</span></span>  <br/> |<span data-ttu-id="fb52d-230">HTTP</span><span class="sxs-lookup"><span data-stu-id="fb52d-230">HTTP</span></span>  <br/> |
   
## <a name="dns-load-balancing"></a><span data-ttu-id="fb52d-231">DNS Load Balancing</span><span class="sxs-lookup"><span data-stu-id="fb52d-231">DNS Load Balancing</span></span>
<span data-ttu-id="fb52d-232"><a name="BKMK_DNSLoadBalancing"> </a></span><span class="sxs-lookup"><span data-stu-id="fb52d-232"><a name="BKMK_DNSLoadBalancing"> </a></span></span>

<span data-ttu-id="fb52d-233">O Skype for Business Server permite o balanceamento de carga de DNS, uma solução de software que pode reduzir significativamente a sobrecarga de administração de balanceamento de carga na sua rede.</span><span class="sxs-lookup"><span data-stu-id="fb52d-233">Skype for Business Server enables DNS load balancing, a software solution that can greatly reduce the administration overhead for load balancing on your network.</span></span> <span data-ttu-id="fb52d-234">O balanceamento de carga de DNS equilibra o tráfego de rede exclusivo para o Skype for Business Server, como tráfego SIP e tráfego de mídia.</span><span class="sxs-lookup"><span data-stu-id="fb52d-234">DNS load balancing balances the network traffic that is unique to Skype for Business Server, such as SIP traffic and media traffic.</span></span>
  
<span data-ttu-id="fb52d-235">Se você implantar o balanceamento de carga de DNS, a sobrecarga de administração da sua organização para balanceadores de carga de hardware será minimizada.</span><span class="sxs-lookup"><span data-stu-id="fb52d-235">If you deploy DNS load balancing, your organization's administration overhead for hardware load balancers will be minimized.</span></span> <span data-ttu-id="fb52d-236">Além disso, a solução de problemas complexa de problemas relacionados à configuração incorreta de balanceadores de carga para tráfego SIP será eliminada.</span><span class="sxs-lookup"><span data-stu-id="fb52d-236">Additionally, complex troubleshooting of problems related to misconfiguration of load balancers for SIP traffic will be eliminated.</span></span> <span data-ttu-id="fb52d-237">Você também pode evitar conexões do servidor para que você possa colocar servidores offline.</span><span class="sxs-lookup"><span data-stu-id="fb52d-237">You can also prevent server connections so that you can take servers offline.</span></span> <span data-ttu-id="fb52d-238">O balanceamento de carga de DNS também garante que os problemas de balanceador de carga de hardware não afetem os elementos do tráfego SIP, como roteamento de chamadas básicas.</span><span class="sxs-lookup"><span data-stu-id="fb52d-238">DNS load balancing also ensures that hardware load balancer problems do not affect elements of SIP traffic such as basic call routing.</span></span>

<span data-ttu-id="fb52d-239">O diagrama a seguir mostra um exemplo que inclui o balanceamento de carga de DNS interno e externo:</span><span class="sxs-lookup"><span data-stu-id="fb52d-239">The following diagram shows an example that includes both internal and external DNS load balancing:</span></span> 
  
<span data-ttu-id="fb52d-240">**Diagrama da rede de borda que usa endereços IPv4 públicos**</span><span class="sxs-lookup"><span data-stu-id="fb52d-240">**Edge network diagram using Public IPv4 addresses**</span></span>

![exemplo de diagrama de rede DNS](../../media/2cc9546e-5560-4d95-8fe4-65a792a0e9c3.png)
  
<span data-ttu-id="fb52d-242">Se você usa o balanceamento de carga de DNS, também é possível comprar saldos de carga de hardware de baixo custo do que se você usava os balanceadores de carga de hardware para todos os tipos de tráfego.</span><span class="sxs-lookup"><span data-stu-id="fb52d-242">If you use DNS load balancing, you may also be able to purchase lower-cost hardware load balancers than if you used the hardware load balancers for all types of traffic.</span></span> <span data-ttu-id="fb52d-243">Você deve usar balanceadores de carga que passaram no teste de qualificação de interoperabilidade com o Skype for Business Server.</span><span class="sxs-lookup"><span data-stu-id="fb52d-243">You should use load balancers that have passed interoperability qualification testing with Skype for Business Server.</span></span> <span data-ttu-id="fb52d-244">Para obter detalhes sobre o teste de interoperabilidade do balanceamento de carga, consulte [parceiros do balanceador de carga do Lync Server 2010](https://go.microsoft.com/fwlink/p/?linkId=202452).</span><span class="sxs-lookup"><span data-stu-id="fb52d-244">For details about load balancer interoperability testing, see [Lync Server 2010 Load Balancer Partners](https://go.microsoft.com/fwlink/p/?linkId=202452).</span></span> <span data-ttu-id="fb52d-245">O conteúdo aplica-se ao Skype for Business Server.</span><span class="sxs-lookup"><span data-stu-id="fb52d-245">The content there applies to Skype for Business Server.</span></span>
  
<span data-ttu-id="fb52d-246">O balanceamento de carga de DNS tem suporte para pools front-end, pools do servidor de borda, pools de diretor e pools autônomos do servidor de mediação.</span><span class="sxs-lookup"><span data-stu-id="fb52d-246">DNS load balancing is supported for Front End pools, Edge Server pools, Director pools, and stand-alone Mediation Server pools.</span></span>
  
<span data-ttu-id="fb52d-247">O balanceamento de carga de DNS geralmente é implementado no nível do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fb52d-247">DNS load balancing is typically implemented at the application level.</span></span> <span data-ttu-id="fb52d-248">O aplicativo (por exemplo, um cliente executando o Skype for Business), tenta se conectar a um servidor em um pool conectando-se a um dos endereços IP retornados pela consulta de registro DNS A e AAAA (se o endereçamento IPv6 for usado) para o pool FQDN (nome de domínio totalmente qualificado).</span><span class="sxs-lookup"><span data-stu-id="fb52d-248">The application (for example, a client running Skype for Business), tries to connect to a server in a pool by connecting to one of the IP addresses returned from the DNS A and AAAA (if IPv6 addressing is used) record query for the pool fully qualified domain name (FQDN).</span></span> 
  
<span data-ttu-id="fb52d-249">Por exemplo, se houver três servidores front-end em um pool chamado pool01.contoso.com, ocorrerá o seguinte:</span><span class="sxs-lookup"><span data-stu-id="fb52d-249">For example, if there are three front end servers in a pool named pool01.contoso.com, the following will happen:</span></span>
  
- <span data-ttu-id="fb52d-250">Clientes que executam o Skype for Business Query DNS para pool01.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="fb52d-250">Clients running Skype for Business query DNS for pool01.contoso.com.</span></span> <span data-ttu-id="fb52d-251">A consulta retorna três endereços IP e os armazena em cache da seguinte maneira (não necessariamente nesta ordem):</span><span class="sxs-lookup"><span data-stu-id="fb52d-251">The query returns three IP addresses and caches them as follows (not necessarily in this order):</span></span>
    
    <span data-ttu-id="fb52d-252">pool01.contoso.com 192.168.10.90</span><span class="sxs-lookup"><span data-stu-id="fb52d-252">pool01.contoso.com 192.168.10.90</span></span>
    
    <span data-ttu-id="fb52d-253">pool01.contoso.com 192.168.10.91</span><span class="sxs-lookup"><span data-stu-id="fb52d-253">pool01.contoso.com 192.168.10.91</span></span>
    
    <span data-ttu-id="fb52d-254">pool01.contoso.com 192.168.10.92</span><span class="sxs-lookup"><span data-stu-id="fb52d-254">pool01.contoso.com 192.168.10.92</span></span>
    
- <span data-ttu-id="fb52d-255">O cliente tenta estabelecer uma conexão TCP (Transmission Control Protocol) a um dos endereços IP.</span><span class="sxs-lookup"><span data-stu-id="fb52d-255">The client attempts to establish a Transmission Control Protocol (TCP) connection to one of the IP addresses.</span></span> <span data-ttu-id="fb52d-256">Se isso falhar, o cliente tentará o próximo endereço IP no cache.</span><span class="sxs-lookup"><span data-stu-id="fb52d-256">If that fails, the client tries the next IP address in the cache.</span></span>
    
- <span data-ttu-id="fb52d-257">Se a conexão TCP for bem -sucedida, o cliente negocia o TLS para se conectar ao Registrador Avançado primário em pool01.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="fb52d-257">If the TCP connection succeeds, the client negotiates TLS to connect to the primary registrar on pool01.contoso.com.</span></span>
    
- <span data-ttu-id="fb52d-258">Se o cliente tentar todas as entradas armazenadas em cache sem uma conexão bem-sucedida, o usuário será notificado de que nenhum servidor executando o Skype for Business Server está disponível no momento.</span><span class="sxs-lookup"><span data-stu-id="fb52d-258">If the client tries all cached entries without a successful connection, the user is notified that no servers running Skype for Business Server are available at the moment.</span></span>
    
> [!NOTE]
> <span data-ttu-id="fb52d-259">O balanceamento de carga baseado em DNS é diferente do rodízio de DNS (DNS RR) que geralmente se refere ao balanceamento de carga ao confiar no DNS para fornecer uma ordem diferente de endereços IP correspondentes aos servidores em um pool.</span><span class="sxs-lookup"><span data-stu-id="fb52d-259">DNS-based load balancing is different from DNS round robin (DNS RR) which typically refers to load balancing by relying on DNS to provide a different order of IP addresses corresponding to the servers in a pool.</span></span> <span data-ttu-id="fb52d-260">Normalmente, o RR DNS habilita somente a distribuição de carga, mas não habilita o failover.</span><span class="sxs-lookup"><span data-stu-id="fb52d-260">Typically DNS RR only enables load distribution, but does not enable failover.</span></span> <span data-ttu-id="fb52d-261">Por exemplo, se a conexão com um endereço IP retornado pela consulta DNS A e AAAA (se você estiver usando endereçamento IPv6) falhar, a conexão falhará.</span><span class="sxs-lookup"><span data-stu-id="fb52d-261">For example, if the connection to the one IP address returned by the DNS A and AAAA (if you are using IPv6 addressing) query fails, the connection fails.</span></span> <span data-ttu-id="fb52d-262">Portanto, o rodízio de DNS por si só é menos confiável do que o balanceamento de carga baseado em DNS.</span><span class="sxs-lookup"><span data-stu-id="fb52d-262">Therefore, DNS round robin by itself is less reliable than DNS-based load balancing.</span></span> <span data-ttu-id="fb52d-263">Você pode usar a repetição alternada de DNS em conjunto com o balanceamento de carga de DNS.</span><span class="sxs-lookup"><span data-stu-id="fb52d-263">You can use DNS round robin in conjunction with DNS load balancing.</span></span> 
  
<span data-ttu-id="fb52d-264">O balanceamento de carga de DNS é usado para o seguinte:</span><span class="sxs-lookup"><span data-stu-id="fb52d-264">DNS load balancing is used for the following:</span></span>
  
- <span data-ttu-id="fb52d-265">Balanceamento de carga do servidor para o servidor SIP para os servidores de borda</span><span class="sxs-lookup"><span data-stu-id="fb52d-265">Load balancing server-to-server SIP to the Edge Servers</span></span>
    
- <span data-ttu-id="fb52d-266">Aplicativos UCAS (serviços de aplicativo de comunicação unificada) de balanceamento de carga, como atendedor automático de conferência, grupo de resposta e estacionamento de chamada</span><span class="sxs-lookup"><span data-stu-id="fb52d-266">Load balancing Unified Communications Application Services (UCAS) applications such as Conferencing Auto Attendant, Response Group, and Call Park</span></span>
    
- <span data-ttu-id="fb52d-267">Evitando novas conexões para aplicativos do UCAS (também conhecido como "descarga")</span><span class="sxs-lookup"><span data-stu-id="fb52d-267">Preventing new connections to UCAS applications (also known as "draining")</span></span>
    
- <span data-ttu-id="fb52d-268">Balanceamento de carga de todo o tráfego de cliente para servidor entre clientes e servidores de borda</span><span class="sxs-lookup"><span data-stu-id="fb52d-268">Load balancing all client-to-server traffic between clients and Edge Servers</span></span>
    
<span data-ttu-id="fb52d-269">O balanceamento de carga de DNS não pode ser usado para o seguinte:</span><span class="sxs-lookup"><span data-stu-id="fb52d-269">DNS load balancing cannot be used for the following:</span></span>
  
- <span data-ttu-id="fb52d-270">Tráfego da Web de cliente para servidor para director ou servidores front-end</span><span class="sxs-lookup"><span data-stu-id="fb52d-270">Client-to-server web traffic to Director or Front End Servers</span></span>
    
<span data-ttu-id="fb52d-271">Balanceamento de carga de DNS e tráfego federado:</span><span class="sxs-lookup"><span data-stu-id="fb52d-271">DNS load balancing and federated traffic:</span></span>
  
<span data-ttu-id="fb52d-272">Se vários registros DNS forem retornados por uma consulta de servidor DNS, o serviço de borda de acesso sempre escolhe o registro SRV DNS com a prioridade numérica mais baixa e a espessura numérica mais alta.</span><span class="sxs-lookup"><span data-stu-id="fb52d-272">If multiple DNS records are returned by a DNS SRV query, the Access Edge service always picks the DNS SRV record with the lowest numeric priority and highest numeric weight.</span></span> <span data-ttu-id="fb52d-273">O documento da força de tarefas de engenharia da Internet "um RR DNS para especificar o local dos serviços (DNS SRV)" [RFC 2782, DNS SRV RR](https://www.ietf.org/rfc/rfc2782.txt) especifica que, se houver vários registros SRV DNS definidos, a prioridade será usada primeiro e, em seguida, peso.</span><span class="sxs-lookup"><span data-stu-id="fb52d-273">The Internet Engineering Task Force document "A DNS RR for specifying the location of services (DNS SRV)" [RFC 2782, DNS SRV RR](https://www.ietf.org/rfc/rfc2782.txt) specifies that if there are multiple DNS SRV records defined, priority is first used, then weight.</span></span> <span data-ttu-id="fb52d-274">Por exemplo, o registro SRV DNS A tem uma ponderação de 20 e uma prioridade de 40 e o registro SRV DNS B tem uma ponderação de 10 e prioridade de 50.</span><span class="sxs-lookup"><span data-stu-id="fb52d-274">For example DNS SRV record A has a weight of 20 and a priority of 40 and DNS SRV record B has a weight of 10 and priority of 50.</span></span> <span data-ttu-id="fb52d-275">Registro SRV DNS A with Priority 40 será selecionada.</span><span class="sxs-lookup"><span data-stu-id="fb52d-275">DNS SRV record A with priority 40 will be selected.</span></span> <span data-ttu-id="fb52d-276">As regras a seguir se aplicam à seleção de registro SRV DNS:</span><span class="sxs-lookup"><span data-stu-id="fb52d-276">The following rules apply to DNS SRV record selection:</span></span>
  
- <span data-ttu-id="fb52d-277">A prioridade é considerada primeiro.</span><span class="sxs-lookup"><span data-stu-id="fb52d-277">Priority is considered first.</span></span> <span data-ttu-id="fb52d-278">Um cliente deve tentar contatar o host de destino definido pelo registro SRV DNS com o menor prioridade numerada que ele pode alcançar.</span><span class="sxs-lookup"><span data-stu-id="fb52d-278">A client MUST attempt to contact the target host defined by the DNS SRV record with the lowest numbered priority it can reach.</span></span> <span data-ttu-id="fb52d-279">Os destinos com a mesma prioridade devem ser testados em uma ordem definida pelo campo peso.</span><span class="sxs-lookup"><span data-stu-id="fb52d-279">Targets with the same priority SHOULD be tried in an order defined by the weight field.</span></span>
    
- <span data-ttu-id="fb52d-280">O campo peso especifica um peso relativo para entradas com a mesma prioridade.</span><span class="sxs-lookup"><span data-stu-id="fb52d-280">The weight field specifies a relative weight for entries with the same priority.</span></span> <span data-ttu-id="fb52d-281">Atribuições maiores devem ter uma probabilidade mais alta proporcional mais alta de ser selecionada.</span><span class="sxs-lookup"><span data-stu-id="fb52d-281">Larger weights SHOULD be given a proportionately higher probability of being selected.</span></span> <span data-ttu-id="fb52d-282">Os administradores de DNS devem usar o peso 0 quando não houver nenhuma seleção de servidor para fazer.</span><span class="sxs-lookup"><span data-stu-id="fb52d-282">DNS administrators SHOULD use Weight 0 when there isn't any server selection to do.</span></span> <span data-ttu-id="fb52d-283">Na presença de registros que contêm pesos maiores do que 0, os registros com peso 0 devem ter uma chance muito menor de serem selecionados.</span><span class="sxs-lookup"><span data-stu-id="fb52d-283">In the presence of records containing weights greater than 0, records with weight 0 should have a very small chance of being selected.</span></span>
    
<span data-ttu-id="fb52d-284">Se vários registros SRV DNS com prioridade e peso iguais forem retornados, o serviço de borda de acesso selecionará o registro SRV que foi recebido primeiro do servidor DNS.</span><span class="sxs-lookup"><span data-stu-id="fb52d-284">If multiple DNS SRV records with equal priority and weight are returned, the Access Edge service will select the SRV record that was received first from the DNS server.</span></span>
  
### <a name="dns-load-balancing-on-front-end-pools-and-director-pools"></a><span data-ttu-id="fb52d-285">Balanceamento de carga de DNS em pools front-end e pools de diretor</span><span class="sxs-lookup"><span data-stu-id="fb52d-285">DNS Load Balancing on Front End Pools and Director Pools</span></span>

<span data-ttu-id="fb52d-286">Você pode usar o balanceamento de carga de DNS para o tráfego SIP em pools de front-end e em pools de diretor.</span><span class="sxs-lookup"><span data-stu-id="fb52d-286">You can use DNS load balancing for the SIP traffic on Front End pools and Director pools.</span></span> <span data-ttu-id="fb52d-287">Com o balanceamento de carga de DNS implantado, você ainda precisará usar balanceadores de carga de hardware para esses pools, mas somente para tráfego HTTPS de cliente para servidor.</span><span class="sxs-lookup"><span data-stu-id="fb52d-287">With DNS load balancing deployed, you still need to also use hardware load balancers for these pools, but only for client-to-server HTTPS traffic.</span></span> <span data-ttu-id="fb52d-288">O balanceador de carga de hardware é usado para tráfego HTTPS de clientes nas portas 443 e 80.</span><span class="sxs-lookup"><span data-stu-id="fb52d-288">The hardware load balancer is used for HTTPS traffic from clients over ports 443 and 80.</span></span> 
  
<span data-ttu-id="fb52d-289">Embora você ainda precise de balanceadores de carga de hardware para esses pools, a configuração e a Administração serão principalmente para tráfego HTTPS, para o qual os administradores de balanceamento de carga de hardware estão acostumados.</span><span class="sxs-lookup"><span data-stu-id="fb52d-289">Although you still need hardware load balancers for these pools, their setup and administration will be primarily for HTTPS traffic, which the administrators of hardware load balancers are accustomed to.</span></span>
  
#### <a name="dns-load-balancing-and-supporting-older-clients-and-servers"></a><span data-ttu-id="fb52d-290">Balanceamento de carga de DNS e suporte a clientes e servidores mais antigos</span><span class="sxs-lookup"><span data-stu-id="fb52d-290">DNS Load Balancing and Supporting Older Clients and Servers</span></span>

<span data-ttu-id="fb52d-291">O balanceamento de carga de DNS aceita failover automático somente para servidores que executam o Skype for Business Server ou o Lync Server 2010, e para os clientes do Lync 2013 e do Skype for Business.</span><span class="sxs-lookup"><span data-stu-id="fb52d-291">DNS load balancing supports automatic failover only for servers running Skype for Business Server or Lync Server 2010, and for Lync 2013 and Skype for Business clients.</span></span> <span data-ttu-id="fb52d-292">As versões anteriores dos clientes e do Office Communications Server ainda podem se conectar a pools que executam o balanceamento de carga de DNS, mas se não puderem fazer uma conexão com o primeiro servidor ao qual o balanceamento de carga de DNS a referencia, eles não poderão fazer failover para outro servidor no pool .</span><span class="sxs-lookup"><span data-stu-id="fb52d-292">Earlier versions of clients and Office Communications Server can still connect to pools running DNS load balancing, but if they cannot make a connection to the first server that DNS load balancing refers them to, they are unable to fail over to another server in the pool.</span></span> 
  
<span data-ttu-id="fb52d-293">Além disso, se você estiver usando o Exchange UM, deverá usar no mínimo o Exchange 2010 SP1 para obter suporte para o balanceamento de carga de DNS do Skype for Business Server.</span><span class="sxs-lookup"><span data-stu-id="fb52d-293">Additionally, if you are using Exchange UM, you must use a minimum of Exchange 2010 SP1 to get support for Skype for Business Server DNS load balancing.</span></span> <span data-ttu-id="fb52d-294">Se você usar uma versão anterior do Exchange, os usuários não terão recursos de failover para estes cenários do Exchange UM:</span><span class="sxs-lookup"><span data-stu-id="fb52d-294">If you use an earlier version of Exchange, your users will not have failover capabilities for these Exchange UM scenarios:</span></span>
  
- <span data-ttu-id="fb52d-295">Jogando o correio de voz corporativo em seu telefone</span><span class="sxs-lookup"><span data-stu-id="fb52d-295">Playing their Enterprise voicemail on their phone</span></span>
    
- <span data-ttu-id="fb52d-296">Transferindo chamadas de um atendedor automático do Exchange UM</span><span class="sxs-lookup"><span data-stu-id="fb52d-296">Transferring calls from an Exchange UM Auto Attendant</span></span>
    
<span data-ttu-id="fb52d-297">Todos os outros cenários do Exchange UM funcionarão corretamente.</span><span class="sxs-lookup"><span data-stu-id="fb52d-297">All other Exchange UM scenarios will work properly.</span></span>
  
#### <a name="deploying-dns-load-balancing-on-front-end-pools-and-director-pools"></a><span data-ttu-id="fb52d-298">Implantando o balanceamento de carga de DNS em pools front-end e pools de diretor</span><span class="sxs-lookup"><span data-stu-id="fb52d-298">Deploying DNS Load Balancing on Front End Pools and Director Pools</span></span>
<span data-ttu-id="fb52d-299"><a name="BK_FE_Dir"> </a></span><span class="sxs-lookup"><span data-stu-id="fb52d-299"><a name="BK_FE_Dir"> </a></span></span>

<span data-ttu-id="fb52d-300">Implantar o balanceamento de carga de DNS nos pools front-end e nos pools de diretor exige que você execute algumas etapas adicionais com FQDNs e registros DNS.</span><span class="sxs-lookup"><span data-stu-id="fb52d-300">Deploying DNS load balancing on Front End pools and Director pools requires you to perform a couple of extra steps with FQDNs and DNS records.</span></span>
  
- <span data-ttu-id="fb52d-301">Um pool que usa o balanceamento de carga de DNS deve ter dois FQDNs: o FQDN do pool regular que é usado pelo balanceamento de carga de DNS (como pool01.contoso.com) e é resolvido para o IPs físicos dos servidores no pool e outro FQDN para os serviços Web do pool (como web01.contoso.com), que é resolvido para o endereço IP virtual do pool.</span><span class="sxs-lookup"><span data-stu-id="fb52d-301">A pool that uses DNS load balancing must have two FQDNs: the regular pool FQDN that is used by DNS load balancing (such as pool01.contoso.com), and resolves to the physical IPs of the servers in the pool, and another FQDN for the pool's Web services (such as web01.contoso.com), which resolves to virtual IP address of the pool.</span></span> 
    
    <span data-ttu-id="fb52d-302">Em Construtor de topologia, se você quiser implantar o balanceamento de carga de DNS para um pool, para criar esse FQDN adicional para os serviços Web do pool, você deve selecionar a caixa de seleção **substituir FQDN do pool de serviços Web internos** e digitar o FQDN na página **especificar as URLs de serviços Web para este pool** .</span><span class="sxs-lookup"><span data-stu-id="fb52d-302">In Topology Builder, if you want to deploy DNS load balancing for a pool, to create this extra FQDN for the pool's Web services you must select the **Override internal Web Services pool FQDN** check box and type the FQDN, in the **Specify the Web Services URLs for this Pool** page.</span></span>
    
- <span data-ttu-id="fb52d-303">Para dar suporte ao FQDN usado pelo balanceamento de carga de DNS, você deve provisionar o DNS para resolver o FQDN do pool (como pool01.contoso.com) para os endereços IP de todos os servidores do pool (por exemplo, 192.168.1.1, 192.168.1.2 e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="fb52d-303">To support the FQDN used by DNS load balancing, you must provision DNS to resolve the pool FQDN (such as pool01.contoso.com) to the IP addresses of all the servers in the pool (for example, 192.168.1.1, 192.168.1.2, and so on).</span></span> <span data-ttu-id="fb52d-304">Você deve incluir somente os endereços IP dos servidores que estão implantados no momento.</span><span class="sxs-lookup"><span data-stu-id="fb52d-304">You should include only the IP addresses of servers that are currently deployed.</span></span>
    
    > [!CAUTION]
    > <span data-ttu-id="fb52d-305">Se você tiver mais de um servidor front-end ou servidor front-end, os serviços Web externos FQDN deverão ser exclusivos.</span><span class="sxs-lookup"><span data-stu-id="fb52d-305">If you have more than one Front End pool or Front End Server the external Web services FQDN must be unique.</span></span> <span data-ttu-id="fb52d-306">Por exemplo, se você definir o FQDN de serviços Web externos de um servidor front-end como **pool01.contoso.com**, não será possível usar o **pool01.contoso.com** para outro pool de front-end ou servidor front-end.</span><span class="sxs-lookup"><span data-stu-id="fb52d-306">For example, if you define the external Web services FQDN of a Front End Server as **pool01.contoso.com**, you cannot use **pool01.contoso.com** for another Front End pool or Front End Server.</span></span> <span data-ttu-id="fb52d-307">Se você também estiver implantando diretores, os serviços Web externos FQDN definidos para qualquer diretor de director ou diretor devem ser exclusivos de qualquer outro diretor ou pool de director, bem como qualquer pool de front-end ou servidor front-end.</span><span class="sxs-lookup"><span data-stu-id="fb52d-307">If you are also deploying Directors, the external Web services FQDN defined for any Director or Director pool must be unique from any other Director or Director pool as well as any Front End pool or Front End Server.</span></span> <span data-ttu-id="fb52d-308">Se decidir substituir os serviços internos da Web por um FQDN autodefinido, cada FQDN deve ser exclusivo de qualquer outro pool de front-end, diretor ou um pool de diretor.</span><span class="sxs-lookup"><span data-stu-id="fb52d-308">If decide to override the Internal web services with a self-defined FQDN, each FQDN must be unique from any other Front End pool, Director or a Director pool.</span></span>
  
### <a name="dns-load-balancing-on-edge-server-pools"></a><span data-ttu-id="fb52d-309">Balanceamento de carga de DNS nos pools do servidor de borda</span><span class="sxs-lookup"><span data-stu-id="fb52d-309">DNS Load Balancing on Edge Server Pools</span></span>
<span data-ttu-id="fb52d-310"><a name="BK_Edge"> </a></span><span class="sxs-lookup"><span data-stu-id="fb52d-310"><a name="BK_Edge"> </a></span></span>

<span data-ttu-id="fb52d-311">Você pode implantar o balanceamento de carga de DNS nos pools do servidor de borda.</span><span class="sxs-lookup"><span data-stu-id="fb52d-311">You can deploy DNS load balancing on Edge Server pools.</span></span> <span data-ttu-id="fb52d-312">Se fizer isso, você deve estar ciente de algumas considerações.</span><span class="sxs-lookup"><span data-stu-id="fb52d-312">If you do, you must be aware of some considerations.</span></span>
  
<span data-ttu-id="fb52d-313">Usar o balanceamento de carga de DNS em seus servidores de borda causa uma perda de capacidade de failover nos seguintes cenários:</span><span class="sxs-lookup"><span data-stu-id="fb52d-313">Using DNS load balancing on your Edge Servers causes a loss of failover ability in the following scenarios:</span></span>
  
- <span data-ttu-id="fb52d-314">Federação com organizações que estão executando versões do Skype for Business Server lançadas antes do Lync Server 2010.</span><span class="sxs-lookup"><span data-stu-id="fb52d-314">Federation with organizations that are running versions of Skype for Business Server released prior to Lync Server 2010.</span></span>
    
- <span data-ttu-id="fb52d-315">Troca de mensagens de chat com usuários de serviços de mensagens instantâneas (IM) e Yahoo!, além de provedores e servidores baseados em XMPP, como o Google Talk, atualmente o único parceiro XMPP com suporte.</span><span class="sxs-lookup"><span data-stu-id="fb52d-315">Instant message exchange with users of public instant messaging (IM) services AOL and Yahoo!, in addition to XMPP-based providers and servers, such as Google Talk, currently the only supported XMPP partner.</span></span>
    
<span data-ttu-id="fb52d-316">Esses cenários funcionarão se todos os servidores de borda do pool estiverem em execução, mas se um servidor de borda estiver indisponível, todas as solicitações para esses cenários enviados a ele falharão, em vez de roteamento para outro servidor de borda.</span><span class="sxs-lookup"><span data-stu-id="fb52d-316">These scenarios will work as long as all Edge Servers in the pool are up and running, but if one Edge Server is unavailable, any requests for these scenarios that are sent to it will fail, instead of routing to another Edge Server.</span></span>
  
 <span data-ttu-id="fb52d-317">Se estiver usando o Exchange UM, você deve usar no mínimo o Exchange 2013 para obter suporte para o balanceamento de carga de DNS do Skype for Business Server no Edge.</span><span class="sxs-lookup"><span data-stu-id="fb52d-317">If you are using Exchange UM, you must use a minimum of Exchange 2013 to get support for Skype for Business Server DNS load balancing on Edge.</span></span> <span data-ttu-id="fb52d-318">Se você usar uma versão anterior do Exchange, os usuários remotos não terão recursos de failover para estes cenários do Exchange UM:</span><span class="sxs-lookup"><span data-stu-id="fb52d-318">If you use an earlier version of Exchange, your remote users will not have failover capabilities for these Exchange UM scenarios:</span></span>
  
- <span data-ttu-id="fb52d-319">Jogando o correio de voz corporativo em seu telefone</span><span class="sxs-lookup"><span data-stu-id="fb52d-319">Playing their Enterprise voicemail on their phone</span></span>
    
- <span data-ttu-id="fb52d-320">Transferindo chamadas de um atendedor automático do Exchange UM</span><span class="sxs-lookup"><span data-stu-id="fb52d-320">Transferring calls from an Exchange UM Auto Attendant</span></span>
    
<span data-ttu-id="fb52d-321">Todos os outros cenários do Exchange UM funcionarão corretamente.</span><span class="sxs-lookup"><span data-stu-id="fb52d-321">All other Exchange UM scenarios will work properly.</span></span>
  
<span data-ttu-id="fb52d-322">As interfaces de Borda interna e externa precisam usar o mesmo tipo de balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="fb52d-322">The internal Edge interface and external Edge interface must use the same type of load balancing.</span></span> <span data-ttu-id="fb52d-323">Não é possível usar balanceamento de carga DNS em uma interface de Borda e balanceamento de carga de hardware na outra interface de Borda.</span><span class="sxs-lookup"><span data-stu-id="fb52d-323">You cannot use DNS load balancing on one Edge interface and hardware load balancing on the other Edge interface.</span></span>
  
#### <a name="deploying-dns-load-balancing-on-edge-server-pools"></a><span data-ttu-id="fb52d-324">Implantando o balanceamento de carga de DNS nos pools do servidor de borda</span><span class="sxs-lookup"><span data-stu-id="fb52d-324">Deploying DNS Load Balancing on Edge Server Pools</span></span>

<span data-ttu-id="fb52d-325">Para implantar o balanceamento de carga de DNS na interface externa do pool do servidor de borda, você precisa das seguintes entradas de DNS:</span><span class="sxs-lookup"><span data-stu-id="fb52d-325">To deploy DNS load balancing on the external interface of your Edge Server pool, you need the following DNS entries:</span></span>
  
- <span data-ttu-id="fb52d-326">Para o serviço de borda de acesso, você precisa de uma entrada para cada servidor do pool.</span><span class="sxs-lookup"><span data-stu-id="fb52d-326">For the Access Edge service, you need one entry for each server in the pool.</span></span> <span data-ttu-id="fb52d-327">Cada entrada deve resolver o FQDN do serviço de borda de acesso (por exemplo, sip.contoso.com) para o endereço IP do serviço de borda de acesso em um dos servidores de borda do pool.</span><span class="sxs-lookup"><span data-stu-id="fb52d-327">Each entry must resolve the FQDN of the Access Edge service (for example, sip.contoso.com) to the IP address of the Access Edge service on one of the Edge Servers in the pool.</span></span>
    
- <span data-ttu-id="fb52d-328">Para o serviço da borda de webconferência, você precisa de uma entrada para cada servidor do pool.</span><span class="sxs-lookup"><span data-stu-id="fb52d-328">For the Web Conferencing Edge service, you need one entry for each server in the pool.</span></span> <span data-ttu-id="fb52d-329">Cada entrada deve resolver o FQDN do serviço de borda de Webconferência (por exemplo, webconf.contoso.com) para o endereço IP do serviço Web de Webconferência em um dos servidores de borda no pool.</span><span class="sxs-lookup"><span data-stu-id="fb52d-329">Each entry must resolve the FQDN of the Web Conferencing Edge service (for example, webconf.contoso.com) to the IP address of the Web Conferencing Edge service on one of the Edge Servers in the pool.</span></span>
    
- <span data-ttu-id="fb52d-330">Para o serviço de borda de áudio/vídeo, você precisa de uma entrada para cada servidor do pool.</span><span class="sxs-lookup"><span data-stu-id="fb52d-330">For the Audio/Video Edge service, you need one entry for each server in the pool.</span></span> <span data-ttu-id="fb52d-331">Cada entrada deve resolver o FQDN do serviço de borda de áudio/vídeo (por exemplo, av.contoso.com) para o endereço IP do serviço de borda A/V em um dos servidores de borda do pool.</span><span class="sxs-lookup"><span data-stu-id="fb52d-331">Each entry must resolve the FQDN of the Audio/Video Edge service (for example, av.contoso.com) to the IP address of the A/V Edge service on one of the Edge Servers in the pool.</span></span>
    
<span data-ttu-id="fb52d-332">Para implantar o balanceamento de carga de DNS na interface interna do pool do servidor de borda, você deve adicionar um registro DNS A, que resolve o FQDN interno do pool do servidor de borda para o endereço IP de cada servidor do pool.</span><span class="sxs-lookup"><span data-stu-id="fb52d-332">To deploy DNS load balancing on the internal interface of your Edge Server pool, you must add one DNS A record, which resolves the internal FQDN of the Edge Server pool to the IP address of each server in the pool.</span></span>
  
### <a name="using-dns-load-balancing-on-mediation-server-pools"></a><span data-ttu-id="fb52d-333">Usar o balanceamento de carga de DNS nos pools do servidor de mediação</span><span class="sxs-lookup"><span data-stu-id="fb52d-333">Using DNS Load Balancing on Mediation Server Pools</span></span>
<span data-ttu-id="fb52d-334"><a name="BK_Mediation"> </a></span><span class="sxs-lookup"><span data-stu-id="fb52d-334"><a name="BK_Mediation"> </a></span></span>

<span data-ttu-id="fb52d-335">Você pode usar o balanceamento de carga de DNS em pools de servidores de mediação autônomos.</span><span class="sxs-lookup"><span data-stu-id="fb52d-335">You can use DNS load balancing on stand-alone Mediation Server pools.</span></span> <span data-ttu-id="fb52d-336">Todo o tráfego SIP e de mídia é balanceado pelo balanceamento de carga de DNS.</span><span class="sxs-lookup"><span data-stu-id="fb52d-336">All SIP and media traffic is balanced by DNS load balancing.</span></span>
  
<span data-ttu-id="fb52d-337">Para implantar o balanceamento de carga de DNS em um pool do servidor de mediação, você deve provisionar o DNS para resolver o FQDN do pool (por exemplo, mediationpool1.contoso.com) para os endereços IP de todos os servidores do pool (por exemplo, 192.168.1.1, 192.168.1.2 e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="fb52d-337">To deploy DNS load balancing on a Mediation Server pool, you must provision DNS to resolve the pool FQDN (for example, mediationpool1.contoso.com) to the IP addresses of all the servers in the pool (for example, 192.168.1.1, 192.168.1.2, and so on).</span></span>
  
### <a name="blocking-traffic-to-a-server-with-dns-load-balancing"></a><span data-ttu-id="fb52d-338">Bloqueando o tráfego para um servidor com balanceamento de carga de DNS</span><span class="sxs-lookup"><span data-stu-id="fb52d-338">Blocking Traffic to a Server With DNS Load Balancing</span></span>
<span data-ttu-id="fb52d-339"><a name="BK_Mediation"> </a></span><span class="sxs-lookup"><span data-stu-id="fb52d-339"><a name="BK_Mediation"> </a></span></span>

<span data-ttu-id="fb52d-p142">Se você usar um balanceamento de carga DNS e precisar bloquear o tráfego para um computador específico, não é suficiente apenas remover as entradas do endereço IP do Pool FQDN. Você deve remover a entrada DNS do computador.</span><span class="sxs-lookup"><span data-stu-id="fb52d-p142">If you use DNS load balancing and you need to block traffic to a specific computer, it is not sufficient to just remove the IP address entries from the Pool FQDN. You must remove the DNS entry for the computer as well.</span></span> 
  
<span data-ttu-id="fb52d-342">Observe que, para o tráfego de servidor para servidor, o Skype for Business Server usa o balanceamento de carga compatível com topologia.</span><span class="sxs-lookup"><span data-stu-id="fb52d-342">Note that for server-to-server traffic, Skype for Business Server uses topology-aware load balancing.</span></span> <span data-ttu-id="fb52d-343">Os servidores lêem a topologia publicada no repositório de gerenciamento central para obter os FQDNs dos servidores na topologia e distribuir automaticamente o tráfego entre os servidores.</span><span class="sxs-lookup"><span data-stu-id="fb52d-343">Servers read the published topology in the Central Management store to obtain the FQDNs of servers in the topology, and automatically distribute the traffic among the servers.</span></span> <span data-ttu-id="fb52d-344">Para impedir que um servidor receba tráfego de servidor para servidor, você deve remover o servidor da topologia.</span><span class="sxs-lookup"><span data-stu-id="fb52d-344">To block a server from receiving server-to-server traffic, you must remove the server from the topology.</span></span> 
  

