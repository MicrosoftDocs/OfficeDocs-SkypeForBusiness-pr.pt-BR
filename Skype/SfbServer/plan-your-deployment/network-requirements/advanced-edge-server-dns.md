---
title: Planejamento avançado de DNS do Servidor de Borda para o Skype for Business Server
ms.reviewer: ''
ms.author: v-cichur
author: cichur
audience: ITPro
manager: serdars
ms.topic: conceptual
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- IT_Skype16
- Strat_SB_Hybrid
ms.custom: ''
ms.assetid: f3a5895f-f64f-44eb-9a5e-8d606ac1fc38
description: 'Resumo: revise os cenários das opções de implantação do Skype for Business Server. Quer você queira um único servidor ou prefira um pool de servidores com DNS ou HLB, este tópico deve ajudar.'
ms.openlocfilehash: 5a41baac30f3bf6a1e20ae34db009dae0cec40af
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/12/2021
ms.locfileid: "49825321"
---
# <a name="advanced-edge-server-dns-planning-for-skype-for-business-server"></a><span data-ttu-id="af5e2-104">Planejamento avançado de DNS do Servidor de Borda para o Skype for Business Server</span><span class="sxs-lookup"><span data-stu-id="af5e2-104">Advanced Edge Server DNS planning for Skype for Business Server</span></span>
 
<span data-ttu-id="af5e2-105">**Resumo:** Revise os cenários das opções de implantação do Skype for Business Server.</span><span class="sxs-lookup"><span data-stu-id="af5e2-105">**Summary:** Review scenarios for Skype for Business Server deployment options.</span></span> <span data-ttu-id="af5e2-106">Quer você queira um único servidor ou prefira um pool de servidores com DNS ou HLB, este tópico deve ajudar.</span><span class="sxs-lookup"><span data-stu-id="af5e2-106">Whether you want a single server or prefer a server pool with DNS or HLB, this topic should help.</span></span>
  
<span data-ttu-id="af5e2-107">No que diz respeito ao planejamento de DNS (Sistema de Nomes de Domínio) para o Skype for Business Server, há muitos fatores que podem ser relevantes para sua decisão.</span><span class="sxs-lookup"><span data-stu-id="af5e2-107">When it comes to Domain Name System (DNS) planning for Skype for Business Server, there are a lot of factors that may play into your decision.</span></span> <span data-ttu-id="af5e2-108">Se a estrutura de domínio da sua organização já estiver em uso, isso pode ser uma questão de analisar como você irá continuar.</span><span class="sxs-lookup"><span data-stu-id="af5e2-108">If your organization's domain structure's already in place, this may be a matter of reviewing how you're going to proceed.</span></span> <span data-ttu-id="af5e2-109">Vamos começar com os tópicos encontrados abaixo:</span><span class="sxs-lookup"><span data-stu-id="af5e2-109">We'll begin with the topics found below:</span></span>
  
- [<span data-ttu-id="af5e2-110">Passo a passo dos serviços de localização de clientes do Skype for Business</span><span class="sxs-lookup"><span data-stu-id="af5e2-110">Walkthrough of Skype for Business clients locating services</span></span>](../../plan-your-deployment/edge-server-deployments/advanced-edge-server-dns.md#WalkthroughOfSkype)
    
- [<span data-ttu-id="af5e2-111">DNS de dupla cabeça</span><span class="sxs-lookup"><span data-stu-id="af5e2-111">Split-brain DNS</span></span>](../../plan-your-deployment/edge-server-deployments/advanced-edge-server-dns.md#SplitBrainDNS)
    
- [<span data-ttu-id="af5e2-112">Configuração automática sem DNS de dupla dupla</span><span class="sxs-lookup"><span data-stu-id="af5e2-112">Automatic configuration without split-brain DNS</span></span>](../../plan-your-deployment/edge-server-deployments/advanced-edge-server-dns.md#NoSplitBrainDNS)
    
- [<span data-ttu-id="af5e2-113">Recuperação de desastre de DNS</span><span class="sxs-lookup"><span data-stu-id="af5e2-113">DNS disaster recovery</span></span>](../../plan-your-deployment/edge-server-deployments/advanced-edge-server-dns.md#DNSDR)
    
- [<span data-ttu-id="af5e2-114">Balanceamento de carga DNS</span><span class="sxs-lookup"><span data-stu-id="af5e2-114">DNS load balancing</span></span>](../../plan-your-deployment/edge-server-deployments/advanced-edge-server-dns.md#DNSLB)
    
## <a name="walkthrough-of-skype-for-business-clients-locating-services"></a><span data-ttu-id="af5e2-115">Passo a passo dos serviços de localização de clientes do Skype for Business</span><span class="sxs-lookup"><span data-stu-id="af5e2-115">Walkthrough of Skype for Business clients locating services</span></span>
<span data-ttu-id="af5e2-116"><a name="WalkthroughOfSkype"> </a></span><span class="sxs-lookup"><span data-stu-id="af5e2-116"><a name="WalkthroughOfSkype"> </a></span></span>

<span data-ttu-id="af5e2-117">Os clientes do Skype for Business são semelhantes às versões anteriores dos clientes do Lync na forma como encontram e acessam serviços no Skype for Business Server.</span><span class="sxs-lookup"><span data-stu-id="af5e2-117">Skype for Business clients are similar to previous versions of Lync clients in how they find and access services in Skype for Business Server.</span></span> <span data-ttu-id="af5e2-118">Esta seção detalha o processo de localização do servidor.</span><span class="sxs-lookup"><span data-stu-id="af5e2-118">This section details the server location process.</span></span>
  
1. <span data-ttu-id="af5e2-119">lyncdiscoverinternal.\<domain\></span><span class="sxs-lookup"><span data-stu-id="af5e2-119">lyncdiscoverinternal.\<domain\></span></span>
    
     <span data-ttu-id="af5e2-120">*Esse é um registro de host A para o serviço de Descoberta Automática nos serviços Web internos.*</span><span class="sxs-lookup"><span data-stu-id="af5e2-120">*This is an A host record for the Autodiscover service on the internal web services.*</span></span> 
    
2. <span data-ttu-id="af5e2-121">lyncdiscover.\<domain\></span><span class="sxs-lookup"><span data-stu-id="af5e2-121">lyncdiscover.\<domain\></span></span>
    
     <span data-ttu-id="af5e2-122">*Este é um registro de host A para o serviço de Descoberta Automática nos serviços Web externos.*</span><span class="sxs-lookup"><span data-stu-id="af5e2-122">*This is an A host record for the Autodiscover service on the external web services.*</span></span> 
    
3. <span data-ttu-id="af5e2-123">_sipinternaltls._tcp.\<domain\></span><span class="sxs-lookup"><span data-stu-id="af5e2-123">_sipinternaltls._tcp.\<domain\></span></span>
    
     <span data-ttu-id="af5e2-124">*Este é um registro SRV para conexões TLS internas.*</span><span class="sxs-lookup"><span data-stu-id="af5e2-124">*This is a SRV record for internal TLS connections.*</span></span> 
    
4. <span data-ttu-id="af5e2-125">_sip._tls.\<domain\></span><span class="sxs-lookup"><span data-stu-id="af5e2-125">_sip._tls.\<domain\></span></span>
    
     <span data-ttu-id="af5e2-126">*Este é um registro SRV para conexões TLS externas.*</span><span class="sxs-lookup"><span data-stu-id="af5e2-126">*This is a SRV record for external TLS connections.*</span></span> 
    
5. <span data-ttu-id="af5e2-127">sipinternal.\<domain\></span><span class="sxs-lookup"><span data-stu-id="af5e2-127">sipinternal.\<domain\></span></span>
    
     <span data-ttu-id="af5e2-128">*Trata-se de um registro de host A para o pool de Front-End ou Diretor, que pode ser resolvido somente na rede interna.*</span><span class="sxs-lookup"><span data-stu-id="af5e2-128">*This is an A host record for the Front End pool or Director, resolvable only on the internal network.*</span></span> 
    
6. <span data-ttu-id="af5e2-129">sip.\<domain\></span><span class="sxs-lookup"><span data-stu-id="af5e2-129">sip.\<domain\></span></span>
    
     <span data-ttu-id="af5e2-130">*Trata-se de um registro de host A para o pool de Front-End ou Diretor, que pode ser resolvido somente na rede interna.*</span><span class="sxs-lookup"><span data-stu-id="af5e2-130">*This is an A host record for the Front End pool or Director, resolvable only on the internal network.*</span></span> 
    
7. <span data-ttu-id="af5e2-131">sipexternal.\<domain\></span><span class="sxs-lookup"><span data-stu-id="af5e2-131">sipexternal.\<domain\></span></span>
    
     <span data-ttu-id="af5e2-132">*Esse é um registro de host A para o serviço de Borda de Acesso, quando o cliente é externo.*</span><span class="sxs-lookup"><span data-stu-id="af5e2-132">*This is an A host record for the Access Edge service, when the client is external.*</span></span> 
    
<span data-ttu-id="af5e2-133">O serviço descoberta automática é sempre favorecido, pois esse é o método preferencial para o local do serviço, e os outros são métodos de fallback.</span><span class="sxs-lookup"><span data-stu-id="af5e2-133">The Autodiscover service is always favored as that's the preferred method for service location, and the others are fallback methods.</span></span>
  
> [!NOTE]
> <span data-ttu-id="af5e2-134">Ao criar registros SRV, é importante lembrar que eles precisam apontar para um DNS A (e AAAA se você estiver usando endereçamento IPv6) no mesmo domínio no qual o registro SRV dns está sendo criado.</span><span class="sxs-lookup"><span data-stu-id="af5e2-134">When you're creating SRV records, it's important to remember that they need to point to a DNS A (and AAAA if you're using IPv6 addressing) in the same domain in which the DNS SRV record's being created.</span></span> <span data-ttu-id="af5e2-135">Por exemplo, se o registro SRV estiver contoso.com, o registro A (e AAAA) para o fabrikam.com.</span><span class="sxs-lookup"><span data-stu-id="af5e2-135">For example, if they SRV record's in contoso.com, the A (and AAAA) record it points to can't be in fabrikam.com.</span></span> 
  
<span data-ttu-id="af5e2-136">Se você estiver propenso a fazer isso, poderá configurar seu dispositivo móvel para descoberta manual de serviços.</span><span class="sxs-lookup"><span data-stu-id="af5e2-136">If you're inclined to do it, you can set your mobile device up for manual discovery of services.</span></span> <span data-ttu-id="af5e2-137">Se você quiser fazer isso, cada usuário precisará definir suas configurações de dispositivo móvel com os URIs completos do serviço de Descoberta Automática interna e externa, incluindo o protocolo e o caminho, da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="af5e2-137">If that's what you're looking to do, each user needs to configure their mobile device settings with the full internal and external Autodiscover service URIs, including the protocol and path, as follows:</span></span>
  
- <span data-ttu-id="af5e2-138">Para acesso externo: https:// \<ExtPoolFQDN\> /Autodiscover/autodiscoverservice.svc/Root</span><span class="sxs-lookup"><span data-stu-id="af5e2-138">For external access: https://\<ExtPoolFQDN\>/Autodiscover/autodiscoverservice.svc/Root</span></span>
    
- <span data-ttu-id="af5e2-139">Para acesso interno: https:// \<IntPoolFQDN\> /AutoDiscover/AutoDiscover.svc/Root</span><span class="sxs-lookup"><span data-stu-id="af5e2-139">For internal access: https://\<IntPoolFQDN\>/AutoDiscover/AutoDiscover.svc/Root</span></span>
    
<span data-ttu-id="af5e2-140">Recomendamos que você use a descoberta automática em vez da descoberta manual.</span><span class="sxs-lookup"><span data-stu-id="af5e2-140">We do recommend you use automatic discovery as opposed to manual discovery.</span></span> <span data-ttu-id="af5e2-141">Mas se você estiver solucionando problemas ou testando, as configurações manuais podem ser muito úteis.</span><span class="sxs-lookup"><span data-stu-id="af5e2-141">But if you're doing some troubleshooting or testing, manual settings can be very helpful.</span></span>
  
## <a name="split-brain-dns"></a><span data-ttu-id="af5e2-142">DNS de dupla cabeça</span><span class="sxs-lookup"><span data-stu-id="af5e2-142">Split-brain DNS</span></span>
<span data-ttu-id="af5e2-143"><a name="SplitBrainDNS"> </a></span><span class="sxs-lookup"><span data-stu-id="af5e2-143"><a name="SplitBrainDNS"> </a></span></span>

<span data-ttu-id="af5e2-144">Esta é uma configuração DNS em que você tem duas zonas DNS com o mesmo namespace.</span><span class="sxs-lookup"><span data-stu-id="af5e2-144">This is a DNS configuration where you have two DNS zones with the same namespace.</span></span> <span data-ttu-id="af5e2-145">A primeira zona DNS lida com solicitações internas, enquanto a segunda zona DNS lida com solicitações externas.</span><span class="sxs-lookup"><span data-stu-id="af5e2-145">The first DNS zone handles internal requests, while the second DNS zone handles external requests.</span></span>
  
<span data-ttu-id="af5e2-146">Por que uma empresa faria isso?</span><span class="sxs-lookup"><span data-stu-id="af5e2-146">Why would a company do this?</span></span> <span data-ttu-id="af5e2-147">Eles podem ter a necessidade de usar o mesmo namespace interna e externamente, mas é claro que isso fará com que muitos registros SRV e A de DNS sejam exclusivos para uma ou outra zona e, onde houver duplicação, os endereços IP associados a esses registros serão exclusivos.</span><span class="sxs-lookup"><span data-stu-id="af5e2-147">They may have a requirement to use the same namespace internally and externally, but of course this will lead to many DNS SRV and A records being unique to one zone or another, and where there is duplication, the IP addresses associated with these records would be unique.</span></span>
  
<span data-ttu-id="af5e2-148">Isso apresenta alguns desafios.</span><span class="sxs-lookup"><span data-stu-id="af5e2-148">This presents some challenges.</span></span> <span data-ttu-id="af5e2-149">O mais importante é que o DNS split-brain **não é suportado** para Mobilidade.</span><span class="sxs-lookup"><span data-stu-id="af5e2-149">The most important is that split-brain DNS is **not supported** for Mobility.</span></span> <span data-ttu-id="af5e2-150">Isso se deve aos registros DNS LyncDiscover e LyncDiscoverInternal (LyncDiscover deve ser definido em seu servidor DNS externo, enquanto LyncDiscoverInternal precisa ser definido em seu servidor DNS interno).</span><span class="sxs-lookup"><span data-stu-id="af5e2-150">This is because of the LyncDiscover and LyncDiscoverInternal DNS records (LyncDiscover has to be defined on you external DNS server, while LyncDiscoverInternal has to be defined on your internal DNS server).</span></span>
  
<span data-ttu-id="af5e2-151">Listamos os registros DNS das zonas interna e externa aqui, mas você pode encontrar exemplos detalhados na seção de requisitos ambientais do Servidor de Borda.</span><span class="sxs-lookup"><span data-stu-id="af5e2-151">We'll list the DNS records for the internal and external zones here, but you can find detailed examples on the Edge Server environmental requirements section.</span></span>
  
### <a name="internal-dns"></a><span data-ttu-id="af5e2-152">DNS Interno</span><span class="sxs-lookup"><span data-stu-id="af5e2-152">Internal DNS</span></span>

- <span data-ttu-id="af5e2-153">Contém uma zona DNS chamada (por exemplo) contoso.com, para a qual é autoritativa.</span><span class="sxs-lookup"><span data-stu-id="af5e2-153">Contains a DNS zone called (for example) contoso.com, for which it's authoritative.</span></span>
    
- <span data-ttu-id="af5e2-154">Este contoso.com interno contém:</span><span class="sxs-lookup"><span data-stu-id="af5e2-154">This internal contoso.com contains:</span></span>
    
  - <span data-ttu-id="af5e2-155">Registros DNS A e AAAA (se você estiver usando endereçamento IPv6) para seu pool de Front-End, pool de Diretores ou nome do pool de Diretores e todos os servidores internos executando o Skype for Business Server na rede da sua organização.</span><span class="sxs-lookup"><span data-stu-id="af5e2-155">DNS A and AAAA (if you're using IPv6 addressing) records for your Front End pool, Director pool or Director pool name, and all internal servers running Skype for Business Server in your organization's network.</span></span>
    
  - <span data-ttu-id="af5e2-156">Registros DNS A e AAAA (se você estiver usando endereçamento IPv6) para sua interface interna de Borda para cada Servidor de Borda do Skype for Business Server em sua rede de perímetro.</span><span class="sxs-lookup"><span data-stu-id="af5e2-156">DNS A and AAAA (if you're using IPv6 addressing) records for your Edge internal interface for each Skype for Business Server Edge Server in your perimeter network.</span></span>
    
  - <span data-ttu-id="af5e2-157">Registros DNS A e AAAA (se você estiver usando endereçamento IPv6) para a  interface interna de cada servidor proxy reverso em sua rede de perímetro (que é opcional para o gerenciamento de um proxy reverso).</span><span class="sxs-lookup"><span data-stu-id="af5e2-157">DNS A and AAAA (if you're using IPv6 addressing) records for the internal interface of each reverse proxy server in your perimeter network (which is **optional** for management of a reverse proxy).</span></span>
    
  - <span data-ttu-id="af5e2-158">Registros DNS A e AAAA (se você estiver usando endereçamento IPv6) e SRV para configuração automática do cliente interno do Skype for Business Server (que é **opcional).**</span><span class="sxs-lookup"><span data-stu-id="af5e2-158">DNS A and AAAA (if you're using IPv6 addressing) and SRV records for internal Skype for Business Server client autoconfiguration (which is **optional** ).</span></span>
    
  - <span data-ttu-id="af5e2-159">Registros DNS A e AAAA (se você estiver usando endereçamento IPv6) ou CNAME para descoberta automática dos Serviços Web do Skype for Business Server (que é **opcional).**</span><span class="sxs-lookup"><span data-stu-id="af5e2-159">DNS A and AAAA (if you're using IPv6 addressing) or CNAME records for automatic discovery of Skype for Business Server Web Services (which is **optional** ).</span></span>
    
- <span data-ttu-id="af5e2-160">Todas as interfaces de Borda interna do Skype for Business Server em sua rede de perímetro usam essa zona DNS interna para resolver consultas para contoso.com.</span><span class="sxs-lookup"><span data-stu-id="af5e2-160">All your Skype for Business Server internal Edge interfaces in your perimeter network use this internal DNS zone for resolving queries to contoso.com.</span></span>
    
- <span data-ttu-id="af5e2-161">Todos os servidores que executam o Skype for Business Server e clientes que executam o Skype for Business Server na rede corporativa apontam para servidores DNS internos para resolver consultas no contoso.com ou usam o arquivo Host em cada Servidor de Borda e registros A e AAAA (se você estiver usando endereçamento IPv6) para o servidor do próximo salto (especificamente para o VIP do Diretor ou do pool de Diretores , VIP do pool de front-end ou servidor Standard Edition).</span><span class="sxs-lookup"><span data-stu-id="af5e2-161">All servers running Skype for Business Server, and clients running Skype for Business Server in the corporate network, point to internal DNS servers for resolving queries to contoso.com, or they use the Host file on each Edge Server and list A and AAAA (if you're using IPv6 addressing) records for the next hop server (specifically for the Director or Director pool VIP, Front End pool VIP, or Standard Edition server).</span></span>
    
### <a name="external-dns"></a><span data-ttu-id="af5e2-162">DNS externo</span><span class="sxs-lookup"><span data-stu-id="af5e2-162">External DNS</span></span>

- <span data-ttu-id="af5e2-163">Contém uma zona DNS chamada (por exemplo) contoso.com, para a qual é autoritativa.</span><span class="sxs-lookup"><span data-stu-id="af5e2-163">Contains a DNS zone called (for example) contoso.com, for which it's authoritative.</span></span>
    
- <span data-ttu-id="af5e2-164">Este contoso.com externo contém:</span><span class="sxs-lookup"><span data-stu-id="af5e2-164">This external contoso.com contains:</span></span>
    
  - <span data-ttu-id="af5e2-165">Registros DNS A e AAAA (se você estiver usando endereçamento IPv6) ou CNAME, para descoberta automática de serviços Web do Skype for Business Server.</span><span class="sxs-lookup"><span data-stu-id="af5e2-165">DNS A and AAAA (if you're using IPv6 addressing), or CNAME records, for automatic discovery of Skype for Business Server web services.</span></span> <span data-ttu-id="af5e2-166">Isso é para uso com mobilidade.</span><span class="sxs-lookup"><span data-stu-id="af5e2-166">This is for use with mobility.</span></span>
    
  - <span data-ttu-id="af5e2-167">Registros DNS A e AAAA (se você estiver usando endereçamento IPv6) e SRV para a interface externa de Borda de cada Servidor de Borda do Skype for Business Server ou VIP com balanceamento de carga de hardware (HLB) na rede de perímetro.</span><span class="sxs-lookup"><span data-stu-id="af5e2-167">DNS A and AAAA (if you're using IPv6 addressing) and SRV records for the Edge external interface of each Skype for Business Server Edge Server or hardware load balanced (HLB) VIP in the perimeter network.</span></span>
    
  - <span data-ttu-id="af5e2-168">Registros DNS A e AAAA (se você estiver usando endereçamento IPv6) e SRV para a interface externa do servidor proxy reverso ou (VIP para um pool de servidores proxy reverso), na rede de perímetro.</span><span class="sxs-lookup"><span data-stu-id="af5e2-168">DNS A and AAAA (if you're using IPv6 addressing) and SRV records for the external interface of the Reverse proxy server or (VIP for a pool of Reverse proxy servers), in the perimeter network.</span></span>
    
  - <span data-ttu-id="af5e2-169">Registros DNS A e AAAA (se você estiver usando endereçamento IPv6) e SRV para configuração automática de cliente do Skype for Business Server **(opcional).**</span><span class="sxs-lookup"><span data-stu-id="af5e2-169">DNS A and AAAA (if you're using IPv6 addressing) and SRV records for Skype for Business Server client autoconfiguration ( **optional** ).</span></span>
    
## <a name="automatic-configuration-without-split-brain-dns"></a><span data-ttu-id="af5e2-170">Configuração automática sem DNS de dupla dupla</span><span class="sxs-lookup"><span data-stu-id="af5e2-170">Automatic configuration without split-brain DNS</span></span>
<span data-ttu-id="af5e2-171"><a name="NoSplitBrainDNS"> </a></span><span class="sxs-lookup"><span data-stu-id="af5e2-171"><a name="NoSplitBrainDNS"> </a></span></span>

<span data-ttu-id="af5e2-172">Se você não usar o DNS split-brain, a configuração automática interna dos clientes que executam o Skype for Business não funcionará, a menos que você esteja usando uma das soluções alternativas que temos aqui.</span><span class="sxs-lookup"><span data-stu-id="af5e2-172">If you don't use split-brain DNS, internal automatic configuration of clients running Skype for Business won't work unless you're using one of the workarounds we have here.</span></span> <span data-ttu-id="af5e2-173">Por que não?</span><span class="sxs-lookup"><span data-stu-id="af5e2-173">Why not?</span></span> <span data-ttu-id="af5e2-174">Como o Skype for Business Server requer que o URI sip do usuário corresponder ao domínio do pool de Front-End designado para configuração automática.</span><span class="sxs-lookup"><span data-stu-id="af5e2-174">Because Skype for Business Server requires the user's SIP URI to match the domain of the Front End pool designated for automatic configuration.</span></span> <span data-ttu-id="af5e2-175">Isso não mudou em versões anteriores do Lync Server.</span><span class="sxs-lookup"><span data-stu-id="af5e2-175">This hasn't changed from earlier versions of Lync Server.</span></span>
  
<span data-ttu-id="af5e2-176">Portanto, se você tiver dois domínios SIP em uso, precisará destes registros SRV dns:</span><span class="sxs-lookup"><span data-stu-id="af5e2-176">So, if you have two SIP domains in use, you'd need these DNS SRV records:</span></span>
  
- <span data-ttu-id="af5e2-177">_sipinternaltls._tcp.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="af5e2-177">_sipinternaltls._tcp.contoso.com.</span></span> <span data-ttu-id="af5e2-178">86400 IN SRV 0 0 5061 pool01.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-178">86400 IN SRV 0 0 5061 pool01.contoso.com</span></span>
    
     <span data-ttu-id="af5e2-179">*Se um usuário entrar como bob@contoso.com, esse registro funcionará para a configuração automática, pois o domínio SIP do usuário corresponde ao domínio do pool de front-end (contoso.com).*</span><span class="sxs-lookup"><span data-stu-id="af5e2-179">*If a user signs in as bob@contoso.com, this record would work for automatic configuration, as the user's SIP domain matches the domain of the Front End pool (contoso.com).*</span></span> 
    
- <span data-ttu-id="af5e2-180">_sipinternaltls._tcp.fabrikam.com.</span><span class="sxs-lookup"><span data-stu-id="af5e2-180">_sipinternaltls._tcp.fabrikam.com.</span></span> <span data-ttu-id="af5e2-181">86400 IN SRV 0 0 5061 pool01.fabrikam.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-181">86400 IN SRV 0 0 5061 pool01.fabrikam.com</span></span>
    
     <span data-ttu-id="af5e2-182">*Se um usuário entrar como alice@fabrikam.com, esse registro funcionará para a configuração automática do segundo domínio, novamente porque o domínio SIP corresponde ao pool de Front-End desse domínio.*</span><span class="sxs-lookup"><span data-stu-id="af5e2-182">*If a user signs in as alice@fabrikam.com, this record would work for automatic configuration of the second domain, again because the SIP domain matches the Front End pool for that domain.*</span></span> 
    
<span data-ttu-id="af5e2-183">Para levar o exemplo adiante, isso não funcionaria:</span><span class="sxs-lookup"><span data-stu-id="af5e2-183">To take the example further, this would not work:</span></span>
  
- <span data-ttu-id="af5e2-184">_sipinternaltls._tcp.litwareinc.com.</span><span class="sxs-lookup"><span data-stu-id="af5e2-184">_sipinternaltls._tcp.litwareinc.com.</span></span> <span data-ttu-id="af5e2-185">86400 IN SRV 0 0 5061 pool01.fabrikam.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-185">86400 IN SRV 0 0 5061 pool01.fabrikam.com</span></span>
    
     <span data-ttu-id="af5e2-186">*Um usuário que entrar como tim@litwareinc.com não funcionará para a configuração automática, pois seu domínio SIP (litwareinc.com) não combina com o domínio no pool (fabrikam.com).*</span><span class="sxs-lookup"><span data-stu-id="af5e2-186">*A user signing in as tim@litwareinc.com won't work for automatic configuration, because his SIP domain (litwareinc.com) doesn't match the domain in the pool (fabrikam.com).*</span></span> 
    
<span data-ttu-id="af5e2-187">Agora que sabemos tudo isso, se você precisar de requisitos automáticos para seus clientes do Skype for Business sem DNS split-brain, terá estas opções:</span><span class="sxs-lookup"><span data-stu-id="af5e2-187">So now that we know all that, if you need automatic requirement for your Skype for Business clients without split-brain DNS, you have these options:</span></span>
  
- <span data-ttu-id="af5e2-188">**Objetos de Política de Grupo**</span><span class="sxs-lookup"><span data-stu-id="af5e2-188">**Group Policy Objects**</span></span>
    
    <span data-ttu-id="af5e2-189">Você pode usar GPOs (Objetos de Política de Grupo) para preencher os valores corretos do servidor.</span><span class="sxs-lookup"><span data-stu-id="af5e2-189">You can use Group Policy Objects (GPOs) to populate the correct server values.</span></span>
    
    > [!NOTE]
    > <span data-ttu-id="af5e2-190">Essa opção não habilita a configuração automática, mas automatiza a configuração manual.</span><span class="sxs-lookup"><span data-stu-id="af5e2-190">This option doesn't enable automatic configuration, but it does automate manual configuration.</span></span> <span data-ttu-id="af5e2-191">Se essa abordagem for usada, os registros SRV associados à configuração automática não são necessários.</span><span class="sxs-lookup"><span data-stu-id="af5e2-191">If this approach is used, the SRV records associated with automatic configuration aren't required.</span></span> 
  
- <span data-ttu-id="af5e2-192">**Comparação da zona interna**</span><span class="sxs-lookup"><span data-stu-id="af5e2-192">**Matching internal zone**</span></span>
    
    <span data-ttu-id="af5e2-193">Você precisará criar uma zona em seu DNS interno que corresponda à zona dns externa (por exemplo, contoso.com) e, em seguida, criar registros A (e AAAA de DNS se você estiver usando endereçamento IPv6) que correspondam ao pool do Skype for Business Server usado para configuração automática.</span><span class="sxs-lookup"><span data-stu-id="af5e2-193">You'll need to create a zone in your internal DNS that matches your external DNS zone (for example, contoso.com), and then create DNS A (and AAAA if you're using IPv6 addressing) records that correspond to the Skype for Business Server pool used for automatic configuration.</span></span>
    
    <span data-ttu-id="af5e2-194">Por exemplo, se você tiver um usuário no pool01.contoso.net, mas entrar no Skype for Business como bob@contoso.com, crie uma zona DNS interna chamada contoso.com e, dentro dela, você precisará criar um registro DNS A (e AAAA se endereçamento IPv6 estiver sendo usado) para pool01.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="af5e2-194">For example, if you have a user homed on pool01.contoso.net, but signs into Skype for Business as bob@contoso.com, create an internal DNS zone called contoso.com, and inside it you need to create a DNS A (and AAAA if IPv6 addressing's being used) record for pool01.contoso.com.</span></span>
    
- <span data-ttu-id="af5e2-195">**Zona interna exata**</span><span class="sxs-lookup"><span data-stu-id="af5e2-195">**Pin-point internal zone**</span></span>
    
    <span data-ttu-id="af5e2-196">Se a criação de uma zona inteira no DNS interno não for uma opção para você, você poderá criar zonas de ponto de pino (dedicadas) que correspondam aos registros SRV necessários para a configuração automática e popular essas zonas usando dnscmd.exe.</span><span class="sxs-lookup"><span data-stu-id="af5e2-196">If creating an entire zone in your internal DNS isn't an option for you, you can create pin-point (dedicated) zones that correspond to the SRV records required for automatic configuration, and populate those zones using dnscmd.exe.</span></span> <span data-ttu-id="af5e2-197">Dnscmd.exe é necessário porque a interface do usuário DNS não suportará a criação de zonas de ponto de pino.</span><span class="sxs-lookup"><span data-stu-id="af5e2-197">Dnscmd.exe is required because the DNS user interface won't support the creation of pin-point zones.</span></span>
    
    <span data-ttu-id="af5e2-198">Por exemplo, se seu domínio SIP for contoso.com e você tiver um pool de Front-End chamado pool01 que contenha dois Servidores Front-End, você precisará das seguintes zonas de ponto de pino e registros A no DNS interno:</span><span class="sxs-lookup"><span data-stu-id="af5e2-198">For example, if your SIP domain is contoso.com, and you have a Front End pool called pool01 that contains two Front End Servers, you'll need the following pin-point zones and A records in your internal DNS:</span></span>
    
  ```console
  dnscmd . /zoneadd _sipinternaltls._tcp.contoso.com. /dsprimary
  dnscmd . /recordadd _sipinternaltls._tcp.contoso.com. @ SRV 0 0 5061 pool01.contoso.com.
  dnscmd . /zoneadd pool01.contoso.com. /dsprimary
  dnscmd . /recordadd pool01.contoso.com. @ A 192.168.10.90
  dnscmd . /recordadd pool01.contoso.com. @ AAAA <IPv6 address>
  dnscmd . /recordadd pool01.contoso.com. @ A 192.168.10.91 
  dnscmd . /recordadd pool01.contoso.com. @ AAAA <IPv6 address>
  ```

    <span data-ttu-id="af5e2-199">Você pode ter um segundo domínio SIP em seu ambiente.</span><span class="sxs-lookup"><span data-stu-id="af5e2-199">You may have a second SIP domain in your environment.</span></span> <span data-ttu-id="af5e2-200">Nesse caso, você precisará das seguintes zonas pin-point e registros A em seu DNS interno:</span><span class="sxs-lookup"><span data-stu-id="af5e2-200">In that case, you'll need the following pin-point zones and A records in your internal DNS:</span></span>
    
  ```console
  dnscmd . /zoneadd _sipinternaltls._tcp.fabrikam.com. /dsprimary
  dnscmd . /recordadd _sipinternaltls._tcp.fabrikam.com. @ SRV 0 0 5061 pool01.fabrikam.com.
  dnscmd . /zoneadd pool01.fabrikam.com. /dsprimary
  dnscmd . /recordadd pool01.fabrikam.com. @ A 192.168.10.90
  dnscmd . /recordadd pool01.contoso.com. @ AAAA <IPv6 address>
  dnscmd . /recordadd pool01.fabrikam.com. @ A 192.168.10.91
  dnscmd . /recordadd pool01.contoso.com. @ AAAA <IPv6 address>
  ```

> [!NOTE]
> <span data-ttu-id="af5e2-201">Você verá que o FQDN do pool de Front-End aparece duas vezes, mas com dois endereços IP diferentes.</span><span class="sxs-lookup"><span data-stu-id="af5e2-201">You'll see the Front End pool FQDN appears twice, but with two different IP addresses.</span></span> <span data-ttu-id="af5e2-202">Isso porque o balanceamento de carga DNS é usado.</span><span class="sxs-lookup"><span data-stu-id="af5e2-202">That's because DNS load balancing is used.</span></span> <span data-ttu-id="af5e2-203">Se o HLB for usado, haverá apenas uma única entrada de pool de Front-End.</span><span class="sxs-lookup"><span data-stu-id="af5e2-203">If HLB is used, there'd only be a single Front End pool entry.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="af5e2-204">Além disso, os valores FQDN do pool de Front End mudam entre os exemplos contoso.com e fabrikam.com, mas os endereços IP permanecem os mesmos.</span><span class="sxs-lookup"><span data-stu-id="af5e2-204">Also, the Front End pool FQDN values change between the contoso.com and fabrikam.com examples, but the IP addresses remain the same.</span></span> <span data-ttu-id="af5e2-205">Isso porque os usuários que estão fazendo o uso de qualquer domínio SIP usarão o mesmo pool de Front-End para configuração automática.</span><span class="sxs-lookup"><span data-stu-id="af5e2-205">That's because users who're signing in from either SIP domain will be using the same Front End pool for automatic configuration.</span></span> 
  
## <a name="dns-disaster-recovery"></a><span data-ttu-id="af5e2-206">Recuperação de desastre de DNS</span><span class="sxs-lookup"><span data-stu-id="af5e2-206">DNS disaster recovery</span></span>
<span data-ttu-id="af5e2-207"><a name="DNSDR"> </a></span><span class="sxs-lookup"><span data-stu-id="af5e2-207"><a name="DNSDR"> </a></span></span>

<span data-ttu-id="af5e2-208">Para configurar o DNS para redirecionar o tráfego Web do Skype for Business Server para os sites de recuperação de desastres (DR) e failover, você precisa usar um provedor DNS que suporte GeoDNS.</span><span class="sxs-lookup"><span data-stu-id="af5e2-208">To configure DNS to redirect Skype for Business Server web traffic to your disaster recover (DR) and failover sites, you need to use a DNS provider that supports GeoDNS.</span></span> <span data-ttu-id="af5e2-209">Você pode configurar seus registros DNS para dar suporte à recuperação de desastre, para que os recursos que usam serviços Web continuem mesmo se um pool de Front End inteiro ficar inonte.</span><span class="sxs-lookup"><span data-stu-id="af5e2-209">You can set up your DNS records to support disaster recover, so that features that use web services continue even if one entire Front End pool goes down.</span></span> <span data-ttu-id="af5e2-210">Esse recurso dr dá suporte a URLs simples de Descoberta Automática, Reunião e Discagem.</span><span class="sxs-lookup"><span data-stu-id="af5e2-210">This DR feature supports the Autodiscover, Meet and Dial-in simple URLs.</span></span>
  
<span data-ttu-id="af5e2-211">Defina e configure registros A (AAAA) de host DNS adicionais se estiver usando IPv6 para resolução interna e externa de serviços Web em seu provedor GeoDNS.</span><span class="sxs-lookup"><span data-stu-id="af5e2-211">You define and configure additional DNS host A (AAAA if using IPv6) records for internal and external resolution of web services at your GeoDNS provider.</span></span> <span data-ttu-id="af5e2-212">Os detalhes a seguir pressupom pools emparelhados, geograficamente dispersos, e que o GeoDNS suportado por seu provedor tem **DNS** round robin ou está configurado para usar Pool1 como primário e faz o fails over para Pool2 em caso de perda de comunicações ou falha de energia. </span><span class="sxs-lookup"><span data-stu-id="af5e2-212">The following details assume paired pools, geographically dispersed, and that the GeoDNS supported by your provider **either** has round-robin DNS **or** is configured to use Pool1 as primary and fails over to Pool2 in the event of any communications loss or power failure.</span></span>
  
<span data-ttu-id="af5e2-213">Todos os registros DNS nesta tabela são exemplos.</span><span class="sxs-lookup"><span data-stu-id="af5e2-213">All the DNS records in this table are examples.</span></span>
  
|<span data-ttu-id="af5e2-214">**Registro GeoDNS**</span><span class="sxs-lookup"><span data-stu-id="af5e2-214">**GeoDNS record**</span></span>|<span data-ttu-id="af5e2-215">**Registros de pool**</span><span class="sxs-lookup"><span data-stu-id="af5e2-215">**Pool records**</span></span>|<span data-ttu-id="af5e2-216">**Registros CNAME**</span><span class="sxs-lookup"><span data-stu-id="af5e2-216">**CNAME records**</span></span>|<span data-ttu-id="af5e2-217">**Configurações de DNS (selecione uma opção)**</span><span class="sxs-lookup"><span data-stu-id="af5e2-217">**DNS settings (select one option)**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="af5e2-218">Meet-int.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-218">Meet-int.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-219">Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-219">Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-220">Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-220">Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-221">Meet.contoso.com alias para Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-221">Meet.contoso.com alias to Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-222">Meet.contoso.com alias a ser Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-222">Meet.contoso.com alias to Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-223">Round Robin entre pools</span><span class="sxs-lookup"><span data-stu-id="af5e2-223">Round Robin between pools</span></span>  <br/> <span data-ttu-id="af5e2-224">**OU**</span><span class="sxs-lookup"><span data-stu-id="af5e2-224">**OR**</span></span> <br/> <span data-ttu-id="af5e2-225">Use primary, connect to secondary if there's a failure</span><span class="sxs-lookup"><span data-stu-id="af5e2-225">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="af5e2-226">Meet-ext.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-226">Meet-ext.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-227">Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-227">Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-228">Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-228">Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-229">Meet.contoso.com alias para Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-229">Meet.contoso.com alias to Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-230">Meet.contoso.com alias para Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-230">Meet.contoso.com alias to Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-231">Round Robin entre pools</span><span class="sxs-lookup"><span data-stu-id="af5e2-231">Round Robin between pools</span></span>  <br/> <span data-ttu-id="af5e2-232">**OU**</span><span class="sxs-lookup"><span data-stu-id="af5e2-232">**OR**</span></span> <br/> <span data-ttu-id="af5e2-233">Use primary, connect to secondary if there's a failure</span><span class="sxs-lookup"><span data-stu-id="af5e2-233">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="af5e2-234">Dialin-int.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-234">Dialin-int.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-235">Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-235">Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-236">Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-236">Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-237">Dialin.contoso.com alias para Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-237">Dialin.contoso.com alias to Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-238">Dialin.contoso.com alias para Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-238">Dialin.contoso.com alias to Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-239">Round Robin entre pools</span><span class="sxs-lookup"><span data-stu-id="af5e2-239">Round Robin between pools</span></span>  <br/> <span data-ttu-id="af5e2-240">**OU**</span><span class="sxs-lookup"><span data-stu-id="af5e2-240">**OR**</span></span> <br/> <span data-ttu-id="af5e2-241">Use primary, connect to secondary if there's a failure</span><span class="sxs-lookup"><span data-stu-id="af5e2-241">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="af5e2-242">Dialin-ext.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-242">Dialin-ext.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-243">Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-243">Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-244">Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-244">Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-245">Dialin.contoso.com alias para Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-245">Dialin.contoso.com alias to Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-246">Dialin.contoso.com alias para Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-246">Dialin.contoso.com alias to Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-247">Round Robin entre pools</span><span class="sxs-lookup"><span data-stu-id="af5e2-247">Round Robin between pools</span></span>  <br/> <span data-ttu-id="af5e2-248">**OU**</span><span class="sxs-lookup"><span data-stu-id="af5e2-248">**OR**</span></span> <br/> <span data-ttu-id="af5e2-249">Use primary, connect to secondary if there's a failure</span><span class="sxs-lookup"><span data-stu-id="af5e2-249">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="af5e2-250">Lyncdiscoverint-int.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-250">Lyncdiscoverint-int.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-251">Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-251">Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-252">Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-252">Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-253">Lyncdiscoverinternal.contoso.com alias para Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-253">Lyncdiscoverinternal.contoso.com alias to Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-254">Lyncdiscoverinternal.contoso.com alias para Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-254">Lyncdiscoverinternal.contoso.com alias to Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-255">Round Robin entre pools</span><span class="sxs-lookup"><span data-stu-id="af5e2-255">Round Robin between pools</span></span>  <br/> <span data-ttu-id="af5e2-256">**OU**</span><span class="sxs-lookup"><span data-stu-id="af5e2-256">**OR**</span></span> <br/> <span data-ttu-id="af5e2-257">Use primary, connect to secondary if there's a failure</span><span class="sxs-lookup"><span data-stu-id="af5e2-257">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="af5e2-258">Lyncdiscover-ext.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-258">Lyncdiscover-ext.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-259">Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-259">Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-260">Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-260">Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-261">Lyncdiscover.contoso.com alias para Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-261">Lyncdiscover.contoso.com alias to Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-262">Lyncdiscover.contoso.com alias para Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-262">Lyncdiscover.contoso.com alias to Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-263">Round Robin entre pools</span><span class="sxs-lookup"><span data-stu-id="af5e2-263">Round Robin between pools</span></span>  <br/> <span data-ttu-id="af5e2-264">**OU**</span><span class="sxs-lookup"><span data-stu-id="af5e2-264">**OR**</span></span> <br/> <span data-ttu-id="af5e2-265">Use primary, connect to secondary if there's a failure</span><span class="sxs-lookup"><span data-stu-id="af5e2-265">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="af5e2-266">Scheduler-int.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-266">Scheduler-int.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-267">Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-267">Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-268">Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-268">Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-269">Scheduler.contoso.com alias para Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-269">Scheduler.contoso.com alias to Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-270">Scheduler.contoso.com alias para Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-270">Scheduler.contoso.com alias to Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-271">Round Robin entre pools</span><span class="sxs-lookup"><span data-stu-id="af5e2-271">Round Robin between pools</span></span>  <br/> <span data-ttu-id="af5e2-272">**OU**</span><span class="sxs-lookup"><span data-stu-id="af5e2-272">**OR**</span></span> <br/> <span data-ttu-id="af5e2-273">Use primary, connect to secondary if there's a failure</span><span class="sxs-lookup"><span data-stu-id="af5e2-273">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="af5e2-274">Scheduler-ext.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-274">Scheduler-ext.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-275">Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-275">Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-276">Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-276">Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-277">Scheduler.contoso.com alias para Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-277">Scheduler.contoso.com alias to Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="af5e2-278">Scheduler.contoso.com alias para Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-278">Scheduler.contoso.com alias to Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-279">Round Robin entre pools</span><span class="sxs-lookup"><span data-stu-id="af5e2-279">Round Robin between pools</span></span>  <br/> <span data-ttu-id="af5e2-280">**OU**</span><span class="sxs-lookup"><span data-stu-id="af5e2-280">**OR**</span></span> <br/> <span data-ttu-id="af5e2-281">Use primary, connect to secondary if there's a failure</span><span class="sxs-lookup"><span data-stu-id="af5e2-281">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
   
## <a name="dns-load-balancing"></a><span data-ttu-id="af5e2-282">Balanceamento de carga DNS</span><span class="sxs-lookup"><span data-stu-id="af5e2-282">DNS load balancing</span></span>
<span data-ttu-id="af5e2-283"><a name="DNSLB"> </a></span><span class="sxs-lookup"><span data-stu-id="af5e2-283"><a name="DNSLB"> </a></span></span>

<span data-ttu-id="af5e2-284">O balanceamento de carga DNS geralmente é implementado no nível do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="af5e2-284">DNS load balancing is usually implemented at the application level.</span></span> <span data-ttu-id="af5e2-285">O aplicativo (por exemplo, um cliente executando o Skype for Business) tenta se conectar a um servidor em um pool conectando-se a um dos endereços IP retornados da consulta de registro DNS A e AAAA (se o endereçamento IPv6 for usado) para o FQDN do pool.</span><span class="sxs-lookup"><span data-stu-id="af5e2-285">The application (for example, a client running Skype for Business), tries to connect to a server in a pool by connecting to one of the IP addresses returned from the DNS A and AAAA (if IPv6 addressing is used) record query for the pool FQDN.</span></span>
  
<span data-ttu-id="af5e2-286">Por exemplo, se houver três Servidores front-end em um pool chamado pool01.contoso.com, ocorrerá o seguinte:</span><span class="sxs-lookup"><span data-stu-id="af5e2-286">For example, if there are three Front End Servers in a pool named pool01.contoso.com, the following would happen:</span></span>
  
- <span data-ttu-id="af5e2-287">Clientes executando o DNS de consulta do Skype for Business pool01.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="af5e2-287">Clients running Skype for Business query DNS for pool01.contoso.com.</span></span> <span data-ttu-id="af5e2-288">A consulta retorna três endereços IP e os armazena em cache da seguinte forma (em alguma ordem):</span><span class="sxs-lookup"><span data-stu-id="af5e2-288">The query returns three IP addresses and caches them as follows (in some order):</span></span>
    
   |||
   |:-----|:-----|
   |<span data-ttu-id="af5e2-289">pool01.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-289">pool01.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-290">192.168.10.90</span><span class="sxs-lookup"><span data-stu-id="af5e2-290">192.168.10.90</span></span>  <br/> |
   |<span data-ttu-id="af5e2-291">pool01.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-291">pool01.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-292">192.168.10.91</span><span class="sxs-lookup"><span data-stu-id="af5e2-292">192.168.10.91</span></span>  <br/> |
   |<span data-ttu-id="af5e2-293">pool01.contoso.com</span><span class="sxs-lookup"><span data-stu-id="af5e2-293">pool01.contoso.com</span></span>  <br/> |<span data-ttu-id="af5e2-294">192.168.10.92</span><span class="sxs-lookup"><span data-stu-id="af5e2-294">192.168.10.92</span></span>  <br/> |
   
- <span data-ttu-id="af5e2-295">O cliente tenta estabelecer uma conexão TCP com um dos endereços IP.</span><span class="sxs-lookup"><span data-stu-id="af5e2-295">The client tries to establish a TCP connection to one of the IP addresses.</span></span> <span data-ttu-id="af5e2-296">Se isso falhar, ele tentará o próximo endereço IP armazenado em cache dessa lista.</span><span class="sxs-lookup"><span data-stu-id="af5e2-296">If that fails, it'll try the next IP address it's cached from that list.</span></span>
    
- <span data-ttu-id="af5e2-297">Se a conexão TCP for bem-sucedida, o cliente negocia o TLS para se conectar ao registrador principal no pool01.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="af5e2-297">If the TCP connection succeeds, the client negotiates TLS to connect to the primary registrar on pool01.contoso.com.</span></span>
    
- <span data-ttu-id="af5e2-298">Se o cliente tentar todas as entradas em cache sem uma conexão bem-sucedida, o usuário receberá uma notificação de que nenhum servidor que executa o Skype for Business Server está disponível no momento.</span><span class="sxs-lookup"><span data-stu-id="af5e2-298">If the client tries all cached entries without a successful connection, the user receives a notification that no servers running Skype for Business Server are available at the moment.</span></span>
    
> [!NOTE]
> <span data-ttu-id="af5e2-299">O balanceamento de carga baseado em DNS é diferente do round robin de DNS (DNS RR), que normalmente se refere ao balanceamento de carga, confiando no DNS para dar uma ordem diferente de endereços IP para os servidores em seu pool.</span><span class="sxs-lookup"><span data-stu-id="af5e2-299">DNS-based load balancing is different from DNS round robin (DNS RR), which typically refers to load balancing by relying on DNS to give a different order of IP addresses for the servers in your pool.</span></span> <span data-ttu-id="af5e2-300">Normalmente, o DNS RR habilita a distribuição de carga, mas não permite que você habilita o failover.</span><span class="sxs-lookup"><span data-stu-id="af5e2-300">Typically, DNS RR enables load distribution, but it won't allow you to enable failover.</span></span> <span data-ttu-id="af5e2-301">Por exemplo, se a conexão com um endereço IP retornado pela consulta DNS A (ou AAAA em um cenário IPv6) falhar, essa conexão falhará.</span><span class="sxs-lookup"><span data-stu-id="af5e2-301">For example, if the connection to the one IP address returned by your DNS A (or AAAA in an IPv6 scenario) query fails, that connection will fail.</span></span> <span data-ttu-id="af5e2-302">Isso torna o DNS RR menos confiável do que o balanceamento de carga baseado em DNS.</span><span class="sxs-lookup"><span data-stu-id="af5e2-302">That makes DNS RR less reliable than DNS-based load balancing.</span></span> <span data-ttu-id="af5e2-303">Você ainda pode usar o DNS RR em conjunto com o balanceamento de carga baseado em DNS, se precisar fazer isso.</span><span class="sxs-lookup"><span data-stu-id="af5e2-303">You can still use DNS RR in conjunction with DNS-based load balancing if you need to do that.</span></span> 
  
<span data-ttu-id="af5e2-304">Use o balanceamento de carga DNS para:</span><span class="sxs-lookup"><span data-stu-id="af5e2-304">You use DNS load balancing to:</span></span>
  
- <span data-ttu-id="af5e2-305">Balancear a carga SIP de servidor para servidor para os Servidores de Borda.</span><span class="sxs-lookup"><span data-stu-id="af5e2-305">Load balance server-to-server SIP to the Edge Servers.</span></span>
    
- <span data-ttu-id="af5e2-306">Balanceamento de carga de aplicativos do Unified Communication Application Services (UCAS), como o Atendente Automático de Conferência, o Grupo de Resposta e o Estacionamento de Chamada.</span><span class="sxs-lookup"><span data-stu-id="af5e2-306">Load balance Unified Communication Application Services (UCAS) applications, such as Conferencing Auto Attendant, Response Group, and Call Park.</span></span>
    
- <span data-ttu-id="af5e2-307">Impedir novas conexões com aplicativos UCAS (também conhecidos como esvaziamento).</span><span class="sxs-lookup"><span data-stu-id="af5e2-307">Prevent new connections to UCAS applications (also known as draining).</span></span>
    
- <span data-ttu-id="af5e2-308">Balanceamento de carga de todo o tráfego de cliente para servidor entre clientes e Servidores de Borda.</span><span class="sxs-lookup"><span data-stu-id="af5e2-308">Load balance all client-to-server traffic between clients and Edge Servers.</span></span>
    
<span data-ttu-id="af5e2-309">Não é possível usar o balanceamento de carga DNS para:</span><span class="sxs-lookup"><span data-stu-id="af5e2-309">You can't use DNS load balancing for:</span></span>
  
- <span data-ttu-id="af5e2-310">Tráfego da Web de cliente para servidor para seus Servidores Front-End ou um Diretor.</span><span class="sxs-lookup"><span data-stu-id="af5e2-310">Client-to-server web traffic to your Front End Servers or a Director.</span></span>
    
<span data-ttu-id="af5e2-311">Para aprofundar um pouco mais sobre como um registro SRV dns é selecionado quando registros DNS mutiple são retornados por uma consulta, o serviço de Borda de Acesso sempre seleciona o registro com a prioridade numérica mais baixa e, se um desempate for necessário, o maior peso numérico.</span><span class="sxs-lookup"><span data-stu-id="af5e2-311">To go a little more in-depth on how a DNS SRV record's selected when mutiple DNS records are returned by a query, the Access Edge service always picks the record with the lowest numeric priority and, if a tie-breaker is needed, the highest numeric weight.</span></span> <span data-ttu-id="af5e2-312">Isso é consistente com a [documentação da Internet Engineering Task Force.](https://www.ietf.org/rfc/rfc2782.txt)</span><span class="sxs-lookup"><span data-stu-id="af5e2-312">This is consistent with [Internet Engineering Task Force documentation](https://www.ietf.org/rfc/rfc2782.txt).</span></span>
  
<span data-ttu-id="af5e2-313">Portanto, por exemplo, se seu primeiro registro SRV dns tiver um peso 20 e uma prioridade de 40, e seu segundo registro SRV DNS tiver um peso 10 e uma prioridade de 50, o primeiro registro será escolhido porque tem a prioridade mais baixa de 40.</span><span class="sxs-lookup"><span data-stu-id="af5e2-313">So, for example, if your first DNS SRV record has a weight of 20 and a priority of 40, and your second DNS SRV record has a weight of 10 and a priority of 50, the first record's going to be chosen because it has the lower priority of 40.</span></span> <span data-ttu-id="af5e2-314">A prioridade sempre vai primeiro, e esse é o host que um cliente direcionará primeiro.</span><span class="sxs-lookup"><span data-stu-id="af5e2-314">Priority always goes first, and that's the host that a client will target first.</span></span> <span data-ttu-id="af5e2-315">E se houver dois destinos com a mesma prioridade?</span><span class="sxs-lookup"><span data-stu-id="af5e2-315">What if there are two targets with the same priority?</span></span> 
  
<span data-ttu-id="af5e2-316">Nesse caso, o peso é considerado.</span><span class="sxs-lookup"><span data-stu-id="af5e2-316">In that case, weight comes into consideration.</span></span> <span data-ttu-id="af5e2-317">Pesos maiores devem receber uma alta probabilidade, nessa circunstância, de serem selecionados.</span><span class="sxs-lookup"><span data-stu-id="af5e2-317">Larger weights should be given a high probability, in this circumstance, of being selected.</span></span> <span data-ttu-id="af5e2-318">Os administradores de DNS devem usar o peso 0 quando não houver seleção de servidor para fazer.</span><span class="sxs-lookup"><span data-stu-id="af5e2-318">DNS administrators should use weight 0 when there isn't any server selection to do.</span></span> <span data-ttu-id="af5e2-319">Na presença de registros com pesos maiores do que 0, os registros com peso 0 têm uma chance muito pequena de trazer selecionados.</span><span class="sxs-lookup"><span data-stu-id="af5e2-319">In the presence of records containing weights greater than 0, records with weight 0 have a very small chance of bring selected.</span></span>
  
<span data-ttu-id="af5e2-320">Então, o que acontece se vários registros SRV dns com prioridade e peso iguais como retornados?</span><span class="sxs-lookup"><span data-stu-id="af5e2-320">So, then, what happens if multiple DNS SRV records with equal priority and weight as returned?</span></span> <span data-ttu-id="af5e2-321">Nessa situação, o serviço de Borda de Acesso escolherá primeiro o registro SRV que recebeu do servidor DNS.</span><span class="sxs-lookup"><span data-stu-id="af5e2-321">In this situation the Access Edge service will choose the SRV record that it got from the DNS server first.</span></span>
  

