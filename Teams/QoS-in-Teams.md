---
title: Implementar Qualidade de Serviço no Microsoft Teams
author: SerdarSoysal
ms.author: serdars
manager: Serdars
ms.topic: article
ms.service: msteams
ms.reviewer: vkorlep, siunies
audience: admin
description: Saiba como preparar a rede da sua organização para a qualidade do serviço (QoS) no Microsoft Teams.
localization_priority: Normal
search.appverid: MET150
f1.keywords:
- CSH
ms.custom:
- ms.teamsadmincenter.meetingsettings.qos
- ms.teamsadmincenter.meetingsettings.network.qosmarkers
- seo-marvel-apr2020
ms.collection:
- M365-collaboration
appliesto:
- Microsoft Teams
ms.openlocfilehash: 6a83a18810268d3eb8317eb541f7eb06ff812c9c
ms.sourcegitcommit: 43d66693f6f08d4dcade0095bf613240031fec56
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/06/2020
ms.locfileid: "46582088"
---
# <a name="implement-quality-of-service-qos-in-microsoft-teams"></a><span data-ttu-id="2dc6b-103">Implementar a QoS (qualidade de serviço) no Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="2dc6b-103">Implement Quality of Service (QoS) in Microsoft Teams</span></span>

<span data-ttu-id="2dc6b-104">A QoS (qualidade de serviço) no Microsoft Teams é uma maneira de permitir o tráfego de rede em tempo real que é sensível a atrasos na rede (por exemplo, fluxos de voz ou vídeo) para "recortar na linha" na frente do tráfego que é menos confidencial (como baixar um novo aplicativo, onde um segundo adicional para baixar não é um negócio importante).</span><span class="sxs-lookup"><span data-stu-id="2dc6b-104">Quality of Service (QoS) in Microsoft Teams is a way to allow real-time network traffic that is sensitive to network delays (for example, voice or video streams) to "cut in line" in front of traffic that is less sensitive (like downloading a new app, where an extra second to download isn't a big deal).</span></span> <span data-ttu-id="2dc6b-105">A QoS identifica e marca todos os pacotes em fluxos em tempo real (usando objetos de política de grupo do Windows e um recurso de roteamento chamado de listas de controle de acesso baseado em portas, mais sobre os que estão abaixo) que, em seguida, ajudam sua rede a fornecer voz, vídeo e compartilhamento de tela transmite fluxos de largura de banda de rede.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-105">QoS identifies and marks all packets in real-time streams (using Windows Group Policy Objects and a routing feature called Port-based Access Control Lists, more about those is below) which then helps your network to give voice, video, and screen share streams a dedicated portion of network bandwidth.</span></span>

<span data-ttu-id="2dc6b-106">Se você estiver oferecendo suporte a um grande grupo de usuários e ele estiver enfrentando algum dos problemas descritos abaixo, é provável que você precise implementar QoS.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-106">If you're supporting a large group of users and they're experiencing any of the problems described below, you probably need to implement QoS.</span></span> <span data-ttu-id="2dc6b-107">Uma pequena empresa com poucos usuários pode não precisar de QoS, mas até lá deve ser útil.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-107">A small business with few users may not need QoS, but even there it should be helpful.</span></span>

<span data-ttu-id="2dc6b-108">Sem alguma forma de QoS, você pode ver os seguintes problemas de qualidade em voz e vídeo:</span><span class="sxs-lookup"><span data-stu-id="2dc6b-108">Without some form of QoS, you might see the following quality issues in voice and video:</span></span>

- <span data-ttu-id="2dc6b-109">Tremulação – pacotes de mídia chegando a tarifas diferentes, o que pode resultar em palavras ausentes ou sílabas nas chamadas</span><span class="sxs-lookup"><span data-stu-id="2dc6b-109">Jitter – media packets arriving at different rates, which can result in missing words or syllables in calls</span></span>
- <span data-ttu-id="2dc6b-110">Perda de pacotes – pacotes descartados, que também podem resultar em baixa qualidade de voz e dificuldade para entender a fala</span><span class="sxs-lookup"><span data-stu-id="2dc6b-110">Packet loss – packets dropped, which can also result in lower voice quality and hard to understand speech</span></span>
- <span data-ttu-id="2dc6b-111">Tempo de resposta (RTT) atrasado – pacotes de mídia demorando muito tempo para alcançar seus destinos, o que resulta em atrasos perceptíveis entre duas partes em uma conversa, fazendo com que as pessoas conversem umas sobre as outras</span><span class="sxs-lookup"><span data-stu-id="2dc6b-111">Delayed round trip time (RTT) – media packets taking a long time to reach their destinations, which results in noticeable delays between two parties in a conversation, causing people to talk over each other</span></span>

<span data-ttu-id="2dc6b-112">A maneira menos complexa de solucionar esses problemas é aumentar o tamanho das conexões de dados, interna e externamente à Internet.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-112">The least complex way to address these issues is to increase the size of the data connections, both internally and out to the internet.</span></span> <span data-ttu-id="2dc6b-113">Como isso é sempre caro, a QoS oferece uma maneira de gerenciar com mais eficiência os recursos que você tem em vez de adicionar largura de banda.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-113">Since that is often cost-prohibitive, QoS provides a way to more effectively manage the resources you have instead of adding bandwidth.</span></span> <span data-ttu-id="2dc6b-114">Para solucionar problemas de qualidade, recomendamos que você use a QoS pela primeira vez e, em seguida, adicione largura de banda somente quando necessário.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-114">To address quality issues, we recommend that you first use QoS, then add bandwidth only where necessary.</span></span>

<span data-ttu-id="2dc6b-115">Para que a QoS seja eficiente, você aplicará as configurações de QoS consistentes em toda a sua organização, porque qualquer parte do caminho que não dê suporte a suas prioridades de QoS poderá diminuir a qualidade das chamadas, vídeo e compartilhamento de tela.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-115">For QoS to be effective, you'll apply consistent QoS settings throughout your organization, because any part of the path that fails to support your QoS priorities can degrade the quality of calls, video, and screen sharing.</span></span> <span data-ttu-id="2dc6b-116">Isso inclui a aplicação de configurações a todos os computadores ou dispositivos de usuário, switches de rede, roteadores para a Internet e o serviço Teams.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-116">This includes applying settings to all user PCs or devices, network switches, routers to the internet, and the Teams service.</span></span>

<span data-ttu-id="2dc6b-117">_Figura 1. A relação entre as redes da organização e os serviços do Microsoft 365 ou do Office 365_</span><span class="sxs-lookup"><span data-stu-id="2dc6b-117">_Figure 1. The relationship between an organization's networks and Microsoft 365 or Office 365 services_</span></span>

<span data-ttu-id="2dc6b-118">![Ilustração da relação entre redes e serviços](media/Qos-in-Teams-Image1.png "A relação entre as redes da organização e os serviços do Microsoft 365 ou do Office 365: rede local e dispositivos se conectam a uma rede Interconnect, que, por sua vez, se conecta com o Microsoft 365 ou o Office 365 Cloud Voice and audio Conferencing Services.")</span><span class="sxs-lookup"><span data-stu-id="2dc6b-118">![Illustration of the relationship between networks and services](media/Qos-in-Teams-Image1.png "The relationship between an organization's networks and Microsoft 365 or Office 365 services: on-premises network and devices connect with an interconnect network, which in turn connects with Microsoft 365 or Office 365 Cloud Voice and Audio Conferencing services.")</span></span>

## <a name="qos-implementation-checklist"></a><span data-ttu-id="2dc6b-119">Lista de verificação de implementação de QoS</span><span class="sxs-lookup"><span data-stu-id="2dc6b-119">QoS implementation checklist</span></span>

<span data-ttu-id="2dc6b-120">Em um nível alto, faça o seguinte para implementar QoS:</span><span class="sxs-lookup"><span data-stu-id="2dc6b-120">At a high level, do the following to implement QoS:</span></span>

1. [<span data-ttu-id="2dc6b-121">Verifique se a sua rede está pronta</span><span class="sxs-lookup"><span data-stu-id="2dc6b-121">Make sure your network is ready</span></span>](#make-sure-your-network-is-ready)

1. [<span data-ttu-id="2dc6b-122">Selecionar um método de implementação de QoS</span><span class="sxs-lookup"><span data-stu-id="2dc6b-122">Select a QoS implementation method</span></span>](#select-a-qos-implementation-method)

1. [<span data-ttu-id="2dc6b-123">Escolher intervalos de porta iniciais para cada tipo de mídia</span><span class="sxs-lookup"><span data-stu-id="2dc6b-123">Choose initial port ranges for each media type</span></span>](#choose-initial-port-ranges-for-each-media-type)

1. <span data-ttu-id="2dc6b-124">Implementar as configurações de QoS:</span><span class="sxs-lookup"><span data-stu-id="2dc6b-124">Implement QoS settings:</span></span>
   1. <span data-ttu-id="2dc6b-125">Em clientes que usam um GPO para [definir intervalos e marcas de porta do dispositivo cliente](QoS-in-Teams-clients.md)</span><span class="sxs-lookup"><span data-stu-id="2dc6b-125">On clients using a GPO to [set client device port ranges and markings](QoS-in-Teams-clients.md)</span></span>
   2. <span data-ttu-id="2dc6b-126">Em roteadores (consulte a documentação do fabricante) ou outros dispositivos de rede.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-126">On routers (see the manufacturer documentation) or other network devices.</span></span> <span data-ttu-id="2dc6b-127">Isso pode incluir ACLs baseadas em porta ou simplesmente definir as filas de QoS e as marcações de DSCP, ou todas elas.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-127">This may include port-based ACLs or simply defining the QoS queues and DSCP markings, or all of these.</span></span>

      > [!IMPORTANT]
      > <span data-ttu-id="2dc6b-128">Recomendamos implementar essas políticas de QoS usando as portas de origem do cliente e um endereço IP de origem e de destino de "any".</span><span class="sxs-lookup"><span data-stu-id="2dc6b-128">We recommend implementing these QoS policies using the client source ports and a source and destination IP address of “any.”</span></span> <span data-ttu-id="2dc6b-129">Isso irá capturar o tráfego de mídia de entrada e saída na rede interna.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-129">This will catch both incoming and outgoing media traffic on the internal network.</span></span>  

   3. [<span data-ttu-id="2dc6b-130">Defina como você deseja manipular o tráfego de mídia para reuniões de equipes</span><span class="sxs-lookup"><span data-stu-id="2dc6b-130">Set how you want to handle media traffic for Teams meetings</span></span>](meeting-settings-in-teams.md#set-how-you-want-to-handle-real-time-media-traffic-for-teams-meetings)

5. <span data-ttu-id="2dc6b-131">[Valide a implementação de QoS](#validate-your-qos-implementation) analisando o tráfego da equipe na rede.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-131">[Validate your QoS implementation](#validate-your-qos-implementation) by analyzing Teams traffic on the network.</span></span>

<span data-ttu-id="2dc6b-132">Ao se preparar para implementar a QoS, tenha em mente as seguintes diretrizes:</span><span class="sxs-lookup"><span data-stu-id="2dc6b-132">As you prepare to implement QoS, keep the following guidelines in mind:</span></span>

- <span data-ttu-id="2dc6b-133">O caminho mais curto para o Microsoft 365 é melhor</span><span class="sxs-lookup"><span data-stu-id="2dc6b-133">The shortest path to Microsoft 365 is best</span></span>
- <span data-ttu-id="2dc6b-134">As portas de fechamento só levarão à degradação de qualidade</span><span class="sxs-lookup"><span data-stu-id="2dc6b-134">Closing ports will only lead to quality degradation</span></span>
- <span data-ttu-id="2dc6b-135">Qualquer obstáculos entre, como proxies, não é recomendado</span><span class="sxs-lookup"><span data-stu-id="2dc6b-135">Any obstacles in between, such as proxies, aren't recommended</span></span>
- <span data-ttu-id="2dc6b-136">Limite o número de saltos:</span><span class="sxs-lookup"><span data-stu-id="2dc6b-136">Limit the number of hops:</span></span>
  - <span data-ttu-id="2dc6b-137">Borda de cliente para rede – 3 a 5 saltos</span><span class="sxs-lookup"><span data-stu-id="2dc6b-137">Client to network edge – 3 to 5 hops</span></span>
  - <span data-ttu-id="2dc6b-138">ISP para borda de rede da Microsoft – 3 saltos</span><span class="sxs-lookup"><span data-stu-id="2dc6b-138">ISP to Microsoft network edge – 3 hops</span></span>
  - <span data-ttu-id="2dc6b-139">Borda de rede da Microsoft para destino final – irrelevante</span><span class="sxs-lookup"><span data-stu-id="2dc6b-139">Microsoft network edge to final destination – irrelevant</span></span>

<span data-ttu-id="2dc6b-140">Para obter informações sobre como configurar portas de firewall, vá para [URLs e intervalos de IP do Office 365](office-365-urls-ip-address-ranges.md).</span><span class="sxs-lookup"><span data-stu-id="2dc6b-140">For information about configuring firewall ports, go to [Office 365 URLs and IP ranges](office-365-urls-ip-address-ranges.md).</span></span>


## <a name="make-sure-your-network-is-ready"></a><span data-ttu-id="2dc6b-141">Verifique se a sua rede está pronta</span><span class="sxs-lookup"><span data-stu-id="2dc6b-141">Make sure your network is ready</span></span>

<span data-ttu-id="2dc6b-142">Se estiver considerando uma implementação de QoS, você já deve ter determinado seus requisitos de largura de banda e outros [requisitos de rede](prepare-network.md).</span><span class="sxs-lookup"><span data-stu-id="2dc6b-142">If you're considering a QoS implementation, you should already have determined your bandwidth requirements and other [network requirements](prepare-network.md).</span></span> 
  
<span data-ttu-id="2dc6b-143">O congestionamento do tráfego em uma rede afetará significativamente a qualidade da mídia.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-143">Traffic congestion across a network will greatly impact media quality.</span></span> <span data-ttu-id="2dc6b-144">A falta de largura de banda leva à degradação do desempenho e a uma experiência de usuário ruim.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-144">A lack of bandwidth leads to performance degradation and a poor user experience.</span></span> <span data-ttu-id="2dc6b-145">À medida que a adoção e o uso das equipes se expandem, use o relatório, a [análise de chamadas por usuário](use-call-analytics-to-troubleshoot-poor-call-quality.md)e o [painel de qualidade de chamada (CQD)](turning-on-and-using-call-quality-dashboard.md) para identificar problemas e fazer ajustes usando QoS e adições seletivas de largura de banda.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-145">As Teams adoption and usage grows, use reporting, [per-user call analytics](use-call-analytics-to-troubleshoot-poor-call-quality.md), and [Call Quality Dashboard (CQD)](turning-on-and-using-call-quality-dashboard.md) to identify problems and then make adjustments using QoS and selective bandwidth additions.</span></span>

### <a name="vpn-considerations"></a><span data-ttu-id="2dc6b-146">Considerações de VPN</span><span class="sxs-lookup"><span data-stu-id="2dc6b-146">VPN considerations</span></span>

<span data-ttu-id="2dc6b-147">A QoS funciona apenas como esperado quando implementada em todos os links entre chamadores.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-147">QoS only works as expected when implemented on all links between callers.</span></span> <span data-ttu-id="2dc6b-148">Se você usar o QoS em uma rede interna e um usuário entrar em um local remoto, você só poderá priorizar dentro da rede gerenciada interna.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-148">If you use QoS on an internal network and a user signs in from a remote location, you can only prioritize within your internal, managed network.</span></span> <span data-ttu-id="2dc6b-149">Apesar de locais remotos receberem uma conexão gerenciada implementando uma rede virtual privada (VPN), a VPN adiciona inerentemente a sobrecarga de pacotes e cria atrasos no tráfego em tempo real.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-149">Although remote locations can receive a managed connection by implementing a virtual private network (VPN),  a VPN inherently adds packet overhead and creates delays in real-time traffic.</span></span> <span data-ttu-id="2dc6b-150">Recomendamos que você evite a execução de tráfego de comunicação em tempo real em uma VPN.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-150">We  recommend that you avoid running real-time communications traffic over a VPN.</span></span>

<span data-ttu-id="2dc6b-151">Em uma organização global com links gerenciados que incluem continentes, é altamente recomendável QoS, pois a largura de banda dos links é limitada em comparação com a LAN.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-151">In a global organization with managed links that span continents, we strongly recommend QoS because bandwidth for those links is limited in comparison to the LAN.</span></span>

## <a name="introduction-to-qos-queues"></a><span data-ttu-id="2dc6b-152">Introdução às filas de QoS</span><span class="sxs-lookup"><span data-stu-id="2dc6b-152">Introduction to QoS queues</span></span>

<span data-ttu-id="2dc6b-153">Para fornecer QoS, os dispositivos de rede devem ter uma maneira de classificar o tráfego e devem ser capazes de distinguir voz ou vídeo de outro tráfego de rede.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-153">To provide QoS, network devices must have a way to classify traffic and must be able to distinguish voice or video from other network traffic.</span></span>

<span data-ttu-id="2dc6b-154">Quando o tráfego de rede entra em um roteador, o tráfego é colocado em uma fila.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-154">When network traffic enters a router, the traffic is placed into a queue.</span></span> <span data-ttu-id="2dc6b-155">Se uma política de QoS não está configurada, há apenas uma fila, e todos os dados são tratados como first-in, First-out com a mesma prioridade.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-155">If a QoS policy isn't configured, there is only one queue, and all data is treated as first-in, first-out with the same priority.</span></span> <span data-ttu-id="2dc6b-156">Isso significa que o tráfego de voz (que é muito sensível a atrasos) pode ficar preso atrás do tráfego em que um atraso de alguns milésimos de segundo extras não seria um problema.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-156">That means voice traffic (which is very sensitive to delays) might get stuck behind traffic where a delay of a few extra milliseconds wouldn't be a problem.</span></span>

<span data-ttu-id="2dc6b-157">Ao implementar o QoS, você define várias filas usando um dos vários recursos de gerenciamento de congestionamento (como a enfileiramento de prioridade da Cisco, o recurso de enfileiramento [justo baseado em classe (CBWFQ](https://www.cisco.com/en/US/docs/ios/12_0t/12_0t5/feature/guide/cbwfq.html#wp17641))) e os recursos de impedimento de congestionamento (como [WRED (detecção antecipada aleatória ponderada)](https://en.wikipedia.org/wiki/Weighted_random_early_detection)).</span><span class="sxs-lookup"><span data-stu-id="2dc6b-157">When you implement QoS, you define multiple queues using one of several congestion management features (such as Cisco’s priority queuing and [Class-Based Weighted Fair Queueing (CBWFQ)](https://www.cisco.com/en/US/docs/ios/12_0t/12_0t5/feature/guide/cbwfq.html#wp17641)) and congestion avoidance features (such as [weighted random early detection (WRED)](https://en.wikipedia.org/wiki/Weighted_random_early_detection)).</span></span>

<span data-ttu-id="2dc6b-158">_Figura 2. Exemplos de filas de QoS_</span><span class="sxs-lookup"><span data-stu-id="2dc6b-158">_Figure 2. Examples of QoS queues_</span></span>

<span data-ttu-id="2dc6b-159">![Ilustração de filas de QoS e divisão de largura de banda](media/Qos-in-Teams-Image2.png "A largura de banda total disponível é dividida entre várias filas, áudio, vídeo e outros tipos de tráfego, que receberam prioridades diferentes.")</span><span class="sxs-lookup"><span data-stu-id="2dc6b-159">![Illustration of QoS queues and bandwidth division](media/Qos-in-Teams-Image2.png "Total available bandwidth is divided among multiple queues—audio, video, and other traffic—that have been assigned different priorities.")</span></span>

<span data-ttu-id="2dc6b-160">Uma simples analogia é que a QoS cria "pistas carona" virtuais na sua rede de dados, assim alguns tipos de dados nunca ou raramente encontram um atraso.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-160">A simple analogy is that QoS creates virtual "carpool lanes" in your data network so some types of data never or rarely encounter a delay.</span></span> <span data-ttu-id="2dc6b-161">Depois de criar essas pistas, você pode ajustar o tamanho relativo e gerenciar com muito mais eficiência a largura de banda da conexão que tem e ainda fornecer experiências de nível empresarial para os usuários da sua organização.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-161">Once you create those lanes, you can adjust their relative size and much more effectively manage the connection bandwidth you have, while still delivering business-grade experiences for your organization's users.</span></span>

## <a name="select-a-qos-implementation-method"></a><span data-ttu-id="2dc6b-162">Selecionar um método de implementação de QoS</span><span class="sxs-lookup"><span data-stu-id="2dc6b-162">Select a QoS implementation method</span></span>

<span data-ttu-id="2dc6b-163">Você pode implementar o QoS via marcação baseada em portas, usando as listas de controle de acesso (ACLs) nos roteadores da sua rede.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-163">You could implement QoS via port-based tagging, using Access Control Lists (ACLs) on your network's routers.</span></span> <span data-ttu-id="2dc6b-164">A marcação baseada em porta é o método mais confiável porque funciona em ambientes mistos Windows, Mac e Linux e é o mais fácil de implementar.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-164">Port-based tagging is the most reliable method because it works in mixed Windows, Mac, and Linux environments and is the easiest to implement.</span></span> <span data-ttu-id="2dc6b-165">Os clientes móveis não fornecem um mecanismo para marcar o tráfego usando valores DSCP, portanto, eles precisarão desse método.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-165">Mobile clients don't provide a mechanism to mark traffic by using DSCP values, so they will require this method.</span></span>  

<span data-ttu-id="2dc6b-166">Usando marcação baseada em porta, o roteador da sua rede examina um pacote de entrada e, se o pacote chegou usando uma determinada porta ou intervalo de portas, ele a identifica como um determinado tipo de mídia e coloca-o na fila desse tipo, adicionando uma marca [DSCP](https://tools.ietf.org/html/rfc2474) predeterminada ao cabeçalho do pacote IP para que outros dispositivos possam reconhecer seu tipo de tráfego e dar prioridade à sua fila.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-166">Using port-based tagging, your network's router examines an incoming packet, and if the packet arrived using a certain port or range of ports, it identifies it as a certain media type and puts it in the queue for that type, adding a predetermined [DSCP](https://tools.ietf.org/html/rfc2474) mark to the IP Packet header so other devices can recognize its traffic type and give it priority in their queue.</span></span>

<span data-ttu-id="2dc6b-167">Embora isso funcione entre plataformas, ele só marca o tráfego na borda da rede de longa distância (não toda a maneira da máquina cliente) e cria uma sobrecarga de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-167">Although this works across platforms, it only marks traffic at the WAN edge (not all the way to the client machine) and creates management overhead.</span></span> <span data-ttu-id="2dc6b-168">Você deve consultar a documentação fornecida pelo fabricante do roteador para obter instruções sobre a implementação desse método.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-168">You should refer to the documentation provided by the router manufacturer for instructions on implementing this method.</span></span>

### <a name="insert-dscp-markers"></a><span data-ttu-id="2dc6b-169">Inserir marcadores DSCP</span><span class="sxs-lookup"><span data-stu-id="2dc6b-169">Insert DSCP markers</span></span>

<span data-ttu-id="2dc6b-170">Você também pode implementar o QoS usando um GPO (objeto de política de grupo) para direcionar dispositivos cliente para inserir um marcador DSCP em cabeçalhos de pacote IP identificando-o como um determinado tipo de tráfego (por exemplo, voz).</span><span class="sxs-lookup"><span data-stu-id="2dc6b-170">You could also implement QoS by using a Group Policy Object (GPO) to direct client devices to insert a DSCP marker in IP packet headers identifying it as particular type of traffic (for example, voice).</span></span> <span data-ttu-id="2dc6b-171">Roteadores e outros dispositivos de rede podem ser configurados para reconhecer isso e colocar o tráfego em uma fila separada de prioridade mais alta.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-171">Routers and other network devices can be configured to recognize this and put the traffic in a separate, higher-priority queue.</span></span>

<span data-ttu-id="2dc6b-172">Embora esse cenário seja totalmente válido, ele só funcionará em clientes Windows associados a um domínio.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-172">Although this scenario is entirely valid, it will only work for domain-joined Windows clients.</span></span> <span data-ttu-id="2dc6b-173">Qualquer dispositivo que não seja um cliente do Windows associado a um domínio não será habilitado para marcação DSCP.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-173">Any device that isn't a domain-joined Windows client won't be enabled for DSCP tagging.</span></span> <span data-ttu-id="2dc6b-174">Clientes como o Mac OS têm marcas embutidas em código e sempre marcarão tráfego.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-174">Clients such as Mac OS have hard-coded tags and will always tag traffic.</span></span>

<span data-ttu-id="2dc6b-175">No lado mais, controlar a marcação DSCP por meio do GPO garante que todos os computadores associados a um domínio recebam as mesmas configurações e que somente um administrador possa gerenciá-los.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-175">On the plus side, controlling the DSCP marking via GPO ensures that all domain-joined computers receive the same settings and that only an administrator can manage them.</span></span> <span data-ttu-id="2dc6b-176">Os clientes que podem usar o GPO serão marcados no dispositivo de origem, e os dispositivos de rede configurados poderão reconhecer o fluxo em tempo real pelo código DSCP e dar a ele uma prioridade adequada.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-176">Clients that can use GPO will be tagged on the originating device, and then configured network devices can recognize the real-time stream by the DSCP code and give it an appropriate priority.</span></span>

### <a name="best-practice"></a><span data-ttu-id="2dc6b-177">Prática recomendada</span><span class="sxs-lookup"><span data-stu-id="2dc6b-177">Best practice</span></span>

<span data-ttu-id="2dc6b-178">Recomendamos uma combinação de marcações DSCP no ponto de extremidade e ACLs baseadas na porta em roteadores, se possível.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-178">We recommend a combination of DSCP markings at the endpoint and port-based ACLs on routers, if possible.</span></span> <span data-ttu-id="2dc6b-179">Usar um objeto de política de grupo para capturar a maioria dos clientes e usar a marcação de DSCP baseada na porta garantirá que o celular, o Mac e outros clientes ainda recebam tratamento de QoS (pelo menos parcialmente).</span><span class="sxs-lookup"><span data-stu-id="2dc6b-179">Using a Group Policy object to catch the majority of clients, and also using port-based DSCP tagging will ensure that mobile, Mac, and other clients will still get QoS treatment (at least partially).</span></span>

<span data-ttu-id="2dc6b-180">As marcações de DSCP podem ser likeneddas para os carimbos de postagem que indicam a trabalhadores em comum qual é a urgência da entrega e como classificá-lo para agilizar a entrega.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-180">DSCP markings can be likened to postage stamps that indicate to postal workers how urgent the delivery is and how best to sort it for speedy delivery.</span></span> <span data-ttu-id="2dc6b-181">Depois de configurar sua rede para dar prioridade a fluxos de mídia em tempo real, os pacotes perdidos e os pacotes atrasados devem diminuir bastante.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-181">Once you've configured your network to give priority to real-time media streams, lost packets and late packets should diminish greatly.</span></span>

<span data-ttu-id="2dc6b-182">Quando todos os dispositivos na rede estiverem usando as mesmas classificações, marcações e prioridades, é possível reduzir ou eliminar atrasos, pacotes ignorados e Tremulação alterando o tamanho dos intervalos de porta atribuídos às filas usadas para cada tipo de tráfego.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-182">Once all devices in the network are using the same classifications, markings, and priorities, it's possible to reduce or eliminate delays, dropped packets, and jitter by changing the size of the port ranges assigned to the queues used for each traffic type.</span></span> <span data-ttu-id="2dc6b-183">Da perspectiva do Teams, a etapa de configuração mais importante é a classificação e a marcação de pacotes, mas para que a QoS ponto a ponto seja bem-sucedida, você também precisa alinhar cuidadosamente a configuração do aplicativo com a configuração de rede subjacente.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-183">From the Teams perspective, the most important configuration step is the classification and marking of packets, but for end-to-end QoS to be successful you also need to carefully align the application's configuration with the underlying network configuration.</span></span> <span data-ttu-id="2dc6b-184">Depois que a QoS é totalmente implementada, o gerenciamento contínuo é uma questão de ajustar os intervalos de porta atribuídos a cada tipo de tráfego com base nas necessidades da sua organização e no uso real.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-184">Once QoS is fully implemented, ongoing management is a question of adjusting the port ranges assigned to each traffic type based on your organization's needs and actual usage.</span></span>

## <a name="choose-initial-port-ranges-for-each-media-type"></a><span data-ttu-id="2dc6b-185">Escolher intervalos de porta iniciais para cada tipo de mídia</span><span class="sxs-lookup"><span data-stu-id="2dc6b-185">Choose initial port ranges for each media type</span></span>

<span data-ttu-id="2dc6b-186">O valor de DSCP informa à rede uma rede configurada correspondente qual prioridade para fornecer um pacote ou fluxo, seja a marca de DSCP atribuída por clientes ou pela rede em si com base nas configurações da ACL.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-186">The DSCP value tells a correspondingly configured network what priority to give a packet or stream, whether the DSCP mark is assigned by clients or the network itself based on ACL settings.</span></span> <span data-ttu-id="2dc6b-187">Cada carga de trabalho de mídia obtém seu próprio valor de DSCP exclusivo (outros serviços podem permitir que as cargas de trabalho compartilhem uma marcação DSCP, o Teams não) e um intervalo de porta definido e separado usado para cada tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-187">Each media workload gets its own unique DSCP value (other services might allow workloads to share a DSCP marking, Teams does not) and a defined and separate port range used for each media type.</span></span> <span data-ttu-id="2dc6b-188">Outros ambientes podem ter uma estratégia de QoS existente no local, o que o ajudará a determinar a prioridade das cargas de trabalho da rede.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-188">Other environments might have an existing QoS strategy in place, which will help you determine the priority of network workloads.</span></span>

<span data-ttu-id="2dc6b-189">O tamanho relativo dos intervalos de porta para cargas de trabalho de streaming em tempo real diferentes define a proporção entre a largura de banda total disponível dedicada a essa carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-189">The relative size of the port ranges for different real-time streaming workloads sets the proportion of the total available bandwidth dedicated to that workload.</span></span> <span data-ttu-id="2dc6b-190">Para voltar à nossa analogia comum anterior: uma letra com um selo "mensagens de ar" pode ser retirada dentro de uma hora para o aeroporto mais próximo, enquanto um pacote pequeno marcado como "Bulk Mail" pode esperar por um dia antes de viajar em uma série de caminhões.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-190">To return to our earlier postal analogy: a letter with an "Air Mail" stamp might get taken within an hour to the nearest airport, while a small package marked "Bulk Mail" mark can wait for a day before traveling over land on a series of trucks.</span></span>

<span data-ttu-id="2dc6b-191">_Intervalos de portas iniciais recomendados_</span><span class="sxs-lookup"><span data-stu-id="2dc6b-191">_Recommended initial port ranges_</span></span>

|<span data-ttu-id="2dc6b-192">Tipo de tráfego de mídia</span><span class="sxs-lookup"><span data-stu-id="2dc6b-192">Media traffic type</span></span>| <span data-ttu-id="2dc6b-193">Intervalo de portas de origem do cliente </span><span class="sxs-lookup"><span data-stu-id="2dc6b-193">Client source port range</span></span> |<span data-ttu-id="2dc6b-194">Protocolo</span><span class="sxs-lookup"><span data-stu-id="2dc6b-194">Protocol</span></span>|<span data-ttu-id="2dc6b-195">Valor DSCP</span><span class="sxs-lookup"><span data-stu-id="2dc6b-195">DSCP value</span></span>|<span data-ttu-id="2dc6b-196">Classe DSCP</span><span class="sxs-lookup"><span data-stu-id="2dc6b-196">DSCP class</span></span>|
|:--- |:--- |:--- |:--- |:--- |
|<span data-ttu-id="2dc6b-197">Áudio</span><span class="sxs-lookup"><span data-stu-id="2dc6b-197">Audio</span></span>| <span data-ttu-id="2dc6b-198">50.000–50.019</span><span class="sxs-lookup"><span data-stu-id="2dc6b-198">50,000–50,019</span></span>|<span data-ttu-id="2dc6b-199">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="2dc6b-199">TCP/UDP</span></span>|<span data-ttu-id="2dc6b-200">46</span><span class="sxs-lookup"><span data-stu-id="2dc6b-200">46</span></span>|<span data-ttu-id="2dc6b-201">Expedited Forwarding (EF)</span><span class="sxs-lookup"><span data-stu-id="2dc6b-201">Expedited Forwarding (EF)</span></span>|
|<span data-ttu-id="2dc6b-202">Vídeo</span><span class="sxs-lookup"><span data-stu-id="2dc6b-202">Video</span></span>| <span data-ttu-id="2dc6b-203">50.020–50.039</span><span class="sxs-lookup"><span data-stu-id="2dc6b-203">50,020–50,039</span></span>|<span data-ttu-id="2dc6b-204">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="2dc6b-204">TCP/UDP</span></span>|<span data-ttu-id="2dc6b-205">34</span><span class="sxs-lookup"><span data-stu-id="2dc6b-205">34</span></span>|<span data-ttu-id="2dc6b-206">Assured Forwarding (AF41)</span><span class="sxs-lookup"><span data-stu-id="2dc6b-206">Assured Forwarding (AF41)</span></span>|
|<span data-ttu-id="2dc6b-207">Compartilhamento de tela/aplicativo</span><span class="sxs-lookup"><span data-stu-id="2dc6b-207">Application/Screen Sharing</span></span>| <span data-ttu-id="2dc6b-208">50.040-50.059</span><span class="sxs-lookup"><span data-stu-id="2dc6b-208">50,040–50,059</span></span>|<span data-ttu-id="2dc6b-209">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="2dc6b-209">TCP/UDP</span></span>|<span data-ttu-id="2dc6b-210">dezoito</span><span class="sxs-lookup"><span data-stu-id="2dc6b-210">18</span></span>|<span data-ttu-id="2dc6b-211">Assured Forwarding (AF21)</span><span class="sxs-lookup"><span data-stu-id="2dc6b-211">Assured Forwarding (AF21)</span></span>|
||||||

<span data-ttu-id="2dc6b-212">Lembre-se do seguinte ao usar estas configurações:</span><span class="sxs-lookup"><span data-stu-id="2dc6b-212">Be aware of the following when you use these settings:</span></span>

- <span data-ttu-id="2dc6b-213">Se você planeja implementar o ExpressRoute no futuro e ainda não implementou a QoS, recomendamos que siga as orientações para que os valores de DSCP sejam iguais do remetente ao destinatário.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-213">If you plan to implement ExpressRoute in the future and haven't yet implemented QoS, we recommend that you follow the guidance so that DSCP values are the same from sender to receiver.</span></span>
- <span data-ttu-id="2dc6b-214">Todos os clientes, incluindo clientes móveis e dispositivos de equipe, usarão esses intervalos de porta e serão afetados por qualquer política de DSCP implementada que use esses intervalos de porta de origem.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-214">All clients, including mobile clients and Teams devices, will use these port ranges and will be affected by any DSCP policy you implement that uses these source port ranges.</span></span> <span data-ttu-id="2dc6b-215">Os únicos clientes que continuarão a usar portas dinâmicas são os clientes baseados em navegador (ou seja, os clientes que permitem que os participantes ingressem em reuniões usando seus navegadores).</span><span class="sxs-lookup"><span data-stu-id="2dc6b-215">The only clients that will continue to use dynamic ports are the browser-based clients (that is, those clients that let participants join meetings by using their browsers).</span></span>
- <span data-ttu-id="2dc6b-216">Embora o cliente Mac use os mesmos intervalos de porta, ele também usa valores embutidos em áudio (EF) e vídeo (AF41).</span><span class="sxs-lookup"><span data-stu-id="2dc6b-216">Although the Mac client uses the same port ranges, it also uses hard-coded values for audio (EF) and video (AF41).</span></span> <span data-ttu-id="2dc6b-217">Esses valores não são configuráveis.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-217">These values are not configurable.</span></span>
- <span data-ttu-id="2dc6b-218">Se, posteriormente, você precisar ajustar os intervalos de porta para melhorar a experiência do usuário, os intervalos de porta não poderão se sobrepor e devem ser adjacentes.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-218">If you later need to adjust the port ranges to improve user experience, the port ranges can not overlap and should be adjacent to each other.</span></span>

## <a name="migrate-qos-to-teams"></a><span data-ttu-id="2dc6b-219">Migrar QoS para o Teams</span><span class="sxs-lookup"><span data-stu-id="2dc6b-219">Migrate QoS to Teams</span></span>

<span data-ttu-id="2dc6b-220">Se você já implantou o Skype for Business Online, incluindo a marcação de QoS e os intervalos de porta, e agora está implantando equipes, o Teams respeitará a configuração existente e usará os mesmos intervalos de porta e marcação que o cliente Skype for Business.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-220">If you've previously deployed Skype for Business Online, including QoS tagging and port ranges, and are now deploying Teams, Teams will respect the existing configuration and will use the same port ranges and tagging as the Skype for Business client.</span></span> <span data-ttu-id="2dc6b-221">Na maioria dos casos, nenhuma configuração adicional será necessária.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-221">In most cases, no additional configuration will be needed.</span></span>

> [!NOTE]
> <span data-ttu-id="2dc6b-222">Se você estiver usando a marcação de QoS de nome do aplicativo por meio da política de grupo, será necessário adicionar Teams.exe como o nome do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-222">If you're using Application Name QoS tagging via Group Policy, you must add Teams.exe as the application name.</span></span>


## <a name="managing-source-ports-in-the-teams-admin-center"></a><span data-ttu-id="2dc6b-223">Gerenciar portas de origem no centro de administração do teams</span><span class="sxs-lookup"><span data-stu-id="2dc6b-223">Managing source ports in the Teams admin center</span></span>

<span data-ttu-id="2dc6b-224">No Teams, as portas de origem de QoS usadas pelas diferentes cargas de trabalho devem ser gerenciadas ativamente e ajustadas conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-224">In Teams, QoS source ports used by the different workloads should be actively managed, and adjusted as necessary.</span></span> <span data-ttu-id="2dc6b-225">Fazendo referência à tabela em [escolher intervalos de portas iniciais para cada tipo de mídia](#choose-initial-port-ranges-for-each-media-type), os intervalos de porta são ajustáveis, mas as marcações de DSCP não são configuráveis.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-225">Referring to the table in [Choose initial port ranges for each media type](#choose-initial-port-ranges-for-each-media-type), the port ranges are adjustable, but the DSCP markings are not configurable.</span></span> <span data-ttu-id="2dc6b-226">Depois de implementar essas configurações, você pode descobrir que mais ou menos portas são necessárias para um determinado tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-226">Once you have implemented these settings, you may find that more or fewer ports are needed for a given media type.</span></span> <span data-ttu-id="2dc6b-227">O painel de [análise de chamadas por usuário](use-call-analytics-to-troubleshoot-poor-call-quality.md) e o [painel de qualidade de chamada (CQD)](turning-on-and-using-call-quality-dashboard.md) devem ser usados para tomar uma decisão de ajustar os intervalos de porta após a implementação das equipes e, periodicamente, as necessidades serem alteradas.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-227">[Per-user call analytics](use-call-analytics-to-troubleshoot-poor-call-quality.md) and [Call Quality Dashboard (CQD)](turning-on-and-using-call-quality-dashboard.md) should be used in making a decision to adjust port ranges after Teams has been implemented, and periodically as needs change.</span></span>

> [!NOTE]
> <span data-ttu-id="2dc6b-228">Se você já configurou o QoS com base em intervalos de porta de origem e marcações DSCP para o Skype for Business Online, a mesma configuração será aplicada às equipes e não será necessária nenhuma outra alteração de cliente ou de rede para o mapeamento, mas talvez seja necessário [definir os intervalos usados no Teams](meeting-settings-in-teams.md#set-how-you-want-to-handle-real-time-media-traffic-for-teams-meetings) para corresponder ao que foi configurado para o Skype for Business online.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-228">If you've already configured QoS based on source port ranges and DSCP markings for Skype for Business Online, the same configuration will apply to Teams and no further client or network changes to the mapping will be required, though you may have to [set the ranges used in Teams](meeting-settings-in-teams.md#set-how-you-want-to-handle-real-time-media-traffic-for-teams-meetings) to match what was configured for Skype for Business Online.</span></span>

<span data-ttu-id="2dc6b-229">Se você já implantou o Skype for Business Server no local, talvez seja necessário examinar novamente suas políticas de QoS e ajustá-las para corresponder às configurações de intervalo de porta que você verificou fornecer uma experiência de usuário de qualidade para equipes.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-229">If you’ve previously deployed Skype for Business Server on-premises, you may need to re-examine your QoS policies and adjust them to match port range settings you've verified provide a quality user experience for Teams.</span></span>

## <a name="validate-your-qos-implementation"></a><span data-ttu-id="2dc6b-230">Validar a implementação de QoS</span><span class="sxs-lookup"><span data-stu-id="2dc6b-230">Validate your QoS implementation</span></span>

<span data-ttu-id="2dc6b-231">Para que a QoS seja eficiente, o valor de DSCP definido pelo objeto de política de grupo precisa estar presente em ambas as extremidades de uma chamada.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-231">For QoS to be effective, the DSCP value set by the Group Policy object needs to be present at both ends of a call.</span></span> <span data-ttu-id="2dc6b-232">Ao analisar o tráfego gerado pelo cliente da equipe, você pode verificar se o valor de DSCP não foi alterado ou removido quando o tráfego de carga de trabalho do teams se move pela rede.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-232">By analyzing the traffic generated by the Teams client, you can verify that the DSCP value isn’t changed or stripped out when the Teams workload traffic moves through the network.</span></span>

<span data-ttu-id="2dc6b-233">Preferencialmente, você captura o tráfego no ponto de saída de rede.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-233">Preferably, you capture traffic at the network egress point.</span></span> <span data-ttu-id="2dc6b-234">Você pode usar o espelhamento de porta em um switch ou um roteador para obter ajuda com isso.</span><span class="sxs-lookup"><span data-stu-id="2dc6b-234">You can use port mirroring on a switch or router to help with this.</span></span>


## <a name="related-topics"></a><span data-ttu-id="2dc6b-235">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="2dc6b-235">Related topics</span></span>

[<span data-ttu-id="2dc6b-236">Vídeo: Planejamento de rede</span><span class="sxs-lookup"><span data-stu-id="2dc6b-236">Video: Network Planning</span></span>](https://aka.ms/teams-networking)

[<span data-ttu-id="2dc6b-237">Preparar a rede da organização para o Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="2dc6b-237">Prepare your organization's network for Microsoft Teams</span></span>](prepare-network.md)

[<span data-ttu-id="2dc6b-238">Implementar QoS no cliente do teams</span><span class="sxs-lookup"><span data-stu-id="2dc6b-238">Implement QoS in the Teams client</span></span>](QoS-in-Teams-clients.md)
