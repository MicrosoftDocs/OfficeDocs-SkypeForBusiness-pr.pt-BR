---
title: "Qualidade de Serviço (QoS) no Microsoft Teams"
author: rmw2890
ms.author: MyAdvisor
manager: Serdars
ms.date: 02/16/2018
ms.topic: article
ms.service: msteams
description: "Prepare a rede da sua organização para a Qualidade de Serviço (QoS) no Microsoft Teams"
MS.collection: Strat_MT_TeamsAdmin
ms.openlocfilehash: 61bebd64c7d1478c16e114631b696dee2bf59625
ms.sourcegitcommit: 85105cb4e42ae8eb6e7e76eaf6d4dd5b9568cf41
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/19/2018
---
<a name="quality-of-service-qos-in-microsoft-teams"></a><span data-ttu-id="f3a9a-103">Qualidade de Serviço (QoS) no Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="f3a9a-103">Quality of Service (QoS) in Microsoft Teams</span></span>
==========================================
<span data-ttu-id="f3a9a-104">Este guia ajudará na preparação da rede da sua organização para a Qualidade de Serviço (QoS) no Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-104">This guide will help you prepare your organization's network for Quality of Service (QoS) in Teams.</span></span>


<span data-ttu-id="f3a9a-105">A Qualidade de Serviço (QoS) é um mecanismo que permite priorizar determinados tipos de tráfego de rede.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-105">Quality of Service (QoS) is a mechanism that lets you prioritize certain types of network traffic.</span></span> <span data-ttu-id="f3a9a-106">A priorização do tráfego de serviços de comunicação em tempo real, como o Microsoft Teams, é importante para oferecer uma experiência do usuário em nível corporativo.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-106">Prioritizing the traffic for real-time communications services such as Teams is important in order to deliver a business-grade user experience.</span></span> <span data-ttu-id="f3a9a-107">Para que a QoS seja realmente efetiva, é necessário configurar uma conexão compatível com QoS de ponta a ponta (computadores, comutadores de rede e roteadores para a nuvem), pois se não houver suporte à QoS em alguma parte do caminho, a qualidade de toda a chamada poderá ser reduzida.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-107">For QoS to be truly effective, a QoS-capable connection must be configured end-to-end (PC, network switches, and routers to the cloud), because any part in the path that fails to support QoS could degrade the quality of the entire call.</span></span>


![Captura de tela de um diagrama que ilustra a relação entre as redes de uma organização e os serviços do Office 365.](media/Qos-in-Teams-Image1.png)

 

<span data-ttu-id="f3a9a-109">Na maioria dos casos, a rede de interconexão será uma rede não gerenciada, uma conexão com a Internet.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-109">In most cases, the interconnect network will be an unmanaged network, an internet connection.</span></span> <span data-ttu-id="f3a9a-110">Uma opção disponível para abordar a QoS de ponta a ponta é o [ExpressRoute](https://azure.microsoft.com/documentation/articles/expressroute-introduction/).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-110">One option available to address end-to-end QoS is [ExpressRoute](https://azure.microsoft.com/documentation/articles/expressroute-introduction/).</span></span> <span data-ttu-id="f3a9a-111">Recomendamos ainda implementar a QoS nas partes da rede sobre as quais você tem controle, ou seja, sua rede local.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-111">It is our recommendation to still implement QoS on the portions of the network you have control over, namely your on-premises network.</span></span> <span data-ttu-id="f3a9a-112">Assim, a qualidade das cargas de trabalho de comunicação em tempo real será melhor em toda a implantação, e os pontos de estrangulamento na implantação existente serão aliviados.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-112">This will increase the quality of real time communication workloads throughout your deployment and will alleviate choke points in your existing deployment.</span></span> 

## <a name="objectives"></a><span data-ttu-id="f3a9a-113">Objetivos</span><span class="sxs-lookup"><span data-stu-id="f3a9a-113">Objectives</span></span> 

<span data-ttu-id="f3a9a-114">Este guia foca a maneira de priorizar o tráfego da comunicação em tempo real do Microsoft Teams, especialmente de voz e vídeo.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-114">This guide will focus on how to prioritize Teams real-time communications traffic, namely voice and video.</span></span> <span data-ttu-id="f3a9a-115">Também é possível priorizar outros tipos de tráfego de acordo com as suas necessidades.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-115">Other types of traffic can also be prioritized based on your needs.</span></span>

<span data-ttu-id="f3a9a-116">Há várias maneiras de priorizar o tráfego, mas a mais comum é usando marcações DSCP (Ponto de Código de Serviços Diferenciados).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-116">There are multiple ways to prioritize traffic, but the most common is by using differentiated services code point (DSCP) markings.</span></span> <span data-ttu-id="f3a9a-117">Elas podem ser aplicadas com base nos intervalos de portas, mas também via Objetos de Política de Grupo.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-117">They can be applied based on port ranges but also via Group Policy objects.</span></span> <span data-ttu-id="f3a9a-118">Neste documento, vamos abordar os dois casos.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-118">We will cover both in this document.</span></span>

<span data-ttu-id="f3a9a-119">O controle da marcação DSCP via GPO (Objetos de Política de Grupo) garante que os computadores que ingressaram em um domínio recebam as configurações corretas e que essas configurações possam ser gerenciadas somente por um administrador.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-119">Controlling the DSCP marking via Group Policy objects (GPO) ensures that domain-joined computers receive the correct settings and that these settings can only be managed by an administrator.</span></span> 

<span data-ttu-id="f3a9a-120">É importante entender que a QoS só funciona quando implementada em todos os links que conectam o autor e o destinatário da chamada.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-120">It’s important to understand that QoS only works when implemented on all links connecting caller to callee.</span></span> <span data-ttu-id="f3a9a-121">Se usarmos a QoS na rede interna e um usuário entrar de um local remoto, a priorização será possível somente dentro da rede interna gerenciada.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-121">If we use QoS on the internal network and a user signs in from a remote location, we can only prioritize within our internal, managed, network.</span></span> <span data-ttu-id="f3a9a-122">Locais remotos poderiam receber uma conexão gerenciada por meio da implementação de uma VPN, mas não é recomendável executar o tráfego de comunicação em tempo real pela VPN.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-122">While remote locations could receive a managed connection by implementing a VPN, it is not recommended to run real-time communications traffic over the VPN.</span></span>

> [!NOTE]
> <span data-ttu-id="f3a9a-123">Nossa recomendação é implementar um túnel dividido para usuários remotos conectados via VPN a fim de proporcionar a melhor experiência do usuário possível.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-123">Our recommendation is to implement split tunneling for VPN connected remote users to maximize the user experience.</span></span> <span data-ttu-id="f3a9a-124">Consulte o documento [Deploy-Guidance-VPN Split Tunnel](https://myadvisor.fasttrack.microsoft.com/CloudVoice/Downloads?SelectedIDs=5_1_0_9 ) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-124">See the document [Deploy-Guidance-VPN Split Tunnel](https://myadvisor.fasttrack.microsoft.com/CloudVoice/Downloads?SelectedIDs=5_1_0_9 ) for more information.</span></span>

<span data-ttu-id="f3a9a-125">Em uma organização global com links gerenciados espalhados por vários continentes, é altamente recomendável usar a QoS, pois a largura de banda é limitada em comparação com a LAN (rede local).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-125">In a global organization with managed links spanning continents, QoS is highly recommended since the bandwidth is limited in comparisons to the local network (LAN).</span></span>

## <a name="quality-of-service"></a><span data-ttu-id="f3a9a-126">Qualidade de Serviço</span><span class="sxs-lookup"><span data-stu-id="f3a9a-126">Managing Quality of Service</span></span>

<span data-ttu-id="f3a9a-127">Para oferecer um nível de serviço garantido para um aplicativo na rede, os dispositivos de rede subjacentes devem ser capazes de classificar diferentes tipos de tráfego.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-127">In order to provide a guaranteed level of service for an application on the network, the underlying network devices must have a way to classify different types of traffic.</span></span> <span data-ttu-id="f3a9a-128">Um roteador, por exemplo, precisa diferenciar o tráfego de voz e o tráfego normal de navegação na Web, se for esperado que a voz receba um tratamento melhor.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-128">A router, for example, must be able to distinguish between voice traffic and normal web browsing traffic, if there is an expectation that voice receives better treatment.</span></span> 

<span data-ttu-id="f3a9a-129">O DiffServ (Serviços Diferenciados) fornece uma estrutura na qual o tráfego é tratado por dispositivos de rede com prioridades baseadas no campo de ToS (tipo de serviços) no cabeçalho do pacote IPv4/IPv6.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-129">Differentiated Services (DiffServ) provides a framework in which traffic is treated by network devices with priorities based on the type of services (ToS) field in the header of an IPv4/IPv6 packet.</span></span> <span data-ttu-id="f3a9a-130">Os seis bits mais significativos do campo DiffServ são chamados de Ponto de Código de Serviços Diferenciados ou DSCP.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-130">The six most significant bits of the DiffServ field is known as the Differentiated Services Code Point, or DSCP.</span></span> <span data-ttu-id="f3a9a-131">Usando essa estrutura, é possível classificar o tráfego como um tipo de tráfego específico (voz) e marcá-lo (101110 ou 46, em decimal), de modo que, quando os dispositivos de rede processarem essas marcações, o tráfego poderá ser priorizado de maneira correspondente (neste exemplo, Expedited Forwarding).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-131">Using this framework, traffic can be classified as a particular type of traffic (voice), and then marked (101110, or 46 in decimal), such that when network devices process these markings, the traffic can be prioritized accordingly (Expedited Forwarding, in this example).</span></span>

<span data-ttu-id="f3a9a-132">Quando o tráfego de rede entra em um roteador, ele é colocado em uma fila. Se não houver QoS em vigor, haverá basicamente uma única fila, e os dados serão tratados por ordem de chegada. Isso quer dizer que o tráfego de voz (que é muito sensível a atrasos) poderia ficar travado atrás do tráfego de serviços de streaming online.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-132">When network traffic enters a router, the traffic is placed into a queue – if there is no QoS in place, essentially there is only one queue, and data is treated as first-in, first-out. That means voice traffic (which is very sensitive to delays) could get stuck behind traffic from online streaming services.</span></span> <span data-ttu-id="f3a9a-133">Ao implementar a QoS, é possível definir várias filas com diferentes recursos de gerenciamento de congestionamento (como o Priority Queuing (PQ) e o Class Based Weighted Fair Queue (CBWFQ) da Cisco) e recursos para evitar congestionamentos (como o Weighted Random Early Detection (WRED)).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-133">When implementing QoS, multiple queues can be defined, with different congestion management features (such as Cisco’s Priority Queuing (PQ) and Class Based Weighted Fair Queue (CBWFQ)) and congestion avoidance features (such as Weighted Random Early Detection (WRED)).</span></span>

![Captura de tela de um diagrama que ilustra filas de QoS no Microsoft Teams.](media/Qos-in-Teams-Image2.png)

<span data-ttu-id="f3a9a-135">Figura 1: Visualização das filas de QoS</span><span class="sxs-lookup"><span data-stu-id="f3a9a-135">Figure 1: QoS queues visualized</span></span>

<span data-ttu-id="f3a9a-136">Quando essas peças estão no lugar, é possível fornecer uma qualidade de serviço previsível, pois a rede gerenciada subjacente sabe como classificar, marcar e priorizar o tráfego.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-136">Once these pieces are in place, a predictable quality of service can be delivered, as the underlying managed network now understands how to classify, mark and prioritize traffic.</span></span> <span data-ttu-id="f3a9a-137">Da perspectiva do Microsoft Teams, o item de configuração mais importante é a classificação e a marcação de pacotes. Mas é necessário um planejamento cuidadoso para alinhar a configuração do aplicativo com a configuração de rede subjacente para que a QoS de ponta a ponta seja bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-137">From the Teams perspective, the most important configuration item is the classification and marking of packets – but careful planning is involved to align the application’s configuration with the underlying network configuration for end-to-end QoS to be successful.</span></span>

## <a name="qos-scenarios"></a><span data-ttu-id="f3a9a-138">Cenários de QoS</span><span class="sxs-lookup"><span data-stu-id="f3a9a-138">QoS scenarios</span></span>

<span data-ttu-id="f3a9a-139">Ao implementar a QoS para o Microsoft Teams, baseamos nossas orientações em quatro cenários iniciais:</span><span class="sxs-lookup"><span data-stu-id="f3a9a-139">When implementing QoS for Teams, we’ve based our guidance on four starting scenarios:</span></span>

1.  <span data-ttu-id="f3a9a-140">Você implantou ou está implantando o Microsoft Teams e planeja implementar a QoS via marcação baseada em porta.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-140">You’ve deployed or are deploying Teams and are planning on implementing QoS via Port Based Tagging.</span></span> <span data-ttu-id="f3a9a-141">A marcação baseada em porta é o método mais confiável porque funciona universalmente em todas as plataformas e é o mais fácil de implementar.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-141">Port Based Tagging is the most reliable method since it works universally throughout all platforms and is the easiest to implement.</span></span> 

2.  <span data-ttu-id="f3a9a-142">Você implantou ou está implantando o Microsoft Teams e planeja implementar a QoS via marcação de Objetos de Política de Grupo.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-142">You’ve deployed or are deploying Teams and are planning to implement QoS via Group Policy Object tagging.</span></span> <span data-ttu-id="f3a9a-143">Às vezes, essa opção é usada em combinação com o cenário 1.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-143">This is sometimes used in combination with scenario 1.</span></span> <span data-ttu-id="f3a9a-144">Embora esse cenário seja inteiramente válido e esteja descrito a seguir, é importante saber que ele só funcionará para clientes Windows que ingressaram no domínio.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-144">While this scenario is entirely valid and described below, it is important to understand this will only work for Domain Joined Windows Clients.</span></span> <span data-ttu-id="f3a9a-145">Não é possível habilitar dispositivos que não são clientes Windows ingressados no domínio para a marcação de QoS\DSCP.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-145">Any device that is not a Windows Domain Joined Client will not be enabled for QoS\DSCP Tagging.</span></span> 

3.  <span data-ttu-id="f3a9a-146">Você tem o Skype for Business Online implantado, incluindo a marcação de QoS, e está implantando o Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-146">You have Skype for Business Online deployed including QoS Tagging and are now deploying Teams.</span></span> <span data-ttu-id="f3a9a-147">Se for o seu caso, o Microsoft Teams respeitará a configuração existente e usará os mesmos intervalos de portas e a mesma marcação do cliente Skype for Business.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-147">If this is you, Teams will respect the existing configuration and will use the same port ranges and tagging as the Skype for Business client.</span></span> <span data-ttu-id="f3a9a-148">Não deve ser necessária qualquer configuração adicional.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-148">No additional configuration should be needed.</span></span> 
    > [!NOTE]
    > <span data-ttu-id="f3a9a-149">Se você está usando a marcação de QoS de Nome do Aplicativo via Política de Grupo, deve adicionar “Teams.exe” como Nome do Aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-149">If you're using Application Name QoS tagging via Group Policy you should add “Teams.exe” as Application Name.</span></span>
4.  <span data-ttu-id="f3a9a-150">Você implantou ou está implantando o Microsoft Teams e deseja implementar a QoS via marcação baseada em porta com um intervalo de portas personalizado.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-150">You’ve deployed or are deploying Teams and want to implement QoS via port-based tagging with a custom port range.</span></span>

## <a name="recommended-differentiated-services-code-point-dscp-markings"></a><span data-ttu-id="f3a9a-151">Marcações DSCP (Ponto de Código de Serviços Diferenciados) recomendadas</span><span class="sxs-lookup"><span data-stu-id="f3a9a-151">Recommended differentiated services code point (DSCP) markings</span></span>

<span data-ttu-id="f3a9a-152">O primeiro passo é classificar os fluxos de tráfego (por exemplo, de áudio e vídeo), utilizando os intervalos de portas exclusivos, não sobrepostos, com um valor de DSCP.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-152">The first step is to classify the traffic flows (such as audio and video) by leveraging the unique, non-overlapping port ranges with a DSCP-value.</span></span> <span data-ttu-id="f3a9a-153">O valor de DSCP atribuído aqui determinará a prioridade do tráfego que passa pela rede (com base na configuração de rede).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-153">The DSCP value assigned here will determine the priority of the traffic going through the network (based on the network configuration).</span></span> <span data-ttu-id="f3a9a-154">Cada carga de trabalho recebe seu próprio valor de DSCP, embora alguns clientes possam definir o mesmo valor para voz e vídeo, atribuindo a elas a mesma prioridade na rede.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-154">Each workload gets its own DSCP value, although some customers might set the same value on voice and video, giving them the same priority in the network.</span></span> 

<span data-ttu-id="f3a9a-155">O valor de DSCP que deve ser usado depende da maneira como a carga de trabalho é priorizada.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-155">What DSCP value to use depends on how a workload is prioritized.</span></span> <span data-ttu-id="f3a9a-156">Por exemplo, requisitos de negócios poderiam impor que o compartilhamento de aplicativos deve ser tratado com o mesmo nível de prioridade que o vídeo (e, portanto, marcado com o mesmo valor de DSCP que o vídeo).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-156">For example, business requirements could dictate that application sharing is to be treated with the same level of priority as video (and as such, marked with the same DSCP-value as video).</span></span> <span data-ttu-id="f3a9a-157">Outros ambientes podem ter uma estratégia de QoS existente já em vigor.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-157">Other environments might have an existing QoS strategy in place already.</span></span> 

<span data-ttu-id="f3a9a-158">A Tabela 1 abaixo mostra as marcações DSCP requeridas ao utilizar o Microsoft Teams com ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-158">Table 1 below shows the required DSCP markings when utilizing Teams with ExpressRoute.</span></span> <span data-ttu-id="f3a9a-159">Isso serviria como um bom ponto de partida para clientes que não têm certeza sobre o que usar em seu próprio ambiente.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-159">This could serve as a good starting point for customers unsure what to use in their own environment.</span></span> <span data-ttu-id="f3a9a-160">Para saber mais, consulte [Requisitos de QoS para o ExpressRoute](https://docs.microsoft.com/azure/expressroute/expressroute-qos).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-160">To learn more, read [ExpressRoute QoS requirements](https://docs.microsoft.com/azure/expressroute/expressroute-qos).</span></span>


| <span data-ttu-id="f3a9a-161">Porta de origem do cliente</span><span class="sxs-lookup"><span data-stu-id="f3a9a-161">Client source port</span></span>|<span data-ttu-id="f3a9a-162">Protocolo</span><span class="sxs-lookup"><span data-stu-id="f3a9a-162">Protocol</span></span>|<span data-ttu-id="f3a9a-163">Categoria da mídia</span><span class="sxs-lookup"><span data-stu-id="f3a9a-163">Media category</span></span>|<span data-ttu-id="f3a9a-164">Valor DSCP comum</span><span class="sxs-lookup"><span data-stu-id="f3a9a-164">Common DSCP value</span></span>|<span data-ttu-id="f3a9a-165">Classe DSCP</span><span class="sxs-lookup"><span data-stu-id="f3a9a-165">DSCP class</span></span>|
|---------|---------|---------|---------|---------|
| <span data-ttu-id="f3a9a-166">50.000 – 50.019</span><span class="sxs-lookup"><span data-stu-id="f3a9a-166">50,000 – 50,019</span></span>|<span data-ttu-id="f3a9a-167">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="f3a9a-167">TCP/UDP</span></span>|<span data-ttu-id="f3a9a-168">Áudio</span><span class="sxs-lookup"><span data-stu-id="f3a9a-168">Audio</span></span>|<span data-ttu-id="f3a9a-169">46</span><span class="sxs-lookup"><span data-stu-id="f3a9a-169">46</span></span>|<span data-ttu-id="f3a9a-170">Expedited Forwarding (EF)</span><span class="sxs-lookup"><span data-stu-id="f3a9a-170">Expedited Forwarding (EF)</span></span>|
| <span data-ttu-id="f3a9a-171">50.020 – 50.039</span><span class="sxs-lookup"><span data-stu-id="f3a9a-171">50,020 – 50,039</span></span>|<span data-ttu-id="f3a9a-172">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="f3a9a-172">TCP/UDP</span></span>|<span data-ttu-id="f3a9a-173">Vídeo</span><span class="sxs-lookup"><span data-stu-id="f3a9a-173">Video</span></span>|<span data-ttu-id="f3a9a-174">34</span><span class="sxs-lookup"><span data-stu-id="f3a9a-174">3-4</span></span>|<span data-ttu-id="f3a9a-175">Assured Forwarding (AF41)</span><span class="sxs-lookup"><span data-stu-id="f3a9a-175">Assured Forwarding (AF41)</span></span>|
| <span data-ttu-id="f3a9a-176">50.040 – 50.059</span><span class="sxs-lookup"><span data-stu-id="f3a9a-176">50,040 – 50,059</span></span>|<span data-ttu-id="f3a9a-177">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="f3a9a-177">TCP/UDP</span></span>|<span data-ttu-id="f3a9a-178">Compartilhamento de aplicativos/área de trabalho e transferência de arquivos</span><span class="sxs-lookup"><span data-stu-id="f3a9a-178">Application/Desktop Sharing and File Transfer</span></span>|<span data-ttu-id="f3a9a-179">18</span><span class="sxs-lookup"><span data-stu-id="f3a9a-179">18</span></span>|<span data-ttu-id="f3a9a-180">Seletor de classe (CS3)</span><span class="sxs-lookup"><span data-stu-id="f3a9a-180">Class Selector (CS3)</span></span>|

<span data-ttu-id="f3a9a-181">Tabela 1: Marcações DSCP</span><span class="sxs-lookup"><span data-stu-id="f3a9a-181">Table 1: DSCP markings</span></span>

<span data-ttu-id="f3a9a-182">Veja aqui algumas condições que devem ser observadas ao usar as informações da Tabela 1:</span><span class="sxs-lookup"><span data-stu-id="f3a9a-182">Here are some caveats to understand when you use the information in Table 1:</span></span>

- <span data-ttu-id="f3a9a-183">O compartilhamento de arquivos e o compartilhamento de aplicativos usam o mesmo intervalo de portas de origem. Dessa maneira, usariam as mesmas marcações DSCP ao utilizar a marcação baseada em porta.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-183">File sharing and application sharing use the same source port range – and as such, would use the same DSCP markings when using Port Based Tagging.</span></span> <span data-ttu-id="f3a9a-184">Por isso, é necessário determinar qual prioridade se aplica melhor *às duas* modalidades (Interativa ou Padrão).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-184">Because of this, it should be determined which priority is most applicable to *both* modalities (Interactive or Default).</span></span>
    
- <span data-ttu-id="f3a9a-185">Se houver planos de implementar o ExpressRoute no futuro e a QoS ainda não tiver sido implementada, é recomendável seguir as orientações fornecidas acima de modo que os valores de DSCP sejam iguais do remetente ao destinatário.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-185">If there’s a plan to implement ExpressRoute in the future and QoS has not yet been implemented, the recommendation is to follow the guidance given above so that DSCP values are the same from sender to receiver.</span></span> 
    
## <a name="source-ports-used-by-teams"></a><span data-ttu-id="f3a9a-186">Portas de origem usadas pelo Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="f3a9a-186">Source ports used by Teams</span></span>

<span data-ttu-id="f3a9a-187">No Microsoft Teams, a QoS deve ser configurada com base nas portas de origem usadas pelas diferentes cargas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-187">In Teams, QoS should be configured based on the source ports used by the different workloads.</span></span> <span data-ttu-id="f3a9a-188">Neste momento, não é possível configurar os intervalos de portas do lado do servidor, nem do lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-188">Both server-side and client-side port ranges are non-configurable at this point.</span></span> 

<span data-ttu-id="f3a9a-189">Para implantar a QoS, use os intervalos de portas de origem do cliente listados na Tabela 2 com as marcações DSCP de QoS associadas.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-189">To deploy QoS, use the client source port ranges listed in Table 2, with their associated QoS DSCP markings.</span></span>

| <span data-ttu-id="f3a9a-190">Porta de origem do cliente</span><span class="sxs-lookup"><span data-stu-id="f3a9a-190">Client source port</span></span>|<span data-ttu-id="f3a9a-191">Protocolo</span><span class="sxs-lookup"><span data-stu-id="f3a9a-191">Protocol</span></span>|<span data-ttu-id="f3a9a-192">Categoria da mídia</span><span class="sxs-lookup"><span data-stu-id="f3a9a-192">Media category</span></span>|<span data-ttu-id="f3a9a-193">Valor DSCP comum</span><span class="sxs-lookup"><span data-stu-id="f3a9a-193">Common DSCP value</span></span>|<span data-ttu-id="f3a9a-194">Classe DSCP</span><span class="sxs-lookup"><span data-stu-id="f3a9a-194">DSCP class</span></span>|
|---------|---------|---------|---------|---------|
| <span data-ttu-id="f3a9a-195">50.000 – 50.019</span><span class="sxs-lookup"><span data-stu-id="f3a9a-195">50,000 – 50,019</span></span>|<span data-ttu-id="f3a9a-196">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="f3a9a-196">TCP/UDP</span></span>|<span data-ttu-id="f3a9a-197">Áudio</span><span class="sxs-lookup"><span data-stu-id="f3a9a-197">Audio</span></span>|<span data-ttu-id="f3a9a-198">46</span><span class="sxs-lookup"><span data-stu-id="f3a9a-198">46</span></span>|<span data-ttu-id="f3a9a-199">Expedited Forwarding (EF)</span><span class="sxs-lookup"><span data-stu-id="f3a9a-199">Expedited Forwarding (EF)</span></span>|
| <span data-ttu-id="f3a9a-200">50.020 – 50.039</span><span class="sxs-lookup"><span data-stu-id="f3a9a-200">50,020 – 50,039</span></span>|<span data-ttu-id="f3a9a-201">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="f3a9a-201">TCP/UDP</span></span>|<span data-ttu-id="f3a9a-202">Vídeo</span><span class="sxs-lookup"><span data-stu-id="f3a9a-202">Video</span></span>|<span data-ttu-id="f3a9a-203">34</span><span class="sxs-lookup"><span data-stu-id="f3a9a-203">3-4</span></span>|<span data-ttu-id="f3a9a-204">Assured Forwarding (AF41)</span><span class="sxs-lookup"><span data-stu-id="f3a9a-204">Assured Forwarding (AF41)</span></span>|
| <span data-ttu-id="f3a9a-205">50.040 – 50.059</span><span class="sxs-lookup"><span data-stu-id="f3a9a-205">50,040 – 50,059</span></span>|<span data-ttu-id="f3a9a-206">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="f3a9a-206">TCP/UDP</span></span>|<span data-ttu-id="f3a9a-207">Compartilhamento de aplicativos/área de trabalho e transferência de arquivos</span><span class="sxs-lookup"><span data-stu-id="f3a9a-207">Application/Desktop Sharing and File Transfer</span></span>|<span data-ttu-id="f3a9a-208">18</span><span class="sxs-lookup"><span data-stu-id="f3a9a-208">18</span></span>|<span data-ttu-id="f3a9a-209">Seletor de classe (CS3)</span><span class="sxs-lookup"><span data-stu-id="f3a9a-209">Class Selector (CS3)</span></span>|

<span data-ttu-id="f3a9a-210">Tabela 2: Intervalos de portas de origem do cliente</span><span class="sxs-lookup"><span data-stu-id="f3a9a-210">Table 2: Client source port ranges</span></span>

> [!NOTE]
> <span data-ttu-id="f3a9a-211">Se você já configurou a QoS com base nos intervalos de portas de origem para o Skype for Business Online, a mesma configuração se aplicará ao Microsoft Teams. Não é necessário alterar mais nada.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-211">If you've already configured QoS based on source port ranges for Skype for Business Online, the same configuration will apply to Teams and no further changes are required.</span></span> <span data-ttu-id="f3a9a-212">Se você implantou o Skype for Business Server (no local), será necessário reestruturar suas Políticas de QoS.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-212">If you’ve deployed Skype for Business Server (on premises), you will need to redesign your QoS Policies.</span></span>

## <a name="setting-differentiated-services-code-point-dscp-markings"></a><span data-ttu-id="f3a9a-213">Definição de marcações DSCP (Ponto de Código de Serviços Diferenciados)</span><span class="sxs-lookup"><span data-stu-id="f3a9a-213">Setting differentiated services code point (DSCP) markings</span></span>

<span data-ttu-id="f3a9a-214">Há várias abordagens para definir as marcações DSCP corretas para a classificação do tráfego.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-214">There are multiple approaches to setting the proper DSCP markings for traffic classification.</span></span>

- <span data-ttu-id="f3a9a-215">Marcação DSCP no ponto de extremidade: em geral, essa é a opção preferencial, pois o próprio ponto de extremidade fornece as marcações corretas.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-215">DSCP marking at the endpoint: This is the preferred option in general, as the endpoint itself is providing the proper markings.</span></span> <span data-ttu-id="f3a9a-216">No momento, isso deve ser feito usando um GPO, mas isso só é possível em clientes Windows que ingressaram no domínio.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-216">Currently this could be done by using a GPO, but this is only possible on domain-joined Windows clients.</span></span> <span data-ttu-id="f3a9a-217">Os clientes Mac OSX ou móveis, por exemplo, não fornecem um mecanismo para marcar o tráfego com valores de DSCP.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-217">Mac OSX or mobile clients, for example, do not provide a mechanism to mark traffic with DSCP values.</span></span>

- <span data-ttu-id="f3a9a-218">Baseada em portas usando ACLs nos roteadores: essa é uma opção muito comum em ambientes heterogêneos do Windows e do Mac.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-218">Port-based using ACLs on routers: This is a very common option encountered in heterogeneous environments of Windows and Mac.</span></span> <span data-ttu-id="f3a9a-219">Nesse cenário, a equipe de rede marca o tráfego nos roteadores de entrada/saída (normalmente na WAN (rede de longa distância)) com base nos intervalos de portas de origem definidos para cada modalidade.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-219">In this scenario, the network team marks the traffic at the ingress/egress routers (typically on the Wide Area Network (WAN)) based on the source port ranges defined for each modality.</span></span> <span data-ttu-id="f3a9a-220">Embora isso funcione em várias plataformas, a marcação é feita somente na borda da WAN, não por todo o caminho até o computador cliente, e agrega sobrecarga de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-220">While this works across platforms, it only marks at the WAN edge – not all the way to the client machine – and incurs management overhead.</span></span>
    
- <span data-ttu-id="f3a9a-221">Combinação de marcações DSCP no cliente e ACLs baseadas em portas nos roteadores.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-221">A combination of DSCP markings on the client and port-based ACLs on routers.</span></span>
    
<span data-ttu-id="f3a9a-222">Se possível, recomendamos uma combinação das duas abordagens, usando um GPO para pegar a maioria dos clientes e também a marcação DSCP baseada em portas para garantir que clientes móveis, Mac e outros clientes possam receber um tratamento de QoS (parcial).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-222">If possible, we recommend a combination of both, to use a GPO to catch the majority of clients, and to also use port based DSCP tagging to ensure mobile clients, Mac and other clients will still get a (partial) QoS treatment.</span></span>

<span data-ttu-id="f3a9a-223">A definição do valor de DSCP para o intervalo de portas de origem predefinido no cliente Microsoft Teams pode ser feita usando a QoS baseada em política dentro da Política de Grupo.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-223">Setting the DSCP value for the pre-defined source port range in the Teams client can be done using policy-based QoS within Group Policy.</span></span> <span data-ttu-id="f3a9a-224">A tabela a seguir usa os intervalos de portas especificados para criar uma política para cada carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-224">The following table uses the port ranges specified in the table to create a policy for each workload.</span></span>

| <span data-ttu-id="f3a9a-225">Tipo de tráfego do cliente</span><span class="sxs-lookup"><span data-stu-id="f3a9a-225">Client traffic type</span></span>|<span data-ttu-id="f3a9a-226">Início do intervalo de portas</span><span class="sxs-lookup"><span data-stu-id="f3a9a-226">Port range start</span></span>|<span data-ttu-id="f3a9a-227">Final do intervalo de portas</span><span class="sxs-lookup"><span data-stu-id="f3a9a-227">Port range end</span></span>|<span data-ttu-id="f3a9a-228">Valor de DSCP</span><span class="sxs-lookup"><span data-stu-id="f3a9a-228">DSCP value</span></span>|
|---------|---------|---------|--------|
| <span data-ttu-id="f3a9a-229">Áudio</span><span class="sxs-lookup"><span data-stu-id="f3a9a-229">Audio</span></span>|<span data-ttu-id="f3a9a-230">50000</span><span class="sxs-lookup"><span data-stu-id="f3a9a-230">50000</span></span>|<span data-ttu-id="f3a9a-231">50019</span><span class="sxs-lookup"><span data-stu-id="f3a9a-231">50019</span></span>|<span data-ttu-id="f3a9a-232">46</span><span class="sxs-lookup"><span data-stu-id="f3a9a-232">46</span></span>|
| <span data-ttu-id="f3a9a-233">Vídeo</span><span class="sxs-lookup"><span data-stu-id="f3a9a-233">Video</span></span>|<span data-ttu-id="f3a9a-234">50020</span><span class="sxs-lookup"><span data-stu-id="f3a9a-234">50020</span></span>|<span data-ttu-id="f3a9a-235">50039</span><span class="sxs-lookup"><span data-stu-id="f3a9a-235">50039</span></span>|<span data-ttu-id="f3a9a-236">34</span><span class="sxs-lookup"><span data-stu-id="f3a9a-236">3-4</span></span>|
| <span data-ttu-id="f3a9a-237">Compartilhamento de aplicativos</span><span class="sxs-lookup"><span data-stu-id="f3a9a-237">Application sharing</span></span>|<span data-ttu-id="f3a9a-238">50040</span><span class="sxs-lookup"><span data-stu-id="f3a9a-238">50040</span></span>|<span data-ttu-id="f3a9a-239">50059</span><span class="sxs-lookup"><span data-stu-id="f3a9a-239">50059</span></span>|<span data-ttu-id="f3a9a-240">18</span><span class="sxs-lookup"><span data-stu-id="f3a9a-240">18</span></span>|
| <span data-ttu-id="f3a9a-241">Transferência de arquivos</span><span class="sxs-lookup"><span data-stu-id="f3a9a-241">File transfer</span></span>|<span data-ttu-id="f3a9a-242">50040</span><span class="sxs-lookup"><span data-stu-id="f3a9a-242">50040</span></span>|<span data-ttu-id="f3a9a-243">50059</span><span class="sxs-lookup"><span data-stu-id="f3a9a-243">50059</span></span>|<span data-ttu-id="f3a9a-244">18</span><span class="sxs-lookup"><span data-stu-id="f3a9a-244">18</span></span>|

<span data-ttu-id="f3a9a-245">Tabela 3: Intervalos de portas por tipo de tráfego</span><span class="sxs-lookup"><span data-stu-id="f3a9a-245">Table 3: Port ranges by traffic type</span></span>

<span data-ttu-id="f3a9a-246">Observação: Não é possível mudar ou alterar os intervalos de portas definidos pelo Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-246">Note: The port ranges set by Teams cannot be changed or altered.</span></span> <span data-ttu-id="f3a9a-247">Consulte nesta página as informações mais recentes: https://support.microsoft.com/ kb/2409256</span><span class="sxs-lookup"><span data-stu-id="f3a9a-247">Please review this page for the latest information: https://support.microsoft.com/ kb/2409256</span></span>

<span data-ttu-id="f3a9a-248">Depois que os intervalos de portas tiverem sido determinados, a próxima etapa é definir as configurações de QoS baseada em política dentro de um GPO (Objeto de Política de Grupo).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-248">Once the port ranges have been determined, the next step is to configure the policy-based QoS settings within a Group Policy Object (GPO).</span></span> <span data-ttu-id="f3a9a-249">Os detalhes desse procedimento estão disponíveis no [TechNet](https://technet.microsoft.com/library/jj205371(v=ocs.15).aspx).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-249">Details for these steps can be found on [TechNet](https://technet.microsoft.com/library/jj205371(v=ocs.15).aspx).</span></span> 

<span data-ttu-id="f3a9a-250">As novas políticas que você criou só entrarão em vigor quando a Política de Grupo for atualizada nos computadores cliente.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-250">The new policies you have created won’t take effect until Group Policy has been refreshed on your client computers.</span></span> <span data-ttu-id="f3a9a-251">Embora a Política de Grupo seja periodicamente atualizada por si só, você pode forçar a atualização imediata executando o comando a seguir em cada computador em que a Política de Grupo deve ser atualizada:</span><span class="sxs-lookup"><span data-stu-id="f3a9a-251">Although Group Policy periodically refreshes on its own, you can force an immediate refresh by running the following command on each computer where Group Policy needs to be refreshed:</span></span>

        gpudate.exe /force

<span data-ttu-id="f3a9a-252">Esse comando pode ser executado em qualquer janela de comando executada com credenciais de administrador.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-252">This command can be run from any command window that is running under administrator credentials.</span></span> <span data-ttu-id="f3a9a-253">Para executar uma janela de comando com credenciais de administrador, clique em **Iniciar**, clique com o botão direito do mouse em **Prompt de Comando** e clique em **Executar como administrador**.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-253">To open a command window, click **Start**, right-click **Command Prompt**, and then click **Run as administrator**.</span></span>

## <a name="verifying-the-dscp-markings-in-gpo"></a><span data-ttu-id="f3a9a-254">Verificação das marcações DSCP no GPO</span><span class="sxs-lookup"><span data-stu-id="f3a9a-254">Verifying the DSCP markings in GPO</span></span>

<span data-ttu-id="f3a9a-255">Para verificar se os valores do GPO foram definidos, faça o seguinte:</span><span class="sxs-lookup"><span data-stu-id="f3a9a-255">To verify that the values from the GPO has been set, please perform the following steps:</span></span>

1.  <span data-ttu-id="f3a9a-256">Use gpresult para verificar se as configurações do GPO foram recebidas pelo computador local.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-256">Use gpresult to verify that the settings from the GPO has been received by the local PC.</span></span> <span data-ttu-id="f3a9a-257">gpresult /R >gp.txt gerará um relatório e o enviará para um arquivo de texto, gp.txt.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-257">gpresult /R >gp.txt will generate a report and send it to a text file, gp.txt.</span></span>

    ![Captura de tela do Prompt de Comando do Administrador executando o comando gpresult.](media/Qos-in-Teams-Image3.png)

    <span data-ttu-id="f3a9a-259">Figura 2: Verificação dos Objetos de Política de Grupo aplicados</span><span class="sxs-lookup"><span data-stu-id="f3a9a-259">Figure 2: Verify Applied Group Policy Objects</span></span>
    > [!NOTE]
    > <span data-ttu-id="f3a9a-260">Como opção, você pode executar gpresult /H gp.html para produzir os mesmos dados em um relatório HTML mais amigável.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-260">Alternatively, you can run gpresult /H gp.html to produce the same data in more user-friendly HTML report.</span></span> 
2.  <span data-ttu-id="f3a9a-261">No arquivo gerado, procure o cabeçalho: Applied Group Policy Objects e verifique se os nomes dos GPOs criados estão na lista de políticas aplicadas.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-261">In the generated file look for the heading: Applied Group Policy Objects and verify that the names of the GPO’s created earlier is in the list of applied policies.</span></span> 

3.  <span data-ttu-id="f3a9a-262">Abra o editor do Registro e navegue até:</span><span class="sxs-lookup"><span data-stu-id="f3a9a-262">Open the registry editor and navigate to:</span></span>

    <span data-ttu-id="f3a9a-263">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\QoS\\</span><span class="sxs-lookup"><span data-stu-id="f3a9a-263">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\QoS\\</span></span>

    <span data-ttu-id="f3a9a-264">Verifique os valores do Registro listados na Tabela 3 a seguir.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-264">Verify the registry values listed in Table 3 below.</span></span>
    
    | <span data-ttu-id="f3a9a-265">Nome</span><span class="sxs-lookup"><span data-stu-id="f3a9a-265">Name</span></span> | <span data-ttu-id="f3a9a-266">Tipo</span><span class="sxs-lookup"><span data-stu-id="f3a9a-266">Type</span></span> | <span data-ttu-id="f3a9a-267">Dados</span><span class="sxs-lookup"><span data-stu-id="f3a9a-267">Data</span></span>|
    |---------|---------|---------
    | <span data-ttu-id="f3a9a-268">Nome do Aplicativo</span><span class="sxs-lookup"><span data-stu-id="f3a9a-268">Application Name</span></span>|<span data-ttu-id="f3a9a-269">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="f3a9a-269">REG_SZ</span></span>|<span data-ttu-id="f3a9a-270">Teams.exe</span><span class="sxs-lookup"><span data-stu-id="f3a9a-270">Teams.exe</span></span>|
    | <span data-ttu-id="f3a9a-271">Valor de DSCP</span><span class="sxs-lookup"><span data-stu-id="f3a9a-271">DSCP Value - 10</span></span>|<span data-ttu-id="f3a9a-272">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="f3a9a-272">REG_SZ</span></span>|<span data-ttu-id="f3a9a-273">46</span><span class="sxs-lookup"><span data-stu-id="f3a9a-273">46</span></span>|
    | <span data-ttu-id="f3a9a-274">IP Local</span><span class="sxs-lookup"><span data-stu-id="f3a9a-274">Second Reflexive Local IP</span></span>|<span data-ttu-id="f3a9a-275">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="f3a9a-275">REG_SZ</span></span>|*|
    | <span data-ttu-id="f3a9a-276">Comprimento do Prefixo IP Local</span><span class="sxs-lookup"><span data-stu-id="f3a9a-276">Local IP Prefix Length</span></span>|<span data-ttu-id="f3a9a-277">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="f3a9a-277">REG_SZ</span></span>|*|
    | <span data-ttu-id="f3a9a-278">Porta Local</span><span class="sxs-lookup"><span data-stu-id="f3a9a-278">Local Port</span></span>|<span data-ttu-id="f3a9a-279">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="f3a9a-279">REG_SZ</span></span>|<span data-ttu-id="f3a9a-280">50000-50019</span><span class="sxs-lookup"><span data-stu-id="f3a9a-280">50000-50019</span></span>|
    | <span data-ttu-id="f3a9a-281">Protocolo</span><span class="sxs-lookup"><span data-stu-id="f3a9a-281">Protocol</span></span>|<span data-ttu-id="f3a9a-282">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="f3a9a-282">REG_SZ</span></span>|*|
    | <span data-ttu-id="f3a9a-283">IP Remoto</span><span class="sxs-lookup"><span data-stu-id="f3a9a-283">Remote IP</span></span>|<span data-ttu-id="f3a9a-284">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="f3a9a-284">REG_SZ</span></span>|*|
    | <span data-ttu-id="f3a9a-285">Prefixo do IP Remoto</span><span class="sxs-lookup"><span data-stu-id="f3a9a-285">Remote Ip Prefix</span></span>|<span data-ttu-id="f3a9a-286">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="f3a9a-286">REG_SZ</span></span>|*|
    | <span data-ttu-id="f3a9a-287">Porta Remota</span><span class="sxs-lookup"><span data-stu-id="f3a9a-287">Remote Port</span></span>|<span data-ttu-id="f3a9a-288">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="f3a9a-288">REG_SZ</span></span>|*|
    | <span data-ttu-id="f3a9a-289">Taxa de Aceleração</span><span class="sxs-lookup"><span data-stu-id="f3a9a-289">Throttle Rate</span></span>|<span data-ttu-id="f3a9a-290">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="f3a9a-290">REG_SZ</span></span>|<span data-ttu-id="f3a9a-291">-1</span><span class="sxs-lookup"><span data-stu-id="f3a9a-291">$1</span></span>|
    
    <span data-ttu-id="f3a9a-292">Tabela 3: Valores do Registro do Windows para QoS</span><span class="sxs-lookup"><span data-stu-id="f3a9a-292">Table 3: Windows registry values for QoS</span></span>

4.  <span data-ttu-id="f3a9a-293">Verifique se o Nome do Aplicativo está correto para o cliente que você está usando e se o valor de DSCP e a Porta Local refletem as configurações no GPO.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-293">Verify that the Application Name is correct for the client you are using, and verify that both DSCP value and Local Port reflect the settings in the GPO.</span></span>

## <a name="validating-qos-analyzing-teams-traffic-on-the-network"></a><span data-ttu-id="f3a9a-294">Validação da QoS: analisando o tráfego do Microsoft Teams na rede</span><span class="sxs-lookup"><span data-stu-id="f3a9a-294">Validating QoS: Analyzing Teams traffic on the network</span></span>

<span data-ttu-id="f3a9a-295">O valor de DSCP definido pelo GPO precisa estar presente do autor da chamada até o destinatário da chamada para que a QoS seja efetiva.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-295">The DSCP value set by the GPO needs to be present from caller to callee in order for QoS to be affective.</span></span> <span data-ttu-id="f3a9a-296">É possível verificar se o DSCP não foi alterado ou removido ao percorrer a rede examinando o tráfego gerado pelo cliente Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-296">By looking at the traffic generated by the Teams client we can verify that the DSCP is not changed or stripped out when traversing the network.</span></span> 

<span data-ttu-id="f3a9a-297">Seria preferível capturar o tráfego no ponto de saída da rede.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-297">Preferably we would capture traffic at the network egress point.</span></span> <span data-ttu-id="f3a9a-298">O espelhamento de porta pode ser usado em um comutador ou roteador para auxiliar na captura do tráfego na rede.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-298">Port mirroring can be used on a switch or router to aid in capturing traffic on the network.</span></span> 

### <a name="looking-at-network-traffic-using-network-monitor"></a><span data-ttu-id="f3a9a-299">Exame do tráfego de rede usando o Monitor de Rede</span><span class="sxs-lookup"><span data-stu-id="f3a9a-299">Looking at network traffic using Network Monitor</span></span>

<span data-ttu-id="f3a9a-300">A ferramenta Monitor de Rede pode ser baixada da Microsoft para analisar o tráfego de rede.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-300">Network Monitor is a tool you can download from Microsoft to analyze network traffic.</span></span> <span data-ttu-id="f3a9a-301">Baixe o [Monitor de Rede 3.4](https://www.microsoft.com/download/4865).</span><span class="sxs-lookup"><span data-stu-id="f3a9a-301">Download [Network Monitor 3.4](https://www.microsoft.com/download/4865).</span></span>

<span data-ttu-id="f3a9a-302">Conecte o computador que está executando o Monitor de Rede à porta que foi configurada para o espelhamento de porta e inicie a captura de pacotes.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-302">Connect to PC running network monitor to the port that has been configured for port mirroring and start capturing packets.</span></span> <span data-ttu-id="f3a9a-303">Faça uma chamada usando o cliente Skype for Business.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-303">Make and receive a video call using Skype for Business</span></span> <span data-ttu-id="f3a9a-304">Verifique se a mídia foi estabelecida antes de desligar a chamada.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-304">Make sure media is established before hanging up the call.</span></span> <span data-ttu-id="f3a9a-305">Pare a captura, crie um filtro de exibição correspondente ao IP de origem do computador que fez a chamada e refine o filtro definindo o valor de DSCP 46 (hex 0xb8) como critério de pesquisa:</span><span class="sxs-lookup"><span data-stu-id="f3a9a-305">Stop the capture create a Display Filter that matches the source IP of the PC that made the call and refine the filter by defining DSCP value 46 (hex 0xb8) as search criteria:</span></span>

<span data-ttu-id="f3a9a-306">Source == "192.168.137.201" AND IPv4.DifferentiatedServicesField == 0xb8</span><span class="sxs-lookup"><span data-stu-id="f3a9a-306">Source == "192.168.137.201" AND IPv4.DifferentiatedServicesField == 0xb8</span></span> 

![Captura de tela da caixa de diálogo Filtro de exibição no Monitor de Rede, mostrando os filtros que devem ser aplicados.](media/Qos-in-Teams-Image4.png)


<span data-ttu-id="f3a9a-308">Clique em **Aplicar** para ativar o filtro.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-308">Click **Apply** to activate the filter.</span></span> <span data-ttu-id="f3a9a-309">Na janela **Frame Summary** (Resumo do Quadro), selecione o primeiro pacote UDP e examine os detalhes do quadro:</span><span class="sxs-lookup"><span data-stu-id="f3a9a-309">In the **Frame Summary** window, select the first UDP packet and look at the Frame Details:</span></span>

![Captura de tela da caixa de diálogo Frame Details (Detalhes do Quadro) no Monitor de Rede, destacando as configurações de DSCP.](media/Qos-in-Teams-Image5.png)

<span data-ttu-id="f3a9a-311">Expanda IPv4 e examine o valor no final da linha DSCP.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-311">Expand IPv4 and look at the value at the end of the DSCP line.</span></span> <span data-ttu-id="f3a9a-312">Nesse exemplo, vemos que o valor de DSCP está definido como 46, que é o valor correto, já que a porta de origem usada é a 50019. Isso nos informa que a carga de trabalho é de voz.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-312">In this example we see that the DSCP value is set to 46 which is correct since the source port used is 50019 which tells us that the workload is voice.</span></span> 

<span data-ttu-id="f3a9a-313">Repita a verificação para cada carga de trabalho que foi marcada pelo GPO.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-313">Repeat the verification for each workload that has been marked by the GPO.</span></span> 

> [!NOTE]
> <span data-ttu-id="f3a9a-314">Confirme se as marcações também são respeitadas para o tráfego ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-314">Verify that markings are honored for peer-to-peer traffic as well.</span></span> <span data-ttu-id="f3a9a-315">Isso pode ser feito instalando o Monitor de Rede em dois clientes e fazendo chamadas entre eles.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-315">This can be done by installing Network Monitor on two clients and placing calls between the two clients.</span></span> <span data-ttu-id="f3a9a-316">Examine o tráfego de mídia que flui entre os clientes da maneira descrita acima.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-316">Look at the media traffic flowing between clients in the same manner as described above.</span></span>

### <a name="sample-filters-to-use-for-network-monitor-or-wireshark"></a><span data-ttu-id="f3a9a-317">Filtros de exemplo para usar com o Monitor de Rede ou o Wireshark</span><span class="sxs-lookup"><span data-stu-id="f3a9a-317">Sample filters to use for Network Monitor or Wireshark</span></span>

|<span data-ttu-id="f3a9a-318">Uso</span><span class="sxs-lookup"><span data-stu-id="f3a9a-318">Usage</span></span>  |<span data-ttu-id="f3a9a-319">Filtro de exemplo</span><span class="sxs-lookup"><span data-stu-id="f3a9a-319">Sample filter</span></span>  |
|---------|---------|
|<span data-ttu-id="f3a9a-320">Voz (observação: a mixagem deve estar desligada)</span><span class="sxs-lookup"><span data-stu-id="f3a9a-320">Voice (note: muxing must be turned off)</span></span>     |   <span data-ttu-id="f3a9a-321">udp.port==3479 AND Ipv4.DifferentiatedServicesField.DSCP==46</span><span class="sxs-lookup"><span data-stu-id="f3a9a-321">udp.port==3479 AND Ipv4.DifferentiatedServicesField.DSCP==46</span></span>      |
|<span data-ttu-id="f3a9a-322">Vídeo</span><span class="sxs-lookup"><span data-stu-id="f3a9a-322">Video</span></span>     | <span data-ttu-id="f3a9a-323">udp.port==3480 AND Ipv4.DifferentiatedServicesField.DSCP==34</span><span class="sxs-lookup"><span data-stu-id="f3a9a-323">udp.port==3480 AND Ipv4.DifferentiatedServicesField.DSCP==34</span></span>        |
|<span data-ttu-id="f3a9a-324">Compartilhamento de tela</span><span class="sxs-lookup"><span data-stu-id="f3a9a-324">Screen sharing</span></span>     |  <span data-ttu-id="f3a9a-325">udp.port==3481 AND Ipv4.DifferentiatedServicesField.DSCP==18</span><span class="sxs-lookup"><span data-stu-id="f3a9a-325">udp.port==3481 AND Ipv4.DifferentiatedServicesField.DSCP==18</span></span>       |

### <a name="filter-media-traffic-from-microsoft-relays-requires-azure-expressroutehttpsazuremicrosoftcomservicesexpressroute"></a><span data-ttu-id="f3a9a-326">Filtro: tráfego de mídia de relés da Microsoft (requer o [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/))</span><span class="sxs-lookup"><span data-stu-id="f3a9a-326">Filter: Media traffic from Microsoft relays (requires [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/))</span></span>

<span data-ttu-id="f3a9a-327">ip.src em {52.114.188.0/22 52.114.220.0/22 52.114.124.0/22 52.114.60.0/22} e (udp.srcport em {3479 3480 3481} ou (udp.srcport ge 50000 e udp.srcport lt 60000))</span><span class="sxs-lookup"><span data-stu-id="f3a9a-327">ip.src in {52.114.188.0/22 52.114.220.0/22 52.114.124.0/22 52.114.60.0/22} and (udp.srcport in {3479 3480 3481} or (udp.srcport ge 50000 and udp.srcport lt 60000))</span></span>

### <a name="filter-media-traffic-to-microsoft-relays"></a><span data-ttu-id="f3a9a-328">Filtro: tráfego de mídia de relés da Microsoft</span><span class="sxs-lookup"><span data-stu-id="f3a9a-328">Filter: Media traffic to Microsoft relays</span></span>

<span data-ttu-id="f3a9a-329">ip.dst em {52.114.188.0/22 52.114.220.0/22 52.114.124.0/22 52.114.60.0/22} e (udp.dstport em {3479 3480 3481} ou (udp.dstport ge 50000 e udp.dstport lt 60000))</span><span class="sxs-lookup"><span data-stu-id="f3a9a-329">ip.dst in {52.114.188.0/22 52.114.220.0/22 52.114.124.0/22 52.114.60.0/22} and (udp.dstport in {3479 3480 3481} or (udp.dstport ge 50000 and udp.dstport lt 60000))</span></span>


<span data-ttu-id="f3a9a-330">Você deve ver o tráfego de e para os relés da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-330">You should see traffic to and from the Microsoft relays.</span></span> <span data-ttu-id="f3a9a-331">É possível verificar as marcações DSCP na camada IP no Wireshark conforme mostrado na próxima seção.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-331">You can check DSCP markings on the IP layer in Wireshark, as shown in the next section.</span></span>

### <a name="expected-dscp-markings"></a><span data-ttu-id="f3a9a-332">Marcações DSCP esperadas</span><span class="sxs-lookup"><span data-stu-id="f3a9a-332">Expected DSCP markings</span></span>

<span data-ttu-id="f3a9a-333">Fluxos de áudio: 46</span><span class="sxs-lookup"><span data-stu-id="f3a9a-333">Audio streams: 46</span></span>

<span data-ttu-id="f3a9a-334">Fluxos de vídeo: 34</span><span class="sxs-lookup"><span data-stu-id="f3a9a-334">Video streams: 34</span></span>

<span data-ttu-id="f3a9a-335">Fluxos de dados: 18</span><span class="sxs-lookup"><span data-stu-id="f3a9a-335">Data streams: 18</span></span>

### <a name="filter-dscp-condition-to-network"></a><span data-ttu-id="f3a9a-336">Filtro: condição de DSCP para rede</span><span class="sxs-lookup"><span data-stu-id="f3a9a-336">Filter: DSCP condition to network</span></span>

<span data-ttu-id="f3a9a-337">ip.dsfield.dscp em {46 34 18}</span><span class="sxs-lookup"><span data-stu-id="f3a9a-337">ip.dsfield.dscp in {46 34 18}</span></span>



### <a name="looking-at-network-traffic-using-wireshark"></a><span data-ttu-id="f3a9a-338">Exame do tráfego de rede usando o Wireshark</span><span class="sxs-lookup"><span data-stu-id="f3a9a-338">Looking at network traffic using Wireshark</span></span>

<span data-ttu-id="f3a9a-339">O Wireshark, https://www.wireshark.org/, é uma ferramenta eficiente que permite filtrar e gravar dados de rede para análise adicional.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-339">Wireshark, https://www.wireshark.org/, is a powerful tool that allows us to filter and record network data for further analysis.</span></span> <span data-ttu-id="f3a9a-340">Conecte um computador que está executando o Wireshark à porta que foi configurada para o espelhamento de porta e inicie a captura de pacotes.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-340">Connect a PC running Wireshark to the port that has been configured for port mirroring and start capturing packets.</span></span> <span data-ttu-id="f3a9a-341">Faça uma chamada usando o cliente Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-341">Make a call using the Teams client.</span></span> <span data-ttu-id="f3a9a-342">Verifique se a mídia foi estabelecida antes de desligar a chamada.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-342">Make sure media is established before hanging up the call.</span></span>

<span data-ttu-id="f3a9a-343">Pare o rastreamento de pacotes e crie um filtro para exibir apenas o IP de origem do computador em que o cliente Microsoft Teams está instalado. Por exemplo, *ip.src_host == 192.168.137.201* e procure os pacotes que usam uma porta de origem do intervalo especificado para voz, 50.000 – 50.019:</span><span class="sxs-lookup"><span data-stu-id="f3a9a-343">Stop the packet trace and create a filter that only displays the source IP of the PC where the Teams client is installed, for example, *ip.src_host == 192.168.137.201* and looks for packages that use a source port from the range specified for voice, 50,000 – 50,019:</span></span>

![Captura de tela do Wireshark com configurações de filtro.](media/Qos-in-Teams-Image6.png)
 

<span data-ttu-id="f3a9a-345">Marque o pacote e expanda o cabeçalho IPV4 no painel de detalhes do pacote:</span><span class="sxs-lookup"><span data-stu-id="f3a9a-345">Mark the package and expand the Internet Protocol Version 4 (IPV4) header in the packet detail pane:</span></span>

![Captura de tela do Wireshark com as configurações de Differentiated Services Codepoint em destaque.](media/Qos-in-Teams-Image7.png)
 

<span data-ttu-id="f3a9a-347">Verifique se o valor de *Differentiated Services Codepoint* corresponde ao valor da carga de trabalho específica, nesse caso, 46 (binário 101110) para voz.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-347">Verify that the value for *Differentiated Services Codepoint* match the value for the specific workload, in this case 46 (binary 101110) for voice.</span></span>

<span data-ttu-id="f3a9a-348">Repita a verificação para cada carga de trabalho que foi marcada pelo GPO.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-348">Repeat the verification for each workload that has been marked by the GPO.</span></span>

> [!NOTE]
> <span data-ttu-id="f3a9a-349">Confirme se as marcações são respeitadas para o tráfego ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-349">Verify that markings are honored for peer-to-peer traffic.</span></span> <span data-ttu-id="f3a9a-350">Isso pode ser feito instalando o WireShark ou o Monitor de Rede em dois clientes e fazendo chamadas entre eles.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-350">This can be done by installing WireShark or Network Monitor on two clients and placing calls between the two clients.</span></span> <span data-ttu-id="f3a9a-351">Examine o tráfego de mídia que flui entre os clientes da maneira descrita acima.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-351">Look at the media traffic flowing between clients in the same manner as described above.</span></span>

## <a name="summary"></a><span data-ttu-id="f3a9a-352">Resumo</span><span class="sxs-lookup"><span data-stu-id="f3a9a-352">Summary</span></span>

<span data-ttu-id="f3a9a-353">A Qualidade de Serviço é uma peça importante para fornecer experiências de nível empresarial com o Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-353">Quality of Service is an important piece of the puzzle when providing business-class experiences with Teams.</span></span> <span data-ttu-id="f3a9a-354">No entanto, é sempre importante lembrar que a QoS só é eficiente em redes gerenciadas corretamente.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-354">However, it is important to always remember that QoS is only effective on properly managed networks.</span></span> <span data-ttu-id="f3a9a-355">Dessa maneira, a equipe de implantação deve trabalhar de perto com as equipes de rede para garantir que as informações apropriadas sejam passadas em nível de rede, idealmente gerenciadas de ponta a ponta.</span><span class="sxs-lookup"><span data-stu-id="f3a9a-355">As such, the deployment team must work very closely with the networking teams to ensure the proper information is passed at the network layer, ideally managed from end-to-end.</span></span>

